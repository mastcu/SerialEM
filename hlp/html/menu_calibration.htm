<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
  <HEAD>
    <TITLE>Calibration Menu Commands</TITLE>
    <META content="text/html; charset=Windows-1252" http-equiv="Content-Type">
    <style type="text/css"> <!-- BODY { font-family:"Arial" }
  TD { font-size:16 }
    .style1
      {
        width: 208px;
      }
      .style2
      {
        width: 208px;
        font-weight: bold;
      }
    .style3
      {
        text-decoration: underline;
      }
      .style4
      {
        width: 208px;
        height: 24px;
      }
      .style5
      {
        height: 24px;
      }
      --></style>
  </HEAD>
  <BODY bgColor="#ffffff" text="#000000">
    <basefont size="2">
      <P><A name="menu_calibration"></A><B><FONT size="3">Calibration menu commands</FONT></B></P>
      <P>The Calibration menu and its submenus offer the following commands:</P>
      <TABLE border="1" cols="2">
        <TR vAlign="top">
          <TD class="style2">Image &amp; Stage Shift</TD>
          <TD>&nbsp;&nbsp;&nbsp;&nbsp; <span class="style3">Calibrations related to image and stage shift and
            image offsets</span></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_imageshift">Image Shift</A></TD>
          <TD>Calibrate image shift at the current magnification.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_isfromscratch">IS from Scratch</A></TD>
          <TD>Calibrate image shift, ignoring any previous calibration.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_stageshift">Stage Shift</A></TD>
          <TD>Calibrate stage shift for the current magnification.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_calibration_whole_image_corr">Whole Image
            Corr</a></TD>
          <TD>Correlate whole image instead of expected overlap area for stage calibrations.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_calibration_set_cycle_lengths">Set Cycle
            Lengths</a></TD>
          <TD>Set the basic lengths in X and Y over which stage calibrations will run.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_imagestageshift_usetrialbinning">
            Use Trial Binning</a>&nbsp;</TD>
          <TD>Use the current binning of Trial images for shift calibrations.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_imagestageshift_usetrialsize">Use
            Trial Size</a>&nbsp;&nbsp;</TD>
          <TD>Use the current size of Trial images for shift calibrations.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_listisvectors">List IS Vectors</A></TD>
          <TD>List image shift calibration vector lengths and angles.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_liststagecals">List Stage Cals</A></TD>
          <TD>List stage calibrations converted to specimen to stage matrices.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_imagestageshift_removeiscal">
            Remove IS Cal</a></TD>
          <TD>Remove one image shift calibration for the current camera.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp;
            <a href="#hid_imagestageshift_removestagecal">Remove Stage Cal</a></TD>
          <TD>Remove one stage shift calibration for the current camera.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_magisoffsets">Mag IS Offsets</A></TD>
          <TD>Calibrate image shift offsets between magnifications.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_eftemisoffset">EFTEM IS Offset</A></TD>
          <TD>Calibrate the offset between regular and energy filter cameras at one mag.</TD>
        </TR>
        <TR>
          <TD class="style1">&nbsp;&nbsp;&nbsp;&nbsp;<A href="#hid_calibration_set_is_delay_factor">Set IS
            Delay Factor</A></TD>
          <TD>Set factor for scaling delay after image shift.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style2">Pixel Size</TD>
          <TD>&nbsp;&nbsp;&nbsp;&nbsp; <span class="style3">Items related to finding pixel size from calibration
            grating</span></TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A HREF="#hid_process_findpixelsize">Find Pixel Size</A></TD>
          <TD>Analyze calibration grating image to find pixel size.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A HREF="#hid_process_pixelsizefrommarker">
            Try Again with
            Marker</A></TD>
          <TD>Analyze grating image again starting with marked point.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A HREF="#hid_process_setbinnedsize">Set Binned Size</A></TD>
          <TD>Set target size to bin images to for finding the pixel size.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_pixelsize_add_to_rotation">Add n*90 to a
            rotation</a></TD>
          <TD>Add a multiple of 90 degrees to one of the stored relative rotations.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A HREF="#hid_process_listrelativerotations">List Relative
            Rotations</A></TD>
          <TD>List pixel sizes and differences in rotation angles found by pixel size routine.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_pixelsize_catalase_crystal">Catalase Crystal</a></TD>
          <TD>Analyze image from catalase crystal instead of calibration grating.</TD>
        </TR>
        <TR VALIGN="top">
          <TD class="style1">&nbsp; &nbsp; <a href="#hid_pixelsize_meshforgridbars">Mesh for Grid Bars</a></TD>
          <TD>Set mesh size to measure pixel size from images with multiple grid bars.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style2">&nbsp;Focus &amp; Tuning</TD>
          <TD>&nbsp;&nbsp;&nbsp;&nbsp; <span class="style3">Calibrations related to focus</span>&nbsp;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_autofocus">Autofocus</A></TD>
          <TD>Calibrate autofocusing.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_setfocusrange">Set Focus Range</A></TD>
          <TD>Set defocus range and number of steps for focus calibration.</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_autofocus">Extended Autofocus</A></TD>
          <TD>Calibrate autofocusing over an wide range with sparse measurements outside regular range.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_focustuning_setextendedrange">Set Extended Range</A></TD>
          <TD>Set defocus range and step interval for extended focus calibration.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_standardlmfocus">Standard Focus</A></TD>
          <TD>Set the current defocus as a standard defocus for this magnification.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_stemfocusvsz">STEM Focus Vs. Z</A></TD>
          <TD>Calibrate the relationship between defocus in STEM mode and Z height.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp; &nbsp; <a href="#hid_autofocusfocus_basefocusvalues">Base Focus
            Values</a></TD>
          <TD>Record Hitachi microscope&#39;s set focus value at each magnification.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_focustuning_ctf">Astigmatism by CTF</a>&nbsp;</TD>
          <TD>Calibrate astigmatism correction using CTF-fitting to images</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_autofocusfocus_astigmati">
            Astigmatism by BTID</a>&nbsp;</TD>
          <TD>Calibrate astigmatism correction using beam-tilt-induced displacements</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_autofocusfocus_setupastigmatism">
            Setup Astigmatism</a>&nbsp;</TD>
          <TD>Set parameters for astigmatism calibration (other than beam tilt).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; Coma vs. Image Shift</a>&nbsp;</TD>
          <TD>Moved to <a href="menu_focus.htm#hid_focustuning_comavs">Focus/Tune menu</a> in SerialEM 4.1
            because it is a user-managed calibration saved in settings.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style2">&nbsp;&nbsp;&nbsp;&nbsp;Old Coma-free Alignment</TD>
          <TD>&nbsp;&nbsp;&nbsp; <span class="style3">Operations for coma-free alignment by beam-tilt-induced
            displacements</span></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#hid_autofocusfocus_coma">Coma-free
            Alignment</a>&nbsp;</TD>
          <TD>Calibrate the effects of beam-tilt misalignment for coma-free alignment.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#hid_autofocusfocus_setupcoma">Setup
            Coma-free</a></TD>
          <TD>Set focus level at which coma-free calibration and alignment are done.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_autofocusfocus_listcalibrations">
            List Calibrations</a></TD>
          <TD>List the magnifications at which focus calibrations exist for each camera</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style2">Beam &amp; Spot</TD>
          <TD>&nbsp;&nbsp; <span class="style3">Calibrations related to the beam</span>&nbsp;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_beamcrossover">Beam Crossover</A></TD>
          <TD>Set intensity at which beam crossover occurs for all spot sizes.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_beamintensity">Beam Intensity</A></TD>
          <TD>Calibrate beam intensity at current magnification and below.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_spotintensity">Spot Intensity</A></TD>
          <TD>Calibrate relative intensity of the different spot sizes.</TD>
        </TR>
        <tr>
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_c2factor">Set C2 Factor</A></TD>
          <TD>Set scaling factors for C2 by entering the C2 readout for all spot sizes.</TD>
        </tr>
        <tr>
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_beamspot_parallelillumination">Parallel Illumination</A></TD>
          <TD>Save intensity that gives parallel illumination at the current illumination conditions.</TD>
        </tr>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_beamshift">Beam Shift</A></TD>
          <TD>Calibrate beam shift by taking pictures of a small spot.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_beamspot_refinebeamshift">Refine Beam Shift Cal</A></TD>
          <TD>Refine beam shift calibration by analyzing shift of beam after large image shifts.</TD>
        </TR>

          <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <A href="#hid_calibration_alpha_beam_shifts">Alpha Beam
            Shifts</A></TD>
          <TD>Calibrate the change in beam shift/tilt needed when changing alpha on a JEOL.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp;&nbsp; <a href="#hid_beamspot_spotbeamshifts">Spot Beam
            Shifts</a>&nbsp;</TD>
          <TD>Calibrate the beam shift needed to keep spots aligned.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">&nbsp;&nbsp; &nbsp; <A href="#hid_beamspot_listcalibrations"> List Calibrations</a></TD>
          <TD>List some calibrations related to beam and spot.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Electron Dose</TD>
          <TD class="style5">Moved to <A href="menu_tasks.htm#hid_calibration_electrondose">Tasks menu</A> in SerialEM 4.1 to allow whole Calibration menu to be removed in Basic mode.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1">Purge Old Calibs</A></TD>
          <TD>Also moved to <A href="menu_tasks.htm#hid_calibration_purgeoldcalibs">Tasks menu</A>in SerialEM 4.1.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_magenergyshifts">Mag Energy Shifts</A></TD>
          <TD>Calibrate the energy shift of the zero-loss peak with change in
            magnification.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_listmags">List Mags</A></TD>
          <TD>Output list of all magnifications and image rotations to the Log Window.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_neutralisvalues">Neutral IS Values</A></TD>
          <TD>Measure neutral image shift values at all magnifications
          (JEOL) or in LM and HR modes (Hitachi).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_restoreneutralis">Restore
          Neutral IS</A></TD>
          <TD>Restore the stored neutral image shift at each LM and HR
          magnification (Hitachi).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_stagestretch">Stage Stretch</A></TD>
          <TD>Save a Navigator transformation to use to measure stretch in stage
            coordinates.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><a href="#hid_calibration_high_defocus">High-Defocus Mag</a></TD>
          <TD>Measure rotation and change in magnification at a large underfocus value.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_imagestageshift_high">High-Defocus IS</A></TD>
          <TD>Calibrate image shift as a function of defocus and intensity.&nbsp;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><a href="#hid_calibration_listfocus">List High-Focus Cals</a></TD>
          <TD>List the measurements of rotation and mag change, and of the image shift 
            calibration, at high defocus.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_cameratiming">Camera Timing</A></TD>
          <TD>Determine timing parameters for dual shuttering mode and post-exposure
            actions, and flyback time in STEM.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_quick_flyback_time">Quick Flyback
            Time</A></TD>
          <TD>Determine flyback time for a Thermo/FEI STEM camera with particular image
            parameters.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_shutterdeadtime">Shutter Dead Time</A></TD>
          <TD>Determine the minimum exposure time possible.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_distortion">Distortion</A></TD>
          <TD>Acquire overlapping pair of images for measuring distortion field.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_setoverlaps">Set Overlaps</A></TD>
          <TD>Set the minimum and maximum overlap factors for acquiring distortion pairs.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_administrator">Administrator</A></TD>
          <TD>Enter Administrator mode for saving calibrations and getting more reports.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_settings_savecalibrations">Save Calibrations</A></TD>
          <TD>Save calibrations to system calibration file.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style1"><A href="#hid_calibration_setdebugoutput">Set Debug Output</A></TD>
          <TD>Set a string of key letters to control debugging output.</TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="hid_calibration_imageshift"></A><B>Image Shift command (Calibration -
        Image &amp; Stage Shift sub-menu)</B></P>
      <P>This command starts calibration of image shift at the current magnification.
        You should always calibrate image shift at the appropriate magnification when
        montaging. Image shift is calibrated by taking 9 pictures at different shifted
        positions. Every other picture is taken in the unshifted position, so that drift
        can be eliminated. Exposures are done with images binned to 1024 pixels for
        direct detector cameras or 512 pixels for other cameras, using an
        exposure time based on the settings in the Trial parameter set.&nbsp; This
        binning can prevented by turning on the <a href="#hid_imagestageshift_usetrialbinning">
            Use Trial Binning</a> option to make it use whatever binning
        is in the Trial parameter set.&nbsp; Similarly, full-field images will be taken
        unless <a href="#hid_imagestageshift_usetrialsize">Use
            Trial Size</a> is turned on.&nbsp; It is important that the images have
        sufficient detail and enough counts to give reliable correlations.&nbsp; Either
        kind of&nbsp; deficiency will be reflected by a low cross-correlation
        coefficient (CCC, reported after the procedure); it is best to keep the CCC
        above 0.5. </P>
      <P>If image shift has already been calibrated at any magnification in the same
        magnification range, the procedure takes advantage of this information to set
        the image shifts of the shifted pictures. Otherwise, calibration is done in two
        rounds, first with very limited shifts, then with more wide-ranging ones. On Thermo/FEI
        scopes, there
        are two magnification ranges for image shift calibrations: LM mode mags and all
        higher mags.&nbsp; On JEOL and Hitachi scopes, there will typically be
        additional boundaries defined between smaller mag ranges.</P>
      <P>At the end, you will see messages about the minimum and mean CCCs, the calibration matrix that was
        measured, the amount of error in those values, the amount of drift that was
        detected during the sequence of pictures, and a statement about the quality of
        the calibration. At this point, you may be offered the opportunity to change all
        other existing image shift calibrations in the same mag range by the same
        amount. If your calibration is good, this will eliminate the need to recalibrate
        at the other magnifications.&nbsp; On the other hand, if the calibration is bad
        enough, you will be asked if you want the program to forget about it, which is
        usually a good idea.</P>
      <P>The program will apply a shift to the pictures taken with image shift to show
        how they align with the pictures in the central position. If you set up to roll
        buffers A through M in the Buffer Control panel before starting the calibration,
        then you can scroll through all the images and view the alignments. This could
        be important for verifying the alignment when a calibration grating is used at
        relatively low magnification.</P>
      <P>This procedure may fail if existing calibrations are far off, which can happen
        when the microscope alignment has been changed. If this happens, you should run
        the <A href="#hid_calibration_isfromscratch">IS from Scratch command</A> .&nbsp;
        Also, if there is a lot of distortion, the procedure may report a relatively
        poor result; this is common in the bottom two SA magnifications of a Krios in
        EFTEM mode.&nbsp; A remedy here is to use a half area, or even a quarter area if
        necessary.&nbsp; Turn on <a href="#hid_imagestageshift_usetrialsize">Use
            Trial Size</a>, adjust the binning if necessary so that there are still ~500
        pixels, and increase the beam intensity to compensate for the loss in image
        area.</P>
      <P><A name="hid_calibration_isfromscratch"></A><B>IS from Scratch command
        (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
      <P>This command will calibrate image shift in two rounds (13 pictures), without
        relying on any existing image shift calibrations. This procedure is needed for
        the first calibration in a magnification range and may be needed when the image
        shift calibration in the microscope alignment has been changed by a large
        amount. It does rely on the program's current notion of the pixel size at the
        current magnification, and can fail if that notion is way off.&nbsp; The pixel
        size will be based on either a calibrated pixel size for this magnification
        entered on a 'RotationAndPixel' line for this camera, or on the
        FilmToCameraMagnification value for this camera.&nbsp; If you have trouble with
        this procedure, start at a magnification where you can run the <A HREF="#hid_process_findpixelsize">
        Find Pixel Size command</A> successfully, and do so before starting this
        calibration.&nbsp; The program will give you a chance to use the pixel size from
        that routine if it differs enough from the one indicated by the
        FilmToCameraMagnification value.</P>
      <P><A name="hid_calibration_stageshift"></A><B>Stage Shift command (Calibration -
        Image &amp; Stage Shift sub-menu)</B></P>
      <P>This command will calibrate the relation between stage movements and position
        on the camera at a particular magnification. This calibration requires moving
        the stage over relatively large distances, not just because small movements
        would be inherently inaccurate, but also because the stage may have systematic
        and periodic inaccuracies. In the Compustage, the distance actually moved per 1
        micron of requested movement can be less or more than 1 micron by as much as
        ~15%, and the pattern of the error repeats every 40-60 microns (an effect first
        described by Pulokas et al., 1999). Stage calibration is
        done over a defined distance, taking up to 15 steps if needed to cover that
        distance. The distances in X and Y are set with two properties,
        StageCycleLengthX and StageCycleLengthY, whose defaults for Thermo/FEI scopes (62 and 41 microns) are
        based on the values found on the two Tecnais in Boulder, which match those found
        in Pulokas at el., 1999. See <A href="setting_up_serialem.htm#setup_scopecal">
          Other Microscope Calibrations</A> for instructions on assessing the cycle
        length. Even if you do not have the right cycle length, the calibration should
        be fairly accurate because it is done over a long distance.&nbsp; This effect is
        apparently minimal on JEOLs and the Hitachi HT7700, so the default there is 40
        microns.</P>
      <P>This calibration is helpful if montages are going to be done with stage shift,
        such as when making maps with the Navigator. It is recommended that you do it at
        the lowest useful magnification not in LM mode. It can be done at a higher
        magnification instead, but that will require more steps. If the Navigator is
        going to be used, the calibration should be done at 2 or 3 mags in LM mode, such
        as the highest one, an intermediate one, and one near the lowest mag where whole
        grid montages would be done. If the image on the screen appears unstable in LM
        mode (presumably due to charging effects), try using the smallest objective
        aperture that does not occlude the image on the camera.</P>
      <P>Before doing the calibration, you should have measured and entered into the
        properties file at least one pixel size in the LM range and in the regular mag
        range. The rotation angle between the lowest M-mode mag and the highest mag in
        LM mode should also be entered, unless whole image correlations are being used.</P>
      <P>You should have a specimen other than the replica grating for this calibration,
        and either one on a slot grid or one with relatively large spacing between grid
        bars. On an older Thermo/FEI scope, if the calibration is done over an area that fits within
        one grid square of the replica grating, there is a good chance that it will be
        off by 10%.&nbsp; On a JEOL, where the cycle length is probably not relevant and
        a correlation over only 20-25 microns may be accurate enough, the replica
        grating can be used, unless calibrating with a camera on an energy filter (see the
        <a href="#hid_calibration_whole_image_corr">Whole Image Corr command</a>).&nbsp;
        Also, the replica grating could be used on a Thermo/FEI scope at a mag low enough so
        that there are several grid squares in the field, provided that there is enough
        visible difference between the grid squares. Aside from this, correlations may
        not work when the image contains grid bars. There need to be image features
        useful for correlation throughout the region that will be used (~60 microns).
        Position the specimen in the middle of such a region before starting the
        calibration. If you have difficulty getting a specimen area large enough for the
        calibration, you can limit its extent with the property MaxStageCalExtent.</P>
      <P>After you start the procedure, the program will tell you how many pictures will
        be taken and the total distance over which the calibration will be done. It will
        take a series of pictures with movements in X, then a series with stage
        movements in Y. After each picture except the first in each series, it will
        toggle for a few seconds between two images that are supposed to line up. Watch
        and make sure that the images do line up. If not, stop the calibration. At the
        end it will report the transformation matrix, the maximum range for the multiple
        estimates of each factor, and the implied transformation from stage to specimen
        coordinates (provided that there is sufficient information to derive the
        latter). The variation between estimates should be less than 10%, and the stage
        to specimen transformation should be close to -1.0 0. 0. -1.0; if not, you
        should redo the calibration unless you are sure that the paired images all lined
        up well. The stage to specimen transformation can differ from -1 0 0 -1 if there
        is an error in the rotation angle for this magnification derived from the
        entries in the properties file (e.g., a 10&deg; error will result in middle terms of
        &plusmn;0.17).</P>
      <P>The calibration also reports an estimate for the rotation angle of this
        magnification; this appears to be accurate within 0.2-0.5 degrees.</P>
    <P><A name="hid_calibration_whole_image_corr"></A><B>Whole Image Corr command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>This commands toggles whether the image correlations used for stage calibration
      are done over the whole image area or just over the region of expected overlap.&nbsp;
      Whole image correlations are on by default because they work robustly with
      non-periodic specimens and make the calibration procedure immune to large errors
      in the image rotation angles specified in the properties file.&nbsp; When
      correlating just the region of expected overlap, the procedure will fail if
      these angles are off by more than 40 degrees. Whole image correlations also work
      robustly with a cross-line grating with latex beads, provided that there are
      enough beads in the field and that image distortions are not too large.&nbsp;
      They will not work when calibrating GIF images with the grating, the
      overlap-only correlations are more reliable but can also fail in that case.&nbsp;
      Use a non-periodic specimen for stage calibrations on a GIF.&nbsp; The whole
      image correlations can also fail at very low magnification if using the
      cross-line grating, because the grid bars can dominate the alignment.&nbsp; Use
      a specimen with larger grid squares and keep this option on, or turn this option
      off and make sure that the image rotation angles are approximately correct
      before calibrating the lowest magnifications. </P>
    <P><A name="hid_calibration_set_cycle_lengths"></A><B>Set Cycle Lengths command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>Use this command to set the cycle lengths for stage calibration, which
      determine the distances in X and Y over which the calibration is run.&nbsp;
      Specifically, the calibration is run over this distance, if possible, at higher
      magnifications, and over a multiple of this distance at lower magnifications
      when only three images are being acquired in each direction.&nbsp; This setting
      is temporary, not saved when the program exits; change the properties
      'StageCycleLengthX' and StageCycleLengthY' to make a permanent change.&nbsp; The
      cycle lengths should not be changed for Thermo/FEI scopes except for experimenting,
      unless it is found that the systematic variation in stage movement is minimal
      with a particular stage.</P>
    <P><a name="hid_imagestageshift_usetrialbinning"></a><B>Use Trial Binning command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>If this item is checked, then image and stage shift calibrations will take
      images at the current binning of the Trial parameters instead of adjusting the
      binning and exposure time to achieve a target size.&nbsp; This item is
      initialized from the property 'UseTrialBinningForShiftCal' and is not saved in
      user settings between sessions.&nbsp; Using a lower binning can be useful for
      achieving a good signal-to-noise ratio without saturating the camera.&nbsp; It
      will not make the cross-correlations more prone to failure, because images are
      binned again before correlation if necessary.</P>
    <P><a name="hid_imagestageshift_usetrialsize"></a><B>Use Trial Size command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>If this item is checked, then image and stage shift calibrations will take
      images at the current size of the Trial parameters instead of taking full-field
      images.&nbsp; This item is initialized from the property
      'UseTrialSizeForShiftCal' and is not saved in user settings between sessions.&nbsp;
      Although the calibrations generally have no trouble with non-square cameras,
      this setting might be needed for side-mount cameras where there is too much
      distortion outside of a square region, or for a camera with a bad area on one
      side.&nbsp; To accommodate the latter situation, subareas will also have the same
       offset from center, if any, as the Trial parameters.
    </P>
      <P><A name="hid_calibration_listisvectors"></A><B>List IS Vectors command
        (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
      <P>Use this command to get a listing of the length and angles of the image shift
        calibration vectors for all magnifications where image shift has been
        calibrated. This listing can provide a check on the accuracy of the image shift
        calibrations and, on a JEOL, reveal magnification boundaries where there are
        discontinuities in the image shift calibration.&nbsp; A length and an angle are
        computed for a change in the X image shift and for a change in the Y image
        shift. The vector lengths represent the estimated microns moved on the specimen
        per nominal micron of applied image shift, so the lengths should be near 1,
        unless using projector shifts (PLA) for image shift on a JEOL, in which case
        they should decline continuously within a magnification range.. The
        angles are angles on the specimen and they should stay constant as long as there
        is no discontinuity in image shift behavior.</P>
      <P>These estimates are based on the pixel size and image rotation angle at each
        magnification, which can be obtained in one of two ways. The pixel size can be
        derived from the nominal film magnification, the camera pixel size, and the
        magnification ratio from the film plane to the camera; while the image rotation
        angle can be derived from the magnification table. Alternatively, a calibrated
        pixel size from the property file can be used whenever available, as well as a
        calibrated rotation angle. (Note that if there is one mag with an absolute
        calibration of the angle and a contiguous series of mags with relative rotations
        entered, all of those mags are considered to have calibrated rotation angles).
        The latter option will give the most accurate estimate of the vector lengths but
        one can expect to see small discontinuities in the lengths between the mags with
        and without calibrated pixel sizes. Similarly, the angles will be most accurate
        but there will be discontinuities between mags with and without calibrated
        angles. Thus, if you have calibrated only one or two pixel sizes, just use the
        estimates based on the nominal magnification (answer NO to the query). If you
        have calibrated many pixel sizes, as is necessary on a JEOL, answer YES to use
        these pixel sizes and get the best indication of whether there are
        discontinuities that need to be specified with the OtherShiftBoundaries
        property.</P>
      <P><A name="hid_calibration_liststagecals"></A><B>List Stage Cals command
        (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
      <P>This command will convert the stage calibration for each magnification into a
        specimen to stage transformation and also show the average transformation that
        is being used regardless of mag. This allows the consistency of the calibrations
        to be assessed at any time. Transformations should be near -1. 0. 0. -1.&nbsp;
        Often when this is not the case, the first and last terms have a similar
        absolute value and the second and third terms have a similar absolute value, all
        corresponding to the sine and cosine of some angle (e.g., -0.85&nbsp; 0.52&nbsp;
        -0.47&nbsp; 0.87). This pattern indicates that the calibration is probably good
        but that the program has an incorrect notion of the absolute rotation angle at
        the given magnification.&nbsp; Transformations that do not fit this pattern are
        generally bad.</P>
    <P><a name="hid_imagestageshift_removeiscal"></a><B>Remove IS Cal command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>Use this command to remove one image shift calibration for the current camera.&nbsp;
      The program will ask for the magnification of the calibration, then show you the
      matrix and ask you to confirm the removal.&nbsp; Use
      <a href="#hid_calibration_listisvectors">List IS Vectors</a> first to see
      which calibrations have a vector length or axis angle clearly different from the
      rest.&nbsp; When an image shift calibration is done, it is saved automatically
      in the short term calibration file (SEMshortTermCal.txt) for a day, so even if
      the calibration has not been intentionally saved to the main file
      (SerialEMcalibrations.txt), it can linger to have bad effects.&nbsp; This
      command can be used to remove its effects instead of rerunning the calibration
      from scratch.&nbsp; The consequences of the command depend on whether the
      particular calibration has been saved to the main file:
    <ul>
      <li><i>Bad calibration saved to main file</i>: You must save the calibrations again to
        remove it fully; otherwise it will reappear when you restart the program.&nbsp;
        You must redo the calibration at some point to have a calibration for that
        magnification.</li>
      <li><i>Bad calibration <b>not</b> saved to file</i>: You do not need to save
        calibrations, but if you do, they will not include this calibration.&nbsp;
        Restart the program to revert to a previous calibration, if any.</li>
    </ul>
    <P><a name="hid_imagestageshift_removestagecal"></a><B>Remove Stage Cal command
      (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
    <P>Use this command to remove one stage shift calibration for the current camera.&nbsp;
      This command works just like <a href="#hid_imagestageshift_removeiscal">
            Remove IS Cal</a>, except that here you would use
      <a href="#hid_calibration_liststagecals">List Stage Cals</a> first to see which
      calibrations have a specimen to stage matrix clearly different from the rest.&nbsp; </P>
      <P><A name="hid_calibration_magisoffsets"></A><B>Mag IS Offsets command
        (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
      <P>Use this command to determine image shift offsets that will keep a feature 
        centered as magnification is changed. This calibration may be needed to get the best
        performance from the Navigator, such as when a position is marked on an image at
        one magnification and then sought at a much higher magnification. However, the 
        image shift offsets for View and Search in Low Dose mode, and the mechanism of 
        taking anchor maps at the same position as a target to be aligned to, provide 
        good alternatives to having this calibration.&nbsp; The disadvantage of the calibration is that it gets off over time more easily
      than other calibrations, and becomes invalid when magnification alignment in the
      scope itself is redone.&nbsp; It should be done only if someone is committed to 
        keeping it up to date, otherwise the Navigator will apply incorrect shifts that 
        may be worse than the uncorrected intrinsic shifts.&nbsp; </P>
    <P>One of the limitations in determining reliable offsets is the degree to which the image shifts
        when the beam is moved, which can be particularly severe in LM mode depending on
        the focus setting. To minimize the effect of this shifting, you will be advised
        to keep the beam centered in LM mode during this calibration. More importantly,
        the program will go to a standard focus in LM mode if one is defined. On a Thermo/FEI scope,
        this is defined by default to be at 'eucentric focus'; on a JEOL, a
        numeric value for the standard focus needs to be determined with the
        'ReportFocus' script command and entered as the property StandardLowMagFocus.</P>
      <P>It is recommended that the offsets be calibrated from the highest magnification
        where there is an obvious misalignment between magnifications, down to the
        lowest magnification to be used for Navigator mapping. The entire range does not
        need to be done at once. The calibration can be done just over parts of the
        range where the misalignments are bad. If the offsets are recalibrated over a
        subset of the range, the new values will be merged in with the old ones
        determined for the other magnifications.</P>
      <P>To do the calibration, you need a specimen with a feature that can be centered
        over the full range of magnifications to be calibrated. The corner of a section
        works well for this. Before you start, set up the beam to a reasonable size and
        brightness and turn on Intensity Zoom if available. Do this in both regular mag
        and LM mode. Set up Trial parameters to give an adequate image for centering the
        feature. Go to the highest magnification to be calibrated and start the
        procedure. You will see a message box with instructions, then you will be asked
        whether you want to take a trial image automatically at each new magnification.
        This is convenient if Intensity Zoom or an equivalent intensity adjustment is on, but may be problematic otherwise.&nbsp;
        Continuous acquisition mode can also be used for the routine, and there will be
        blanking during the magnification changes.&nbsp; If you use continuous mode, the
        program will skip the Trial images.&nbsp; Use the space bar to stop continuous
        mode without stopping the routine.</P>
      <P>This calibration routine is nearly unique in that it allows you to operate the program
        and waits for notification that an image is aligned. It converts the first Script
        button in the Camera &amp; Script Control Panel into a 'NextMag' button that you
        press after an image is aligned. The 'End' and 'STOP' buttons in that panel are
        used to stop the procedure. The distinction between them is that 'End' will
        record an image shift for the current magnification whereas 'STOP' will not.&nbsp; </P>
      <P>After you start the routine, center the image feature by shifting with the
        right mouse button. You can use stage shift at this point if necessary, but
        thereafter you must shift only with image shift. (The option for moving the
        stage for big mouse movements is disabled during the procedure to prevent stage
        shifts.) At each magnification, center the feature then press 'NextMag'. The
        program will make sure that you are at the correct magnification, record the
        image shift, lower the magnification, and take a picture if you selected that
        option.</P>
      <P>When you step down into LM mode, try to keep the objective aperture in,
        switching to the largest aperture when necessary, then taking out the aperture
        when necessary. On both an F20 and an F30, this has been seen to eliminate
        strange charging effects that can affect image size and position.</P>
      <P>One magnification must be set as the reference where the image shift offset is
        zero. After you end the routine, you will be asked which magnification should
        have its offset set to zero. You should specify the magnification typically used
        for tomography, so that there will not be large amounts of 'hidden' image shift
        there. If you calibrated only below that magnification, you can specify the top
        of the range that was calibrated and achieve the same result.</P>
      <P>If you have both a pre-energy filter and an energy filter camera, the setting of a reference is more
        complicated. Once an offset between the two cameras has been defined, only one
        camera can have a magnification with an offset of zero, so you will be asked to
        specify which camera this is to be.</P>
      <P>This calibration requires that image shift be calibrated at least once in every
        defined magnification range. On a Thermo/FEI scope, this just means you need at least
        one image shift calibration in LM mode, in addition to the many that you should
        have done in regular mag mode. On a JEOL, this may mean that you need to
        calibrate image shift at every mag of interest, then use 'List IS Vectors' to
        determine image shift boundaries, and define those boundaries with the
        'OtherShiftBoundaries' property.</P>
      <P>Once there is an image shift offset calibration, you can turn on 'Adjust image
        shift between mags' in the Image Alignment &amp; Focus control panel. The
        calibration routine will work with this option on, and recalibration might be
        easier with it on.</P>
      <P><A name="hid_calibration_eftemisoffset"></A><B>EFTEM IS Offset command
        (Calibration - Image &amp; Stage Shift sub-menu)</B></P>
      <P>Use this command to calibrate the image shift offset needed to align images
        from a pre-energy filter and energy filter (EF) camera. If you have such cameras, the recommended initial
        procedure would be to calibrate the image shift offsets on the regular camera,
        then run this command, then calibrate the offsets on the EF camera. However,
        they are independent procedures and you can run them in any order, and rerun one
        without having to rerun the others.</P>
      <P>This command gathers information from images that you have already collected,
        so when you start it, it will tell you what you need to have done already and
        ask if you done it. Here is the procedure:</P>
      <OL>
        <LI>
          Go to a magnification not in LM mode on the pre-EF camera and center a feature.
          If you use mouse shifting to center the feature, take a final image that has no
          mouse shifting.
        <LI>
          Copy this image to the first buffer after the buffers that roll, the usual
          autoalign buffer. (When you start the routine it will tell you what buffer it
          expects this image to be in.)
        <LI>
          Go to EFTEM mode and take an image. Center the feature using autoalignment or
          mouse shift only, not stage shift.
        <LI>
          Invoke this command. If you have not already specified which camera should have
          one magnification with image shift offset set to zero, you will be asked about
          this.</LI></OL>

      <P><A name="hid_calibration_set_is_delay_factor"></A><B>Set IS Delay Factor
        command (Calibration menu)</B></P>
      <P style="Z-INDEX: 0">Use this command to set a factor for scaling the delay that 
        occurs after an image shift.&nbsp; This change applies&nbsp;only&nbsp;during&nbsp;this session 
        of the program; a permanent value can be set with the property 
        ISdelayScalingFactor.&nbsp; This delay is imposed because it takes some time for 
        image shift to settle at the target position, particularly on&nbsp;older Thermo/FEI 
        scopes.&nbsp; Image shift delay was re-evaluated in February 2022, leading to 
        some new recommended defaults and the ability of the program to adopt the new 
        defaults automatically in some cases.&nbsp; These changes are described in
        <a href="about_properties.htm#ISdelays">ImageShiftDelays</a>,
        
         which should be read thoroughly before trying to adjust delays.&nbsp; You 
        should also make sure that there is a roughly accurate value for the camera 
        property 'StartupDelay' for any cameras where image shift settling is an issue.</P>
    <P style="Z-INDEX: 0"><em>The new way</em> to assess delays involves using a K2 or K3 
      camera and taking frames while image shift is applied with the 
      FrameSeriesFromVar command.&nbsp; (Minor program changes would be needed to use 
      other frame-saving cameras for this.)&nbsp; A typical script is:
      <BR>&nbsp;&nbsp; var = { 0.1 0 0 5 2 0 }
      <BR>&nbsp;&nbsp; FrameSeriesFromVar var 20 0.1
      <BR>&nbsp;&nbsp; Record
      <br />
    </P>
    <P style="Z-INDEX: 0">where Record is set up to save frames with a 5 sec exposure 
      and 0.08 sec frame time, and pixel size is around 1 Angstrom.&nbsp; The '2' that 
      is the next to last number in the 'var' line represents the desired image shift 
      in X to test; a shift in Y could be used instead.&nbsp; If the specimen is not 
      already stable, one or more conditioning shots should be done with no frame 
      saving.&nbsp; After the script is run:</P>
    <ul>
      <li>
        <P style="Z-INDEX: 0">
&nbsp;The frame file is opened in 3dmod to find 
      the first frame at the new position, e.g. 18.&nbsp; If the shift is not in the first 
          third of the frames, you need to adjust the StartupDelay in the camera 
          properties; if the shift is too early, adjust oneof&nbsp; the '0.1' delays in the 
          script.</P>
      </li>
      <li>
        <P style="Z-INDEX: 0">
          Alignframes is run on unnormalized frames with a command such as:
          <br />&nbsp;&nbsp; alignframes -out junk.ali -vary 0.05,0.06,0.7,0.08 -pai 13 -titl -fra 18,63 -xf 2.xf 001.tif
          <br />where the '-titl' is added to read gain reference and defect files from 
          the file header and '18' was observerd to be
          the first frame after the shift. This outputs a file of shifts in '001.2.xf'.</P>
      </li>
      <li>
        <P style="Z-INDEX: 0">
          The curve is examined with
        <br />&nbsp;&nbsp; tomodataplots -type 3 001.2.xf
        <br /> and the point is found where the drift has settled to roughly 1 Angstrom/sec.</P>
      </li>
    </ul>
    <P style="Z-INDEX: 0"><em>The old way</em> of assessing the need for more or less delay was 
      to run the&nbsp;<A href="#hid_calibration_imageshift">Image&nbsp;Shift
        command</A> in the Calibrate menu.&nbsp;&nbsp;First set the debug output key letters to
        anything&nbsp;other than 0 (1 will do).&nbsp; Also, turn off <A href="menu_camera.htm#hid_camera_postactions">
          Post-actions</A>&nbsp;in the&nbsp;Camera menu.&nbsp;Calibrate image shift and at the end it
        will print &quot;Drift converted to IS in nm:&quot; followed by 4 lines computed from each
        of the 4 times that the calibration returns to zero image shift.&nbsp; If image
        shift is perfectly settled and drift is constant with components Xdrift and
        Ydrift in the X and Y directions, then the 4 lines would all&nbsp;be&nbsp;similar and show
        Xdrift and Ydrift.&nbsp; If image shift still needs to settle by an amount
        Xsettling or Ysettling, for shifts in X or Y, then&nbsp;the lines would&nbsp;have the
        form:<BR>
        &nbsp;&nbsp; Xdrift&nbsp;+ Xsettle&nbsp; Ydrift<BR>
        &nbsp;&nbsp; Xdrift - Xsettle&nbsp;&nbsp;&nbsp;Ydrift<BR>
        &nbsp;&nbsp; Xdrift&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ydrift + Ysettle<BR>
        &nbsp;&nbsp; Xdrift&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        Ydrift - Ysettle</P>
      <P style="Z-INDEX: 0">The amount of shift due to inadequate settling&nbsp;is reflected
        by&nbsp;the differences between the first two X numbers, and between the last two Y
        numbers.&nbsp;For example, with good settling and some drift, the numbers&nbsp;in one set
        of tests&nbsp;were:<BR>
        -1.6 1.4<BR>
        -1.8 1.2<BR>
        -1.5 1.3<BR>
        -1.5 1.0
      </P>
      <P style="Z-INDEX: 0">Here, the differences reflecting settling are minimal&nbsp;(0.2
        and 0.3) and are probably just due to the fact that drift was declining during
        the run.&nbsp; With a reduced delay factor, these numbers became:<BR>
        -0.2 0.5<BR>
        -1.2 0.3<BR>
        -0.2 0.9<BR>
        -0.5 -0.5
      </P>
      <P style="Z-INDEX: 0">Here the X difference is 1.0 and the Y difference is 1.4 -
        image shift has not settled completely.&nbsp; With virtually no delay factor the
        differences become extreme (8.3 and 10.7)and no longer fit the simple model
        above because effects linger from one pair of pictures to the next:<BR>
        &nbsp;2.6 0.1<BR>
        -5.7 0.1<BR>
        &nbsp;2.5 3.7<BR>
        -0.1 -7.0
      </P>
      <P style="Z-INDEX: 0">The protocol is thus to change the delay factor and&nbsp;run the
        calibration repeatedly,&nbsp;looking for&nbsp;the delay factor at which the X and Y
        differences due to settling either become very small or stabilize.&nbsp; Do this
        at several magnifications (e.g., 5000, 15000, 25000) to make sure the scale
        factor is appropriate over a range of mags.&nbsp; On a JEOL, there may be
        differences that appear to be due to incomplete settling, but if the differences
        remain constant as the scaling factor is increased, then the lowest factor at
        which the differences&nbsp;have these stable values&nbsp;is appropriate.</P>
    <P style="Z-INDEX: 0">Note that this method cannot detect settling times less than 
      the startup time of the camera, the time from when an image is requested to when 
      the exposure starts.&nbsp; The 0.8 sec adjustment mentioned in 
      <a href="about_properties.htm#ISdelays">ImageShiftDelays</a> as the default for 
      the property 'StartupForISDelays' derives from the fact that
      the table was first prepared using a camera with that startup time.
    </P>
      <P><A NAME="hid_process_findpixelsize"></A><B>Find Pixel Size command (Calibration
        - Pixel Size sub-menu)</B></P>
      <P>Use this command to analyze an image of the cross-line replica grating in
        buffer A and determine the pixel size. &nbsp;If buffer A contains a montage center
         and B has a montage overview, B will be copied to A and analyzed.&nbsp; The program will take a filtered
        autocorrelation, which produces a square grid of correlation peaks with the
        highest peak at the center, where the image correlates perfectly with itself. It
        finds a starting peak close to the center, then locates peaks progressively
        farther out so that it can estimate the spacing between peaks from as many
        intervals as possible. Next it searches for a peak 90 degrees away from the
        starting peak, and finds peaks progressively farther out along that line. It
        averages the interval between peaks in the two directions and then computes a
        pixel size.</P>
      <P>When it is successful, this routine shows the autocorrelation in buffer A, and
        leaves the green marker on the starting peak. It writes one line to the log
        window showing the mean spacing and number of intervals in each direction, and
        the size of the pixels in the image that was analyzed, which will be a binned
        pixel size if the image was binned. It writes a second line with the unbinned
        pixel size, although if the image was read from a file it will label this as
        'APPARENTLY unbinned'. If the image was not read from a file, a final line will
        be written with the magnification index, unbinned pixel size, and magnification.</P>
    <P>Images larger than a certain size are binned down to improve the signal-to-noise ratio
      for the analysis.&nbsp; By default, the target size is picked automatically when
      using a cross-line replica grating; see the <A HREF="#hid_process_setbinnedsize">Set Binned
      Size command</A> for details. The program will output a line indicating the
      target size and the number of blocks that it expects to appear in the image.&nbsp;
      When first getting started, watch carefully that the number of blocks is close
      to correct; if it is off by much, it means that the program's current
      assumptions about pixel size are substantially off.&nbsp; The best thing to do
      in that case is to make sure the correct peak has been found, exit the program,
      and insert the pixel size for this magnification into a RotationAndPixel line in
      the camera properties.&nbsp; This better pixel size should make the routine pick
      the right binning for the whole mag range.</P>
    <P>Reported distances are in terms of pixels in the original
      image, but if you look at the actual number of pixels between peaks it will be
      smaller by the binning factor.&nbsp; Also note that dark regions are trimmed out
      before analysis.</P>
      <P>Always make sure that the correct starting point is picked - it needs to be one
        of the points closest to the center peak, not one on a diagonal, or one between
        the strong peaks. Zoom up if needed so that you can tell which point is the
        central peak. If the point is incorrect, click a correct starting point and use
        the <A HREF="#hid_process_pixelsizefrommarker">Try Again with Marker command</A>
        described next.</P>
      <P><A NAME="hid_process_pixelsizefrommarker"></A><B>Try Again with Marker command
        (Calibration - Pixel Size sub-menu)</B></P>
      <P>Use this command when the <A HREF="#hid_process_findpixelsize">Find Pixel Size
        command</A> fails to show the correct starting point in the autocorrelation.
        With the autocorrelation still in buffer A and the grating image in buffer B,
        click with the left mouse button on one of the four points that are nearest to
        the central peak of the autocorrelation. Then select this command. The program
        will use the peak nearest to the marked point as the starting peak, but will
        still have to find a peak 90 degrees away from it for measuring the other
        direction.</P>
      <P><A NAME="hid_process_setbinnedsize"></A><B>Set Binned Size command (Calibration
        - Pixel Size sub-menu)</B></P>
      <P>Use this command to set the maximum size that images will be binned to when
        running <A HREF="#hid_process_findpixelsize">Find Pixel Size</A>. The default
        value is 0, which means that the program will automatically select a binned size
        based on the expected number of blocks in the image of the cross-line replica
        grating.&nbsp; (Sizes of 1024 or 512 are used when doing catalase or grid bars,
        respectively.)&nbsp; Higher binning helps when there are relatively few peaks at
        higher maginifications, and also when the peaks appear weak relative to the central
        peak.&nbsp; If you have to set a specific size, try 512 first and adjust as
        needed.</P>
    <P><A NAME="hid_pixelsize_add_to_rotation"></A><b>Add n*90 to a Rotation command
    (Calibration - Pixel Size sub-menu)</B></P>
    <P>Use this command to adjust one of the
    rotations reported by <a href="#hid_process_listrelativerotations">List Relative
    Rotations</a> by a multiple of +/- 90 degrees.&nbsp; Enter the camera index, the
    magnification index, and the amount to add to the reported angle.&nbsp; It may
    be more convenient to use this method, at the time when the magnification in
    question is being examined, than to adjust angles when getting a final listing.</P>
    <P><A NAME="hid_process_listrelativerotations"></A><B>List Relative Rotations
      command (Calibration - Pixel Size sub-menu)</B></P>
      <P>Use this command to get a list of RotationAndPixel lines based on information
        determined with the pixel size finding routine. This information is saved
        between sessions of the program for up to 24 hours in the file
        SEMshortTermCal.txt.&nbsp; A line will be output for each
        magnification where the pixel size was also measured at the next lower
        magnification; i.e., where a relative rotation is available to be
        included in the line. However, the relative rotation values will
        sometimes have to be adjusted by 90 or even 180 degrees, either when
        there is a large rotation or when the difference is reported to be
        large for a small rotation. Whenever the difference is large, the
        program will also print an alternative difference nearer to zero, which requires
        the line to be edited manually.
        The program will also print the product of measured pixel
        size and nominal magnification (p): this value is expected to be similar for each
        magnification on the same camera. If there are outliers, the pixel size calibration
        needs to be checked.</P>
    <P><A NAME="hid_pixelsize_catalase_crystal"></A><B>Catalase Crystal
      command (Calibration - Pixel Size sub-menu)</B></P>
      <P>This command toggles whether the pixel size routine assumes that the image is
        from a catalase crystal instead of from the replica grating.&nbsp; In this mode,
        it will look for the closest-spaced regular peaks, which should correspond to
        the 6.85 nm crystal spacing.&nbsp; After picking that closest peak, it will look
        for the peaks 90 degrees away from that direction, which will be at twice the
        8.75 nm crystal spacing.&nbsp; Thus, it will report finding many fewer peaks
        along that line than along the short axis.&nbsp; The routine has not been
        optimized for this specimen.&nbsp; Make sure that it finds the closest peak in
        the correct direction, and mark that one if necessary.&nbsp; If it fails, try
        reducing the binned size to 512 with the <A HREF="#hid_process_setbinnedsize">Set Binned
      Size command</A>.</P>
    <P><A NAME="hid_pixelsize_meshforgridbars"></A><B>Mesh for Grid Bars
      command (Calibration - Pixel Size sub-menu)</B></P>
    <P>When at least two grid bars appear in the image in each dimension, you can use
      the pixel size routine to find a pixel size and grid angle, provided that you
      first use this command to indicate the mesh size of the grid (mesh openings per
      inch).&nbsp; The mesh size for the standard replica grating is 400.&nbsp; You
      will probably need to reduce the binned size to 512 with the <A HREF="#hid_process_setbinnedsize">Set Binned
      Size command</A>.&nbsp; When you are done calibrating magnifications where the
      grid bars are useful, run this mesh size command again and enter 0.&nbsp; This
      setting is not retained between runs of the program.</P>
      <P><A name="hid_calibration_autofocus"></A><B>Autofocus command
        (Calibration - Focus &amp; Tuning sub-menu)</B></P>
      <P>This command will calibrate autofocusing at the current magnification
        in TEM mode. This
        involves going to a series of defocus levels and measuring the amount and
        direction of image displacement between two pictures with the beam tilted by
        positive and negative angles. Because this displacement does not vary linearly
        with the defocus, the calibration consists of a whole curve of displacements as
        a function of defocus, rather than just the slope and magnitude of a vector.
        Nevertheless, the curve can be characterized for some purposes by a slope and
        magnitude, and these parameters are used to assess how much the curve has
        changed from the stored calibration.</P>
      <P>The defocus levels sampled in the calibration are controlled by the <A href="#hid_calibration_setfocusrange">
          Set Focus Range command</A> .</P>
      <P>Before calibrating autofocus, you should be sure that beam tilt pivot points are
        well-aligned, that there is no condenser or objective astigmatism, and that the
        Focus parameter set takes good pictures. Calibrate with a specimen that does
        not require much drift settling, and do not calibrate at high tilt. Use as high
        a beam tilt as is practicable to get the most accurate results (beam tilt can
        be set under the Focus menu). The beam tilt during autofocusing does not need
        to match the beam tilt used for calibration.</P>
      <P>Note that if image shift is calibrated at the various magnifications of
        interest on a Thermo/FEI scopes, or if a JEOL scope has good RotationAndPixel 
        properties plus image shift calibrations, there is no need to have an autofocus calibration at more than one
        or two magnifications. It is better to have a few high quality focus calibration over a
        large focus range rather than poorer calibrations at many magnifications.</P>
    <P>As of SerialEM 3.9, 10/11/20, a calibration done in low magnification will be
      used when autofocusing in LM, instead of automatically going to a standard
      focus.&nbsp; You will probably want to calibrate over a much larger range of
      focus values than the default to get sizeable changes in the shifts during the
      calibration.</P>
    <P>In STEM mode, this command is used to get an estimate of the amount that the
      beam increases in size as defocus is changed away from focus.&nbsp; The value is
      needed for autofocusing, but need not be very accurate.&nbsp; Nevertheless, if
      the program eliminates points from the fit and/or suggests that you rerun the
      procedure with a different focus range, do so.&nbsp; The focus range and number
      of focus levels to test are specified in dialog boxes when you start the
      command.</P>
      <P><A name="hid_calibration_setfocusrange"></A><B>Set Focus Range command (Calibration
          - Focus &amp; Tuning sub-menu)</B></P>
      <P>This command allows you to set the range and number of defocus levels that will
        be assessed when calibrating autofocus. After you select the command, you will
        make entries to four dialog boxes:</P>
      <OL>
        <LI>
        Total defocus range to measure shifts over: The program will sample defocus
        levels from half this range above the current defocus to half this range below
        the current defocus, or will offset the whole range from the current defocus if a
          non-zero offset is entered in the fourth box.
        <LI>
        Number of focus levels to test: This determines the interval of sampling; i.e.,
        the total defocus range divided by this number minus 1.
        <LI>
          Number of levels to smooth over (0 for none): The entry controls the amount of
          linear smoothing of the curve, with no smoothing if 0 is entered. Smoothing
          will reduce the effects of variability in the individual measurements. A value
          of 3 is recommended.</LI>
        <LI>
          Offset to apply to the whole range to be tested (negative for underfocus).</LI>
    </OL>
      <p>
        For Falcon 2 and 3 cameras, the standard range generally runs into problems 
        with the Falcon Dose Protector, usually just at the overfocus levels.&nbsp; The 
        easiest solution is to offset the range with the fourth entry.&nbsp; However, 
        unless there is a reason to measure at higher underfocus than normally, the range 
        should be
        restricted as well as the offset.&nbsp; The program will suggest values for the
        first and fourth entries that will restrict the range on the overfocus side
        only.</p>
      <P><A name=""></A><B>Extended Autofocus command
        (Calibration - Focus &amp; Tuning sub-menu)</B></P>
      <p>This command will calibrate autofocus over a wider range of defocuses, doing 
        the same defocus steps within the range used for the regular calibration, but 
        calibrating at a sparser interval outside that range and with smaller beam tilt 
        to avoid excessively large image displacements.&nbsp; The calibration is 
        particularly useful when autofocusing with the View area in Low Dose mode using 
        a sizeable View defocus offset or when using the View area for doing 
        the <A HREF="menu_tasks.htm#hid_eucentricity_eucentricitybyfocus">Eucentricity by Focus</A> 
        task even without a large offset.&nbsp; It would also allow one to take a 
        calibration at higher magnification with much finer spacing than the default 
        near focus, but the same or larger range than usual.&nbsp; The full range and interval outside the regular range are set with 
        the next command and have defaults of -300 to 100 microns at a 20 micron 
        spacing.&nbsp; The command should be run outside of Low Dose mode, with the 
        magnification set at the desired level (e.g., the typical View area magnification 
        in Low Dose mode).&nbsp; You need to make sure that the program can take usable 
        Focus images at the low and high end of the defocus range.&nbsp; The actual 
        interval in the extended range will be somewhat less than the specified interval 
        in order to fill each end of the range with equally spaced measurements.</p>
    <p>To prevent image displacements from becoming too large to measure at the most 
      extreme defocuses, use full-field images as well as a smaller beam tilt in the 
      extended region.&nbsp; If calibrating a range of about +/-100 microns at higher 
      magnification, you may need to reduce the beam tilt by more than the default 
      amount.&nbsp; This is less likely to be needed when doing a calibration over a 
      wider range to be used in View, because the field of view is much larger.</p>
     <P><A name="hid_focustuning_setextendedrange"></A><B>Set Extended Range command (Calibration
          - Focus &amp; Tuning sub-menu)</B></P>
      <p>This command lets you set the lower and upper defocus limits, the 
        approximate defocus interval, and the reduction in beam tilt to use in the <A href="#hid_calibration_autofocus">Extended Autofocus</A>
         calibration outside the regular range.&nbsp; Four entry boxes will appear for 
        the four parameters.&nbsp; The lower, underfocus limit should be a negative 
        value.&nbsp; It should be set to the lower of two values:</p>
    <ol>
      <li>The most negative View defocus offset that might be used for autofocusing in 
        general, and</li>
      <li>The most negative View defocus offset that might be used in the
        <A HREF="menu_tasks.htm#hid_eucentricity_eucentricitybyfocus">Eucentricity by Focus</A> 
        task, minus the biggest Z changes that would typically occur when using this 
        calibration in that task. </li>
    </ol>
      <p>
        Thus, the default value of -300 would cover both general autofocusing with an 
        offset of -300, and autofocusing in the eucentricity task with an offset of -200 
        and Z changes up to about 100.&nbsp; Note that it is recommended that the 
        eucentricity task not be done with such high defocus values if a less negative 
        one can be used reliably.</p>
    <p>
      The upper, overfocus limit should be positive and set to cover the range of Z 
      changes that might need to be found in the
        <A HREF="menu_tasks.htm#hid_eucentricity_eucentricitybyfocus">Eucentricity by Focus</A> 
      task if there is no sizeable defocus offset.&nbsp; The default value of 100 
      should be adequate.</p>
    <p>
      The interval has a default of 20 and the program will insist that it be at least 
      6 microns, the default for the regular range.&nbsp; The beam tilt reduction has 
      a default of 0.5 and is constrained to between 0.1 and 1.</p>
      <P><A name="hid_calibration_standardlmfocus"></A><B>Standard Focus command
          (Calibration - Focus &amp; Tuning sub-menu)</B></P>
      <P>This command will store a standard or absolute focus value that can be
        reapplied in various situations.&nbsp; In low magnification,
        use the command to record the current defocus as a
        standard focus that will be used when calibrating image or stage shift or
        taking montages. You can calibrate the
        standard LM focus at one magnification if that is sufficient, or you can do the
        calibration at as many magnifications as are necessary. When the standard focus
        is needed at an uncalibrated low magnification, the program will take the
        calibration from the nearest calibrated LM one, or just assume a value of 0 on
        a Thermo/FEI scope if there are no calibrations in LM. The script command
        &#39;SetEucentricFocus&#39; can also be used to set the focus in this way when in LM.</P>
    <P>If not in LM, use this command to store a eucentric focus value for the current
      magnification.&nbsp; The script command &#39;SetEucentricFocus&#39; can be used to return
      to this focus value, and again it will use the value from the nearest nonLM mag
      if there is not one at the current mag.&nbsp; However, on a Thermo/FEI scope, a
      warning will appear in the log when this substitution occurs. </P>
    <P>&nbsp;If you need to replace existing calibrations, see the entries for
      &#39;StandardLMFocus&#39; near the end of the SerialEMcalibrations.txt file to
      determine which magnifications were calibrated previously.</P>
      <P><A name="hid_calibration_stemfocusvsz"></A><B>STEM Focus Vs. Z command
          (Calibration - Focus &amp; Tuning sub-menu)</B></P>
      <P>Use this command to calibrate the relationship between defocus change in STEM
        mode and a change in physical Z height.&nbsp; On the JEOL the relationship is
        close to linear and you will use the output to set a value for the property
        STEMdefocusToDeltaZ.&nbsp; On a Thermo/FEI scope, the relationship is nonlinear and
        may even be specific to the spot size, so the curve from this routine will be
        stored as a calibration.&nbsp; The program will step through a range in Z,
        autofocusing at each step, and smooth the curve at the end by averaging over
        successive sets of three measurements. You need to have a specimen and imaging
        conditions under which autofocusing works well.&nbsp; You should also make sure
        the stage is at the eucentric height.&nbsp; When you select the command, you
        will make entries to two dialog boxes:</P>
    <ol>
      <li>Total Z range over which to measure focus.&nbsp; The program will step from
        half this range below the current Z to half this range above 1.</li>
      <li>Number of Z levels to measure focus at.</li>
    </ol>
    <p>
      When the routine is done, it reports the slope over the whole set of smoothed
      points, and over the lower, middle and upper halves.&nbsp; For a JEOL, the slope
      over the whole curve might be the best value to use for STEMdefocusToDeltaZ.&nbsp;
      For a Thermo/FEI scope, you should also enter this property, using the slope over the
      middle of the curve.</p>
    <p>
      <A name="hid_autofocusfocus_basefocusvalues"></A><B>Base Focus Values command
        (Calibration - Focus &amp; Tuning sub-menu)</B></p>
    <p>
      <i>On the Hitachi HT7700</i>, use this command to record the objective lens
      values at each magnification in HR and HC modes, and the intermediate 1 lens
      value at each magnification in LM mode.&nbsp; When changing between
      magnifications, the microscope changes the focus lens value by a certain amount;
      this calibration is needed so that SerialEM can subtract off such changes and
      show a constant defocus when magnification changes.</p>
    <p>
      <A name="hid_focustuning_ctf"></A><B>Astigmatism by CTF command
        (Calibration - Focus &amp; Tuning sub-menu)</B></p>
    <p>
      Use this command to obtain a calibration for correcting astigmatism by CTF
      fitting to images with Thon rings.&nbsp; The program will measure the amount of
      astigmatism induced by setting the X and Y objective stigmators to positive and
      negative values.&nbsp; The images used for calibration should satisfy the
      various criteria described in <a href="menu_focus.htm#autotuning_by_ctf">
      Autotuning by CTF Fitting</a>.&nbsp; The calibration should be done at a fairly
      high magnification for more accurate fitting (e.g., pixel size around 0.25 nm).&nbsp;
      The defocus should be -1.5 to -2.5 microns.</p>
    <p>
      The stigmator change should be set so as to get
        an astigmatism value of ~0.8 microns from the CTF fitting.&nbsp; The easiest way to determine
      this is just to run the calibration and see how big the &#39;astig&#39; value is after the
        first fit with stigmation applied.&nbsp;&nbsp; Then use the
      <a href="#hid_autofocusfocus_setupastigmatism">Setup Astigmatism</a> command to
      change the stigmator value to achieve the desired astigmatism instead.&nbsp; If
        the calibration gives astigmatism that cannot be fit (a non-elliptical pattern)
        then use that command to reduce the value by a factor of ~3.&nbsp; The default
        is 0.04 as of SerialEM 3.7.6.&nbsp;&nbsp; These values have been found
        useful for Thermo/FEI scopes: 0.1 for Tecnais, 0.3 for Krios, 0.3 for a Glacios, 0.5
        for a Talos 120C. Once an appropriate value is determined, the default
      value can be set with the second entry to the property &#39;AstigmatismParams&#39;.</p>
    <p>
      <A name="hid_autofocusfocus_astigmati"></A><B>Astigmatism by BTID command
        (Calibration - Focus &amp; Tuning sub-menu)</B></p>
    <p>
      Use this command to obtain a calibration for correcting astigmatism
      by beam-tilt induced displacements.&nbsp; The
      program will measure the relationship between settings of the objective
      stigmator and the amount of shift in the image induced by beam tilt in two
      different directions.&nbsp; It also needs to measure these shifts for a known
      focus change.&nbsp; It starts by measuring the current defocus, then it measures
      the beam-tilt induced shift at focus levels above and below a middle focus
      value.&nbsp; It returns to the middle focus value and measures beam-tilt induced
      shift for positive and negative changes in the X and Y stigmators.&nbsp;
      Matrices are computed from these measurements.</p>
    <p>
      Since the measurements are similar to what occurs with autofocusing, the Focus
      parameters are used.&nbsp; There should be a specimen with some features in it;
      the beam intensity and exposure should be high enough to give clean images and
      accurate autofocusing.</p>
    <p>
      Several parameters need to be in the right range to get an accurate calibration:</p>
    <ol>
      <li>Magnification should be high enough to get substantial shifts.&nbsp; The
        unbinned pixel size should be at most 0.5 nm for phosphor-based cameras at
        200-300 KV, or at most 1 nm otherwise (&lt; 200 KV or direct detectors).&nbsp; You
        may want to calibrate at a magnification where this is the case, plus one about
        3 times higher.&nbsp; Focus images can be binned by 4 for phosphor-based cameras
        at 200-300 KV or by 2 otherwise; results may be slightly more accurate with half
        that binning.</li>
      <li>Beam tilt for the calibration should be about twice that used for
        autofocusing, or about 3 milliradians.&nbsp; This may require removal of the
        objective aperture.&nbsp; It is possible to use a smaller beam tilt for
        astigmatism correction; e.g., one the same as for autofocusing.&nbsp; Beam tilt
        is set with the <a href="menu_focus.htm#hid_focus_setastigbeamtilt">Set Astig
        Beam Tilt</a> command in the Focus menu.&nbsp; On non-Thermo/FEI scopes, the entry box
        for beam tilt will report the scaling from percent of full-scale beam tilt to
        milliradians, estimated from focus calibrations.&nbsp; Divide the desired beam
        tilt by the scaling and round to the nearest 0.1 to get the percentage value to
        enter.</li>
      <li>The amount to change the stigmators needs to be large enough to get sizable
        differences in beam-tilt induced shift, but not unrealistically large.&nbsp; See
          the section above for values that should work on &nbsp;some Thermo/FEI scopes.&nbsp; On non-Thermo/FEI scopes, or if
        you want to check the effect of a value on a Thermo/FEI scope, use the following
        script:<br />
        ReportObjectiveStigmator<br />
        stigx = $repVal1<br />
        stigy = $repVal2<br />
        newx = $stigx + 0.1<br />
        SetObjectiveStigmator $newx $stigy<br />
        Delay 2<br />
        F<br />
        SetObjectiveStigmator $stigx $stigy<br />
        <br />
        For this to work, you will need a specimen and conditions that give good Thon
        rings in an FFT.&nbsp; Autofocus and go to 1 to 2 microns underfocus, then run
        the script.&nbsp; Compute the FFT and click at the first minimum along the minor
        axis of the ellipse to measure the maximum defocus, and along the major axis to
        measure the minimum defocus.&nbsp; The difference should be 0.7 - 1 microns.&nbsp;
          (If you have the option for CTF fitting turned on, click at the first minimum
          midway between the axes and use the &#39;astig&#39; value that it reports.)&nbsp; Adjust the value &#39;0.1&#39; in the script to achieve this.</li>
    </ol>
    <p>
      Calibrations are stored separately for different magnifications, probe mode on
      a Thermo/FEI, or alpha on a JEOL.&nbsp; The
      <a href="menu_focus.htm#hid_focus_correctastigmatism">Correct Astigmatism</a>
      routine will chose a calibration from the nearest magnification with a matching
      probe mode or alpha.</p>
    <p>
      After determining beam tilt or stigmator values different from the default, add
      a property <a href="about_properties.htm#AstigmatismParams">AstigmatismParams</a>
      with those values; the beam tilt will then become the default for other users
      unless they set their own values.</p>
    <p>
      The first time that an astigmatism calibration is run on a particular scope, the
      adequacy of the delay after changing astigmatism should be checked.&nbsp; Run
      Calibrate - Set Debug Output and enter c, then run the astigmatism calibration
      at the highest magnification that you plan to calibrate.&nbsp; The shift and
      drift in unbinned pixels will be reported for each measurement of beam-tilt
      induced shift, along with the &#39;operation&#39; index after &#39;oper&#39; and direction index
      atfer &#39;dir&#39;.&nbsp; Inadequate delay will show up as higher drift for direction 0
      on operations 2, 3, 4, and 5.&nbsp; If this is the case, add a property
      <a href="about_properties.htm#AstigmatismComaDelays">AstigmatismComaDelays</a>
      with a delay higher than the default of 900 msec and try again. A more unlikely
      problem is inadequate delay after changing focus, which will show up as higher
      drift for direction 0 on operations 0, 1 and 2.&nbsp; A second value on the
      <a href="about_properties.htm#AstigmatismComaDelays">AstigmatismComaDelays</a>
      property can be used to set a delay higher than the default of 500 msec.</p>
    <p>
      <A name="hid_autofocusfocus_setupastigmatism"></A><B>Setup Astigmatism command
        (Calibration - Focus &amp; Tuning sub-menu))</B></p>
    <p>
      Use this command to set some of the parameters for calibrating astigmatism.&nbsp;
      The program will ask for the amount to change the objective stigmators, the
      middle focus at which to vary astigmatism, and the total focus range over which
      to measure the relationship between focus and beam-tilt induced image shift.&nbsp;
      The first value is important, as discussed for the previous command, but the
      defaults for the others are probably fine.</p>
    <p>
      <A name="hid_autofocusfocus_coma"></A><B>BTID Coma-free Alignment command
        (Calibration - Focus &amp; Tuning - Old Coma-free Alignment sub-menu)</B></p>
    <p>
      Use this command to obtain a calibration for running the
      <a href="menu_focus.htm#hid_focus_coma">Coma-free Alignment by BTID</a> routine, which
      will adjust beam tilt to near zero by measuring beam-tilt induced displacements.&nbsp;
      This method should no longer be used; it has been superceded by the more
      accurate <a href="menu_focus.htm#hid_focus_coma_by_ctf">Coma-free Alignment by CTF</a>
      routine.</p>
    <p>
      &nbsp;The calibration involves measuring the
      difference between beam-tilt induced displacements at various beam tilt
      misalignments away from the current setting.&nbsp; From differences at negative
      and positive misalignments, it computes a matrix based on differences of these
      differences.&nbsp; It is thus particularly important for the displacements to be
      measured accurately, which means this procedure needs to be done with a large
      beam tilt and at fairly high magnification.&nbsp; Another important point is
      that the coma-free alignment must use displacements with the same beam tilt as
      for a calibration.&nbsp; With regard to the parameter settings:</p>
    <ul>
      <li>The maximum beam tilt needs to be at least 10 milliradians; ~15 may give
        better results; higher than this may be counterproductive.&nbsp; This beam tilt
        is set&nbsp; with the <a href="menu_focus.htm#hid_focus_setcomabeamtilt">Set
        Coma Beam Tilt</a> command in the Focus menu.&nbsp; If there are existing
        calibrations, the entry box will show their beam tilt values, so that one can
        pick an existing value.&nbsp; Otherwise, on non-Thermo/FEI scopes, the entry box will
        report the scaling from percent of full-scale beam tilt to milliradians,
        estimated from focus calibrations.&nbsp; Divide the desired beam tilt by the
        scaling and round to the nearest 0.1 to get the percentage value to enter.
      </li>
      <li>The magnification needs to be high enough so that the unbinned pixel size is
        no more than 0.15 nm for phosphor-based cameras at 200-300 KV, or no more than
        0.3 nm otherwise (&lt; 200 KV, or direct detectors).</li>
    </ul>
    <p>
     As for astigmatism calibration, the Focus parameters are used.&nbsp; There
      should be a specimen with some features in it; the beam intensity and exposure
      should be high enough to give clean images and accurate autofocusing.</p>
    <p>
      The objective aperture needs to be removed for the calibration procedure.&nbsp;
      The <a href="menu_focus.htm#hid_focus_coma">Coma-free Alignment</a> routine will
      use only half the maximum beam tilt reached in the calibration, so it may be
      possible to run that with the objective aperture in, if it is large enough and
      well-centered.&nbsp; Calibrations can be stored with different beam tilts even
      at the same magnification, if there is a need to run the alignment with
      different beam tilts in different situations.&nbsp; Calibrations are stored
      separately for different magnifications, probe mode on a Thermo/FEI, or alpha on a
      JEOL.&nbsp; The <a href="menu_focus.htm#hid_focus_coma">Coma-free Alignment</a> routine will
      chose a calibration from the nearest magnification with a matching beam tilt and
      matching probe mode or alpha.</p>
    <p>
      After determining a beam tilt different from the default, add a property
      <a href="about_properties.htm#ComaParams">ComaParams</a> with that value; the
      beam tilt will then become the default for other users unless they set their own
      values.</p>
    <p>
      The first time that a coma-free calibration is run on a particular scope, the
      adequacy of the delay after changing beam tilt should be checked.&nbsp; Run
      Calibrate - Set Debug Output and enter c, then run the coma-free calibration at
      the highest magnification that you plan to calibrate.&nbsp; The shift and drift
      in unbinned pixels will be reported for each measurement of beam-tilt induced
      shift, along with an &#39;operation&#39; index after &#39;oper&#39;.&nbsp; Inadequate delay will
      show up as high drift values, particularly for the operations that involve the
      greatest initial beam tilt (0, 4, 5, and 7).&nbsp;&nbsp; If drift is high, the
      delay can be increased from its default of 500 msec with the third value in the
      property <a href="about_properties.htm#AstigmatismComaDelays">
      AstigmatismComaDelays</a> (if you have to add the property, use the defaults for
      the first two delays).</p>
    <p>
      To assess the precision of the calibration, you should run it twice under the
      same conditions.&nbsp; The program will always report the mean and maximum
      difference between a previous and new calibration, averaged over the 8 matrix
      terms of the calibration and expressed as a percentage of the largest term.&nbsp;
      It is probably best to get a mean and maximum of 5 and 10%, respectively, or
      less.&nbsp; The two ways to reduce these errors are to increase the
      magnification and the beam tilt; the latter will have a bigger effect.</p>
    <p>
      <A name="hid_autofocusfocus_setupcoma"></A><B>Setup BTID Coma-free command
        (Calibration - Focus &amp; Tuning - Old Coma-free Alignment sub-menu))</B></p>
    <p>
      Use this command to set the defocus at which the coma-free calibration and
      alignment will run.</p>
    <p>
      <A name="hid_autofocusfocus_listcalibrations"></A><B>List Calibrations command
        (Calibration - Focus &amp; Tuning sub-menu)</B></p>
    <p>
      Use this command to list all focus calibrations by magnification and camera,
      plus astigmatism and coma-free calibrations with their conditions.</p>
      <P><A name="hid_beamspot_illuminatedarealimits"></A><B>Illuminated Area Limits command (Calibration - 
        Beam &amp; Spot sub-menu)</B></P>
      <P>Use this command to calibrate the limits of the illuminated area readout from 
        the microscope at each spot size and in nanoprobe and microprobe.&nbsp; 
        Recording these values is designed to protect the validity of calibrations 
        involving beam intensity when the microscope alignment values that determine the 
        relationship between underlying lens values and illuminated area readout change.&nbsp; 
        These limits, or the single pair of limits provided by the 
        &#39;IlluminatedAreaLimits&#39; property, determine the scaling between illuminated area 
        and the intensities that are stored intenally.&nbsp; The first time that these 
        limits are calibrated, the intensity values stored in various calibrations and 
        some user settings are scaled for the change in the limits from the property 
        value, so that these intensities will map to the same illuminated area.&nbsp; If 
        the limits change after that and the calibration is run again, it will restore 
        the proper mapping of values without any need to scale internal intensity 
        values.&nbsp; This procedure is based on the assumption that such a change in 
        the limits just reflects a change in scaling between lens values and the 
        readout, not a change in the relationship between lens values and the actual 
        beam size.</p>
    <P>If you find that the illuminated area readout from the scope is off from the 
      true beam size by enough that it needs to be fixed and this calibration has <em>
      not</em> been done, run this calibration <em>first</em> to record the current values. 
      Then get the readout fixed and run this calibration again.</p>
    <P>The calibration must be run with the largest condenser aperture in because the 
      illuminated area readout is scaled for aperture size.</p>
      <P><A name="hid_calibration_beamcrossover"></A><B>Beam Crossover command (Calibration
          - Beam &amp; Spot sub-menu)</B></P>
      <P>This command allows a calibration of the condenser lens setting for beam crossover at each
        spot size. This calibration is needed in order to maintain beam intensity
        calibrations on both sides of crossover. In addition, this calibration should
        be done before the beam and spot intensity calibrations because the crossover
        value is stored when those calibrations are done. If the beam crossover
        changes, which can occur as a result of some alignment procedures on Thermo/FEI scopes, then
        rerunning this calibration will adjust the C2 settings appropriately in the
        beam and spot calibrations. First make sure you are at eucentric focus.
        Go to a high magnification where crossover can be
        visualized easily. After you select the command, the program will cycle though
        the spot sizes and ask you to bring the beam to crossover at each.</P>
    <P><i>For a Titan microscope,</i> you will be asked to enter the size of the C2
      aperture after running this command, unless the program can access the aperture 
      size on the scope.</P>
      <p>
        <br />
        <em>For a Thermo/FEI scope with fringe-free illumination</em> and constant 
        brightness in nanoprobe, such as the Glacios 2, skip this calibration and the 
        beam intensity calibration in nanoprobe, and add the property 
        &#39;ConstantBrightnessInNano 1&#39;.</p>
      <P><A name="hid_calibration_beamintensity"></A><B>Beam Intensity command (Calibration
          - Beam &amp; Spot sub-menu)</B></P>
      <P>This command will calibrate beam intensity for the current spot size, starting
        at the current intensity and going down to intensities needed at magnifications
        below 10000x. SerialEM uses these calibrations to change intensity by a desired
        amount rather than to achieve an absolute intensity level. The range of
        magnifications is needed so that the program can use the calibrations to set
        intensity properly when going to low magnification during various procedures.
        This is preferable to simply relying on the intensity zoom feature. The Beam
        Crossover calibration should be up to date before this calibration is done.&nbsp;
        The calibration must be done outside Low Dose mode.&nbsp; The calibration is
        specific to the side of crossover on which it is run, and so would need to be
        run on both sides of crossover if you plan to work on both sides.</P>
      <P>To prepare a calibration, start with the brightest beam that anyone might need
        calibrations for. For example, go to the highest magnification that might be
        used for tilt series, and condense the beam until it is slightly bigger than
        the field of the CCD camera. For an extra margin of safety, you could start one
        or two magnification steps higher. Also, if the beam is too bright when
        condensed that much, you can start at a higher magnification and with the beam
        spread more. Another reason to start at a higher magnification is if the beam is
        not very uniform; for a non-FEG microscope, you are probably better off
        spreading the beam at least as large as the screen. Select this command to start the procedure, then check that the
        beam is still centered. (On Thermo/FEI scopes, the C1 lens (spot size) is normalized,
        which can affect the beam size and position.&nbsp; Also, on Titan scopes, the 
        beam position may not be right when the flu screen is retracted only once, so it 
        is recommended that you retract and reinsert the screen before centering it, or 
        else center it on a live image from a camera). The program will determine an
        appropriate binning for short exposures, then take images with successively
        lower intensity, increasing the binning, decreasing the magnification, and
        increasing the exposure time as needed to cover a very wide range of intensity.
        Do this procedure without a specimen in place.</P>
      <P>In Administrator Mode, the program will output the calibration table for each
        magnification, consisting of the number of unbinned camera counts per second at
        the starting magnification, and a C2 setting. The third number on each line is
        the number of retries before getting a current in the right range at each step.
        If the latter is more than 1 a lot of times, or if the calibration fails, the
        first recourse is to increase the property BeamCalSpacingFactor to 1.2.&nbsp; If images appear saturated, you may need to adjust the maximum number of
        counts, or the minimum exposure time. For information on these and other
        properties controlling the procedure, see <A href="about_properties.htm#beamcal_properties">
          Beam intensity calibration properties</A></P>
    <P><i>If you have a K2/K3 camera</i>, the preferred option is to do intensity calibrations
      on a different camera.&nbsp; If you must use the K2/K3, then at least the higher
      spot sizes may require a change of properties to the following:<br />
&nbsp;&nbsp; BeamCalMinExposure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.1<br />
&nbsp;&nbsp; BeamCalMaxExposure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.4<br />
&nbsp;&nbsp; BeamCalMinCounts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10000<br />
&nbsp;&nbsp; BeamCalMaxCounts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30000<br />
&nbsp;&nbsp; BeamCalInitialIncrement&nbsp;&nbsp; 0.0002<br />
&nbsp;&nbsp; BeamCalSpacingFactor&nbsp;&nbsp;&nbsp; 1.2
      <br />
      As of SerialEM 3.7, the first four are set automatically, and
      the property values are ignored.&nbsp; In addition, this version will use
      counting mode when the starting dose rate is below 20 electrons/unbinned
      pixel/sec (or 75 on a K3 camera).</P>
    <P>For the weakest spots, you must be sure to condense the beam to be
      tight around the field of view of the camera before starting, so that you are
      working with as bright a beam as possible when starting.&nbsp; The problem with
      the K2 (and the K3 to lesser extent) is that the noise becomes too big once the beam gets weak, so the
      procedure has to be run in a way that keeps dropping the magnification instead
      of making the beam much weaker.&nbsp; Using counting mode where possible
      alleviates this problem.</P>
    <P><i>For a Ceta camera,</i> noise is also a problem when the counts get low.
      Modify the properties to the following, adding the last one to make the
      calibration routine behave as it does for a K2/K3.&nbsp; These values have
      worked in the past, but recently (as of June 2020) a few non Ceta-D cameras have
      needed the values shown for Ceta-D.&nbsp; The general procedure would thus be to
      check the saturation level of the camera; if it is around 6000, use the values
      for Ceta-D; if it is some other value under 35000, use 85% of saturation for the
      &#39;BeamCalMaxCounts&#39; and 10% for &#39;BeamCalMinCounts&#39;.<br />
&nbsp;&nbsp; BeamCalMinExposure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.1<br />
&nbsp;&nbsp; BeamCalMaxExposure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      3.0<br />
&nbsp;&nbsp; BeamCalMinCounts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      2000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (use 500 for <strong>Ceta-D</strong>)<br />
&nbsp;&nbsp; BeamCalMaxCounts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      (use 5000 for <strong>Ceta-D</strong>)<br />
&nbsp;&nbsp; BeamCalInitialIncrement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0002<br />
&nbsp;&nbsp; BeamCalSpacingFactor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2<br />
&nbsp;&nbsp; BeamCalFavorMagChanges&nbsp; 1</P>
    <P>These settings will also work for a Falcon 4 camera, with BeamCalMinCounts set
      to 1000.</P>
    <P><i>For a Titan microscope,</i> you will be asked to enter the size of the C2
      aperture after running this command, unless the program can access the aperture 
      size on the scope.&nbsp; SerialEM uses the illuminated area
      readout as an intensity measure, and the microscope scales this readout by the
      aperture size.&nbsp; Thus, intensity calibrations are valid only if the program
      knows both what aperture size the calibration was obtained at, and what the
      current aperture size is. Use the  <A href="menu_tasks.htm#hid_calibration_set_aperture_size">
      Set Aperture Size</A> command in the Tasks menu to inform the program when the C2 aperture has
      changed. </P>
    <P>If you have existing calibrations from before this feature was added to keep
      track of the aperture, you can edit the SerialEMcalibrations.txt file to insert
      the aperture size if you know it.&nbsp; Look for each line starting with
      'BeamIntensityTable'.&nbsp; If the line has 5 numbers then the mag, you can
      insert the aperture size (in microns, without a decimal point) just before the
      mag.&nbsp; If the line has 6 numbers then the mag and the last one before the
      mag is 0, you can replace the 0 with the aperture size.&nbsp; Also, if you know
      the aperture size at which the crossover calibration was done and there is no
      line with 'CrossCalAtC2Aperture', you should add a line with
      'CrossCalAtC2Aperture' followed by the aperture size.&nbsp; Finally, if you know
      the aperture with which the spot intensity calibration was done and there is no
      line with 'SpotCalAtC2Aperture', you should add a line with
      'SpotCalAtC2Aperture' followed by the aperture size <i>listed twice</i>, once
      for each side of crossover.</P>
      <P><A name="hid_calibration_spotintensity"></A><B>Spot Intensity command (Calibration
          - Beam &amp; Spot sub-menu)</B></P>
      <P>This command will measure the relative intensity of the different spot sizes.
        With this information, the program can take a dose calibration done at one spot
        size and use it to compute the dose at another spot size. The calibration is
        specific to the side of crossover on which it is run, and so would need to be
        run on both sides of crossover if you need to transfer dose information on both
        sides. The procedure will
        take pictures with the Trial parameter set, starting at the brightest spot that
        you choose and
        working down to the dimmest spot that you specify, without changing the other condenser lens.
        Before you start it, you need to spread the beam to about the size of the
        screen, then go to the brightest spot to be calibrated and set the Trial exposure so that it gives counts
        about 1/2 to 2/3 of saturation. Then step through the spot sizes and make sure
        the beam stays on the field of the camera -- if not, spread the beam some more.
        When you select this command on a Thermo/FEI scope, the first condenser lens (spot
        size) will be normalized, so you should then check the centering and size of
        the beam before confirming that the procedure can be started.</P>
    <P><i>With a K2/K3 camera,</i> again, use a different camera instead if possible.&nbsp;
      Otherwise, set the Trial parameters for an unbinned exposure in Linear mode.&nbsp;
      The procedure should work well enough if there is still ~1 electron per unbinned
      pixel per second in an image with the dimmest spot, and if the intensity setting
      needed for this does not saturate the camera on spot 1.&nbsp; Try a 1 second
      exposure.&nbsp;&nbsp; If possible, verify with a specimen in place that an image
      with ~20,000 counts (~40,000 with no division by 2) on spot 1 does not get
      saturated.&nbsp; Then set the beam for that many counts with no specimen in
      place and see if it works down to the dimmest spot.&nbsp; Run the procedure.</P>
    <P><i>For a Titan microscope,</i> you will be asked to enter the size of the C2
      aperture after running this command, unless the program can access the aperture 
      size on the scope.</P>
      <P><A name="hid_calibration_c2factor"></A><B>Set C2 Factors command (Calibration -
        Beam &amp; Spot sub-menu)</B></P>
      <P>Use this command to calibrate the factors that SerialEM needs to convert from
        the beam intensity values available to it into values matching the C2 lens
        percentage reported in the Microscope User Interface on Thermo/FEI scopes not
        using illuminated area for intensity. Without this calibration, C2
        values shown in the Low Dose control panel and in the electron dose calibration
        procedure will not match values shown by the scope. First be sure that you
        have a C2 lens readout in your MUI workspace. Then activate the command and
        type in the value shown in the C2 readout for each spot size.</P>
      
     <P><A name="hid_beamspot_parallelillumination"></A><B>Parallel Illumination command (Calibration -
        Beam &amp; Spot sub-menu)</B></P>
      <p>Use this command to save the current intensity as one that produces parallel 
        illumination at the current spot size and probe mode (for Thermo/FEI) or alpha 
        (for JEOL).&nbsp; If there is already a value saved at these conditions, it will 
        be replaced.&nbsp; The intensity can be returned to with the 
        'SetParallelIllumination' script command when at the same spot size and probe 
        mode or alpha.&nbsp; This command is not available for Titan microscopes.
      <P><A name="hid_calibration_beamshift"></A><B>Beam Shift command (Calibration -
        Beam &amp; Spot sub-menu)</B></P>
      <P>This command will calibrate beam shift so that the beam can be moved by
        predictable amounts.</P>
      <P>To do this calibration, go to a magnification near 20K. First adjust the spot
        size and intensity so that the beam is a small, centered spot whose diameter is
        less than half the width of the camera field. Take a
        Trial exposure to verify this, and adjust exposure time or spot size to prevent
        camera saturation.&nbsp;&nbsp; (If the beam is still too bright, use a smaller
        condenser aperture, if possible.)&nbsp; Then select this command to perform the calibration. Seven
        pictures will be taken: one at the starting position, two with small movements
        of the X and Y beam shifts, and four with larger movements in both directions
        from center.</P>
    <P>On all microscopes, the beam shift calibration is stored separately for LM and
      non-LM modes.&nbsp; On the JEOL, calibrations are stored separately for GIF
      mode, for different magnification ranges separated by either image shift or beam
      shift boundaries,
      and for different alpha values.&nbsp; When PLA is being used for image shift,
      every magnification is an image shift boundary.</P>

    <P><A name="hid_beamspot_refinebeamshift"></A><B>Refine Beam Shift Cal command (Calibration -
        Beam &amp; Spot sub-menu)</B></P>
      <P>This command will refine a beam shift calibration on JEOL and Hitachi
        microscopes to be more accurate over larger distances.&nbsp; It does this by
        applying image shift over a large distance and measuring how much the beam moved
        on the camera due to the inaccuracy of the existing beam shift calibration.&nbsp;
        Specifically, the image shift equal to one camera field is applied in four
        directions to get an initial refinement; then image shift equal to your
        specified maximum distance in microns is applied in four directions to refine
        this calibration; finally the maximum shift is repeated both to show how good
        the calibration would be after the first two refinements and to obtain another
        refinement.&nbsp; If the beam stays close to stationary on that last round, then
        you can be sure that the final calibration is as good as that or even better.&nbsp;
        If the beam still moves substantially, the only way to tell how good the final
        calibration is would be to repeat the whole procedure, using this result as the
        starting point.</P>
    <P>The center of the beam can be detected in one of two ways: by the centroid of
      the image after subtracting a background, as in the original shift calibration,
      or by fitting a circle to the edge of the beam, as in beam autocentering, which
      requires a sharp beam edge as obtained with a FEG.&nbsp; 1) When using the
      centroid, the beam can be somewhat larger than for the beam shift calibration,
      up to 3/4 of the size of the field.&nbsp; If the beam is not entirely in the
      image for some of the shots, this will reduce the accuracy for that round of 4
      shots, but may not matter as long as it does not happen in the final round.&nbsp;
      2) When using the beam edge, the most accurate results will be obtained with
      nearly all of the beam edge in the image.&nbsp; In principle, the beam can even
      be larger than the field if it is shifted so that about half of the edge is in
      the field, and you may get acceptable results with such a beam.&nbsp; However,
      if the beam is not round or becomes distorted at high image shift values, a
      partial edge will give variable center estimates, so it is best to have the
      whole beam in the field in the initial image.&nbsp; The center position, radius,
      and error of the fits to a circle are output to the log.&nbsp; The range of
      radius values should be less than ~0.5% of the radius, and the error values
      should be fairly consistent; if not, the result may not be very accurate.</P>
    <P>If projector shifts (PLA) are being used for image shift, be careful not to go
      out of range at higher magnifications.&nbsp; The allowed image shift is
      inversely proportional to the magnification.&nbsp; When image shift goes out of
      range it is clipped, which will either stop the routine if a message box is set
      to appear upon clipping, or give a bad result.&nbsp; Beam shift can also go out
      of range with no warning or clipping, which will probably give a black image and
      a bad result.</P>
    <P>The calibrations prepared with this command are stored with a flag that allows
      them to coexist with other calibrations in the same magnification range (see
      previous command).</P>
    <P>This command is enabled for non-Thermo/FEI scopes provided that a beam shift
      calibration, image shift to specimen matrix, and camera to image shift matrix
      exist or can be derived for the current magnification.</P>
      <P><A name="hid_calibration_alpha_beam_shifts"></A><B>Alpha Beam Shifts command
          (Calibration - Beam &amp; Spot sub-menu)</B></P>
      <P>Use this command to calibrate how much beam shift and beam tilt needs to be changed when going
       between two low dose areas with different alpha settings on a JEOL.&nbsp; The
        program will go to a series of alpha settings, starting with the lowest, and ask
        you to center the beam at each alpha, and adjust the beam tilt if desired.&nbsp;
        First, you specify the number of alpha values to calibrate.&nbsp; If you enter
        0, this will wipe out any existing calibrations.&nbsp; Adjust the beam at each alpha setting, and press <b>OK</b>.&nbsp;
        If you press <b>Cancel</b>, beam shifts and tilts will be saved up to but excluding the
        current alpha setting.&nbsp; You do not need to be in Low Dose mode to run this procedure.</P>
    <P>When going between two Low Dose modes with different alpha settings, the
      difference in calibrated beam shift and tilt between those two alphas will be applied.&nbsp;
      Small remaining beam shifts can then be compensated using the beam offset
      feature in Low Dose mode.&nbsp; Additional small beam tilts can be compensated
      as well if the property 'LowDoseBeamTiltShifts' is set.</P>
    <P>These calibrated changes will be applied a similar fashion in two situations
      when using the Navigator: 1) when using Realign to Item in the Navigator to
      realign to a map originally taken in low dose mode, and 2) when taking an Anchor
      map where the map marked as &quot;For anchor state&quot; was taken in low dose mode.</P>
    <P><A name="hid_beamspot_spotbeamshifts"></A><B>Spot Beam Shifts command
          (Calibration - Beam &amp; Spot sub-menu)</B></P>
    <P>Use this command to calibrate the beam shifts needed to keep the beam centered
      when changing spots.&nbsp; This calibration is essential on the Hitachi HT7700
      and it might be useful elsewhere.&nbsp; For Hitachi, this calibrations has to be
      done separately for HC and HR modes; on a JEOL, it has to be done separately for
      MAG and SAMAG modes if SAMAG is defined as a secondary magnification mode.&nbsp;
      Thus, when you run the calibration, it will be done for the current mode of the
      microscope. The program will proceed from dim to
      bright spots, starting at the spot number that you specify after selecting the
      command.&nbsp; At each spot, it will ask you to confirm that you have centered
      the beam.&nbsp; You need not go all the way to the brightest spot; if you press
      Cancel instead of OK, it will not record a shift for the current spot size.&nbsp;
      Any existing calibrations will be lost; calibrations will be stored only between
      the starting and ending spot.&nbsp; When changing spot size between two sizes
      and a calibration exists at both, the program will apply the difference in
      recorded beam shifts to correct the beam position after the spot change.</P>
      <P><A name="hid_beamspot_listcalibrations"></A><B>List Calibrations command
        (Calibration - Beam  &amp; Spot sub-menu)</B></P>
        <p>Use this command to list some spot and beam related calibrations.</p>
      <P><A name="hid_calibration_magenergyshifts"></A><B>Mag Energy Shifts command
          (Calibration menu)</B></P>
      <P>Use this command to calibrate how much the zero loss peak shifts in energy when
        changing magnification. This calibration involves taking many pictures with the
        Trial parameter set. This procedure should be run with a uniform beam, i.e., no
        specimen. For the calibration, do the following:</P>
      <OL>
        <LI>
        Adjust the Trial parameters to give a quick picture with a moderate number of
        counts; for example, center 1/2 area, binned to 256x256, with an exposure that
        gives 4000 counts for a 15-bit 2K camera.
        <LI>
        Align the Zero loss peak at a mid-range magnification.
        <LI>
        Switch to Administrator mode to run the procedure from low to high then high to
        low mag, for the most accurate results.
        <LI>
        Start the calibration and respond to the series of dialog boxes. First specify
        the highest mag that should be calibrated. The default is to do 13 mags
        starting with the lowest mag in M mode.
        <LI>
        Specify the total energy range that will be scanned for the location of the
        zero loss peak. The default should work unless you have big energy shifts.
        <LI>
          Specify the step in energy for scanning the energy range, and the slit width.
          The defaults should work.</LI></OL>
      <P>At each mag, the program will scan through the range of energies and measure the
        intensity of the image, finding the center of the energy range that lets the
        beam through unimpaired. You should see images with very low counts at least at
        the beginning of each scan (the program will stop a scan when it decides that
        it has seen the peak). If you do not, you may need to redo the procedure with a
        bigger scan range.</P>
      <P>Remember to save your calibrations.</P>
      <P><A name="hid_calibration_listmags"></A><B>List Mags command (Calibration menu)</B></P>
      <P>This command will cycle through all of the available microscope magnifications
        and print in the Log Window the magnification index, the film magnification, and
        the image rotation as reported by a Thermo/FEI scope (or a 0 for a JEOL). These numbers
        are listed in the form required for the magnification table in the
        SerialEMProperties.txt file. Different numbers will be output in EFTEM mode than
        in normal lens mode. <i>On a Thermo/FEI scope</i> or a <em>JEOL scope with GIF</em> in EFTEM mode, the normal mode
        magnification and rotation will be printed on each line before the EFTEM values,
        so that the full table can be pasted directly into the properties file.&nbsp;&nbsp; However, make sure that the table entries for normal mode are correct before
        adding the EFTEM values, and that LowestMModeMagIndex is correct in the 
        properties file before running this on a JEOL with GIF.&nbsp; If necessary, correct the table for normal mode
        and add the screen down magnifications (if they differ), then restart SerialEM
        with the corrected properties file.&nbsp; Then run this command in EFTEM mode to
        get the EFTEM table combined with the correct one for normal mode.</P>
    <P><i>On a JEOL</i>, the magnification table is followed by a table
        of camera lengths, which is needed for the program to interpret diffraction mode
        correctly. This table should be cut and pasted into the properties file, with
        the first line being &#39;CameraLengthTable nn&#39;, where nn is the number of camera
        lengths listed.&nbsp; On a JEOL, if magnifications in low mag mode are disabled
        above a certain point, be sure to add the property
        &#39;HighestLMindexToScan&#39; with the number of remaining enabled LM mags before
        running this routine.</P>
      <P>In STEM mode, <i>on a JEOL</i>, the program will list all of the STEM magnifications
      and produce a table that can be inserted into the Properties file, plus an entry
      for LowestSTEMnonLMmag.&nbsp; <i>On a Thermo/FEI</i>, STEM magnifications are not identified
      by index values, so it is necessary to step through the magnifications with the
      knob on the microscope.&nbsp; The program will tell you to enable &quot;LM scan&quot; in
      the microscope STEM interface, and start at the lowest magnification that is
      reached with that enabled.&nbsp; &nbsp; After you start the calibration, you will need to step through the magnifications twice,
      first in nanoprobe then in microprobe mode.&nbsp; Be very careful not to turn the 
        knob again until the program has printed a new magnification in the log.&nbsp; 
        Press the <strong>End</strong> button when you reach the highest magnification 
        in nanoprobe; the program will switch to microprobe and tell you to go to the 
        lowest magnification again.&nbsp; Step through the magnifications again and 
        press <strong>End</strong> when done.&nbsp; At the end, the program will output 
        the table, two entries for LowestSTEMnonLMmag, and an entry for 
        LowestMicroSTEMmag.&nbsp; You may find that some magnifications show up in both 
        LM and nonLM.&nbsp; The program has no good way to distinguish these and they 
        will show up as &quot;S?&quot; in the microscope status panel.&nbsp; This may not be a 
        problem in practice.&nbsp; One solution would be to skip the LM magnifications, 
        but a better solution would be to go through a microscope alignment that sets 
        the STEM magnifications and set slightly different values that avoid the 
        duplications.&nbsp; Have this done before doing any calibrations, and get a new listing of the magnifications.</P>
      <P><em>On a Thermo/FEI scope</em>, this routine will not produce a camera length 
        table.&nbsp; The main purpose for such a table is to allow the program to display &#39;-&gt;&#39; and
          the camera length to be changed to when using the magnification/camera length
          spinner in the&nbsp; <a href="hidd_remotecontrol.htm">Microscope Control</a> panel.&nbsp; 
        You can also add calibrated pixel size or rotation angle values for selected 
        camera lengths, although that is easy to do for just a few camera lengths 
        without having the whole table.&nbsp; If you plan to use the control panel in
          diffraction mode, you can add a table prepared with the following script:</P>
      <pre>
SuppressReports
lastlen = 0
num = 0
firstEnd = 0
secondEnd = 0
loop 60 ind
   if $firstEnd > 0 and $ind < 30
      Continue 
   Endif 
   SetCamLenIndex $ind
   ReportCameraLength
   len = round ($repVal1 * 1000 0)
   if $len > $lastlen or $ind == 31
      EchoEval $ind $len
      num = $num + 1
   ElseIf $firstEnd == 0
      firstEnd = $num
   ElseIf $secondEnd == 0 and $num - $firstEnd > 0
      secondEnd = $num - $firstEnd
      Break 
   Endif
   lastLen = $len
EndLoop
echo NumberOfCameraLengths $firstEnd $secondEnd
</pre>
      Copy all of the output including the last property line into the
      SerialEMproperties.txt file, and before the table, add a line
      'CameraLengthTable' followed by the total number of lengths, i.e., the sum of
      the two values on the last line.</P>
      <P><A name="hid_calibration_neutralisvalues"></A><B>Neutral IS Values command
          (Calibration menu)</B></P>
      <P><i>On a JEOL</i>, this command will cycle through the magnifications and measure the
        neutral settings for image shift (or projector shift when using that for image
        shift) at each magnification. Once these neutral
        settings are calibrated, they will be used as a base for image shift. The
        program will display image shift relative to the neutral value. When
        magnification is changed, the program will try to compensate for a change in
        neutral value and keep the actual image shift constant.&nbsp; This command needs
        to be rerun after a service alignment that may have changed the values.&nbsp;
        Before running the calibration, make sure that the microscope alignment panel is
        set to User mode instead of Maintenance mode.</P>
    <P><i>On a Hitachi HT7700,</i> this command needs to be run to record the IA
      deflector shifts in LM mode, and either the IA or PA deflectors in HR mode,
      depending on which is being used by SerialEM for image shift there.&nbsp; (This
      is determined by the property HitachiPAforHRmodeIS.)&nbsp; There are no fixed
      alignment values for these deflectors; the scope just restores the value last
      seen at a magnification when it returns to that magnification.&nbsp; Thus,
      before running this command, you must make sure that the magnifications are
      reasonably well aligned at least in LM mode.&nbsp; Do this without SerialEM
      running, to ensure that no extraneous changes are imposed by SerialEM as well.&nbsp;
      You should do the same in HR mode if the same deflectors are being used to align
      those mags as for image shift in SerialEM. If, instead, the IA deflectors are
      used by SerialEM for image shift and the magnifications are aligned with PA,
      there is no conflict, but you should step through the HR magnifications and make
      sure that IA is zeroed out.&nbsp; After the current status of the deflectors has
      been checked, run this command to record all of their values.</P>
    <P><A name="hid_calibration_restoreneutralis"></A><B>Restore Neutral IS command
          (Calibration menu)</B></P>
    <P>On a Hitachi HT7700, use this command to restore the deflectors used for image
      shift in LM and HR modes to the values recorded with the
      <a href="#hid_calibration_neutralisvalues">Neutral IS Values</a> command.&nbsp;
      This is useful if you find the magnifications misaligned, or if SerialEM has
      left the deflectors in an inappropriate state. </P>
      <P><A name="hid_calibration_stagestretch"></A><B>Stage Stretch command (Calibration
          menu)</B></P>
      <P>Use this command to save the most recently applied transformation of Navigator
        points into a new registration in the calibrations. The transformation can then
        be used to estimate the stretch in the stage coordinate system. Such an
        estimate allows greater accuracy when transforming Navigator points using fewer
        than 5 registration points, or after aligning rotated images in the <A href="hidd_navrotalign.htm">
          Align with Rotation dialog</A> .</P>
      <P>This command is available only if the transformation was based on a fit to at
        least 5 registration points and contains a rotation between 70 and 110 degrees.
        To obtain such a transformation, go to widely separated stage positions, center
        a recognizable feature on the camera, and add either the stage position or a
        map at each location to the Navigator table. If possible, you should mark at
        least 6 registration points, as that will give a more robust transformation
        than 5. Rotate the specimen by 90 degrees, find the locations again and add a
        Navigator item at each. Mark them as registration points with the corresponding
        values, then select the <A href="menu_navigator.htm#hid_transform_pts">Transform
          Items command</A> in the Navigator menu. The error in the fit should be
        only a few microns, if possible. Then select this command. The program will
        tell you the underlying stretch implied by the transformation, and also the
        mean magnification change contained in the transformation. The latter should be
        very close to 1 (perhaps within 0.0005 of 1) and the stretch itself should be
        plausible (perhaps between 0.95 and 1.05). The transformation will be stored
        after you confirm that you want to; remember to save calibrations.</P>
      <P><A name="hid_calibration_high_defocus"></A><B>High-Defocus Mag command (Calibration
          menu)</B></P>
          <P>Use this command to measure the change in magnification and rotation between an
            image taken near zero focus and one at a high negative defocus.&nbsp; The
            program can use such measurements to adjust the stage calibration when using
            View or Search images in Low Dose mode with a large defocus offset.&nbsp; Montaging and
            Navigator operations can then operate accurately with such images. </P>
    <P>Using a View defocus of -100 microns or more can change the magnification by
      5-20% and rotate images by 2-10 degrees.&nbsp; The rotation is proportional to
      defocus but the magnification change is nonlinear, changing faster at higher
      defocus.&nbsp; Such changes are enough to make the alignment of montage pieces
      and the navigation to selected stage positions unreliable.&nbsp; One solution to
      this problem is to do the stage calibration for the View magnification at the
      desired defocus.&nbsp; However, this solution is inflexible, as it applies only
      to that defocus and may also apply only to a narrow range of beam intensities
      (at least on Tecnais, the magnification change depends strongly on the C2
      setting).&nbsp; The calibration provided here avoids these problems.&nbsp; The
      magnification change and rotation can be measured at several defocus levels and
      a range of intensity values.&nbsp; The program can then interpolate among these
      measurements to compute a good stage calibration anywhere within this range of
      conditions.&nbsp; Once you get set up to run this calibration, it is relatively
      easy and quick to run it for the different conditions.</P>
    <P>The <a href="#hid_calibration_beamcrossover">Beam Crossover</a> calibration
      should be done before this calibration so that differences between intensities
      can be assessed properly.</P>
    <P>To do the calibration, you need a specimen with enough image detail for good
      correlations, and also enough exposure to give reliable correlations.&nbsp; A
      specimen with periodic features is acceptable as long as there is not much shift
      between the near-focus and defocused images.&nbsp; The procedure is this:</P>
    <ol>
      <li>Find an area with good non-periodic image detail.</li>
      <li>Adjust the beam to the mid-range of the anticipated intensities to be used.</li>
      <li>Adjust the exposure time to give a clean enough image for correlations.</li>
      <li>If you want to reset defocus, do it before you take the first image to be used 
        in the procedure.</li>
      <li>Take an image within a few microns of zero defocus.&nbsp; If you use View in
        Low Dose mode, set the defocus offset to 0 and autofocus to the desired focus.</li>
      <li>Copy the image to the Autoalign buffer, which is shown in the 'Align To'
        button in the Image Alignment &amp; Focus control panel.</li>
      <li>Change the focus to the first focus to be calibrated, such as -100 microns.&nbsp;
        If you use View in Low Dose, just set the defocus offset.</li>
      <li>Take an image.&nbsp; You may need to adjust the exposure time to compensate
        for changes in intensity.&nbsp; You may need to shift the image to show
        approximately the same area (or very nearly the same area if there are periodic
        features).</li>
      <li>Find two well-defined points, spaced apart by at least half the width of the
        image, that are recognizable in each image.&nbsp; You can use the Insert and
        Home keys in the 6-key cluster to toggle between these buffers.</li>
      <li>Draw a line between the two points in each image.&nbsp; To draw a line, hold
        down the Shift key, depress the left mouse button with the cursor over one
        point, drag the mouse to the other point, and release the mouse button.&nbsp; 
        The program will insist on drawn lines unless you are within 10 microns of an 
        existing calibration or there are already calibrations at higher and lower 
        defocus that it can interpolate between.</li>
      <li>Run this command.&nbsp; The program will show instructions, but only once.&nbsp;
        After you press 'Yes' to proceed, the program will do a search to refine the
        scaling and rotation implied by the two lines.&nbsp; At the end, it will
        transform the image in A by the scaling and rotation and toggle between the
        near-focus image and the transformed image.&nbsp; Then it will ask you if those
        appeared aligned.</li>
      <li>Press 'Yes' to accept the calibration, or 'No' to reject it.&nbsp; If the
        images were not aligned, examine the lines to see if they can be improved, or
        increase the exposure time if necessary.</li>
      <li>Change the beam intensity by a factor of two, or to one end of the range of
        intensities that is expected to be used.&nbsp; Take an image and run the command
        without drawing a line.&nbsp; The lines are required in each image only if there
        is not already a calibration at the given defocus level.</li>
      <li>Repeat step 12 at the other end of the expected intensity range, or at several
        intensities levels spaced apart by factors of two.</li>
      <li>Change focus to the next focus level to be calibrated and repeat from step 7,
        drawing a line between the two points in the new image.&nbsp; The low-defocus
        image should still be in the Autoalign buffer with its line still present.</li>
      <li>Be sure to save the calibrations when done.</li>
    </ol>
    <p>
      On Tecnais, calibrations at -100, -200, -250, and -300 microns would provide
      sufficiently accurate interpolation for any defocus down to -300.</p>
    <p>
      The calibrations are stored separately for different spot sizes, but the program
      will simply use calibrations from the nearest spot size rather than requiring
      one at the current spot size.&nbsp; The magnification change and rotation do not
      vary significantly with spot size on Tecnais.&nbsp; You can start out by
      calibrating at the brightest spot that is expected to be used for Low Dose mode,
      and this may well be sufficient.</p>
    <p>
      Calibrations are also stored separately for nanoprobe and microprobe mode on Thermo/FEI
      scopes, and in this case only calibrations from the current mode are used.</p>
    <p>
      If you need to redo the calibrations, do them at intensities near those in the
      existing calibrations, and the program will remove each nearby existing
      calibration.&nbsp; There will be a message in the log window when this occurs.&nbsp;
      The criterion for this removal is set by the property 
      &#39;HighFocusMinIntensityDiff&#39;, which has a default of 0.2 in underlying intensity 
      units.&nbsp; Use the List Focus-Mag Cals command described next to determine the intensity
      values to use.</p>
     <P><A name="hid_imagestageshift_high"></A><B>High-Defocus IS command
        (Calibration menu)</B></P>
      <p>Use this command to calibrate how the image shift calibration changes at high 
        underfocus.&nbsp; With adequate calibrations, many things will work better when 
        using highly defocused View or Search images in Low Dose mode:</p>
    <ul>
      <li>Shifting an image with the right mouse button or shifting to a marker point 
        with Shift-P or the <strong>To Marker</strong> button will work accurately.</li>
      <li>Image shift montages will have more accurate overlaps between adjacent pieces, 
        so the piece alignments may work better.</li>
      <li>Setting the View or Search shift offset will work in one or very few 
        iterations.</li>
      <li>When Realign to Item uses image shift to go to the target position from the 
        center of the map frame, it will do so accurately.</li>
      </ul>
      <p>These operations make use of both high-defocus image shift and magnification calibrations:</p>
    <ul>
      <li>The specimen position will stay nearly centered when switching between Record 
        and View or Search areas even with a substantial image shift present.</li>
      <li>Setting the View or Search shift offset can be done with images that have a pre-existing image shift, and 
        works independent of applied image shift, thanks to the ability to maintain 
        position when switching between areas.</li>
      <li>Setting the image shift vectors for multiple Records by visualizing positions 
        on a defocused View or Search will be more accurate and might be adequate.</li>
      <li>Reset image shift will be more accurate when the current Low Dose area is View 
        or Search.</li>
      <li>Marking Navigator positions on an image-shifted View or Search image, or 
        displaying positions on such an image, will be more accurate.</li>
    </ul>
    <p>To get the calibration, the program will do an image shift calibration at a known defocus and compute 
      the change from the existing calibrated image shift matrix and the 
      measured matrix, expressing this change as a scaling, rotation, and stretch.&nbsp; 
      The scaling and rotation will be stored; the stretch (basically, the remainder 
      after accounting for rotation and scaling) is just a possible indicator of a 
      problem with the new or old matrix.&nbsp; The magnification, spot size, 
      intensity, and probe mode on a Thermo/FEI scope are also stored.&nbsp; However, 
      there is no dependence on magnification, and probably none on spot size.&nbsp; 
      There is a strong dependence on intensity on Tecnais, and a much weaker one on a 
      Talos.&nbsp; Thus, the calibration should be done at two or three intensity 
      levels bracketing where it will be needed.&nbsp; It is probably best to do the 
      calibration at a typical magnification and spot size for the defocused View 
      images; however, it should not be done in Low Dose mode, and will use the Trial 
      camera parameters as a starting point.</p>
    <P>The <a href="#hid_calibration_beamcrossover">Beam Crossover</a> calibration
      should be done before this calibration so that differences between intensities
      can be assessed properly.</P>
    <P>&nbsp;Because the existing image shift calibration is a reference, it is recommended 
      that the standard 
      calibration be redone first, near focus, so that it is up to date. Also, you 
      should set the number of rolling buffers to at least 6 so that you can check the 
      alignments if necessary (set 'Roll Buffers A -&gt; F' in the Buffer Control panel.)&nbsp; 
      Before starting each high-defocus 
      calibration, the microscope should already be at the desired defocus and 
      intensity setting, and the beam and camera settings should be appropriate for 
      doing image shift calibrations at that defocus.&nbsp; When you start the 
      calibration, you will be asked what defocus you have set the microscope to.&nbsp; 
      The first time in a session, the default choice will be -50, but thereafter it 
      should come up with the correct value based on the actual focus readings from 
      previous calibrations.</P>
    <p>The image shift calibration runs with only 6 images, 3 in each direction; drift 
      is estimated from the shift between the middle images (the second and fifth) and 
      subtracted from the measured shifts.&nbsp; The drift and the consistency between 
      shifts is reported in the log.&nbsp; If the calibration is judged bad enough, 
      you will be asked whether you want to forget it; otherwise the results will be 
      stored as a high-defocus calibration.&nbsp; You can scroll through the images to 
      check the alignment.</p>
    <p>A convenient way to do the calibration interactively at a series of defocus 
      values is</p>
    <ol>
      <li>Pick an intensity value, magnification, and spot size, and make sure that good 
        images can be obtained with a binned Trial images over the defocus range to be 
        calibrated.</li>
      <li>Set the focus increment in the Microscope Control panel to 50.</li>
      <li>Focus.</li>
      <li>Decrement the defocus by 50</li>
      <li>Run the calibration, entering -50 for the defocus, and make sure it is good.</li>
      <li>Repeat steps 4 and 5 until the highest desired defocus is reached; the correct 
        defocus should be offered in the entry box.</li>
    </ol>
    <p>
      If the whole procedure is running smoothly, an even easier way is to do step 1, 
      focus, and run a script like:</p>
      <pre>
curDef = -50
Loop 6
   CalibrateHighFocusIS $curDef -50
   curDef = $curDef - 50
EndLoop 
</pre>
      <P>This will calibrate in 50 micron steps from -50 to -300 and leave the defocus 
        at the high value.</P>
    <P><A name="hid_calibration_listfocus"></A><B>List High-Focus Cals command (Calibration
          menu)</B></P>
          <P>Use this command to list the calibrations of magnification and rotation for
            different defocus values done with the <a href="#hid_calibration_high_defocus">
            High-Defocus Mag</a> and <A href="#hid_imagestageshift_high">High-Defocus IS</A> 
            commands.&nbsp; The calibrations are sorted by defocus and
            intensity, and the list shows the scaling of the magnification and the degrees
            of rotation for each.</P>
      <P><A name="hid_calibration_cameratiming"></A><B>Camera Timing command (Calibration
          menu)</B></P>
      <P>This command will take a series of pictures to determine the timing parameters
        for the dual shuttering mode of operation with a Gatan camera, or to determine
        the startup delay for some other types of cameras, as well as the flyback time
        for a STEM camera. With a proper startup delay, the program can do several
        microscope operations (image shift, stage shift, magnification change) after the
        exposure ends for some cameras.  Also, an approximately accurate startup delay is needed
         for the delay after an image shift or other operations to be imposed correctly. The procedure
        uses full-field images binned to 1024x1024 pixels by default.&nbsp; For a
        non-STEM camera, it
        measures the mean counts in such images with
        a relatively long exposure (default 0.4 seconds). Before running the procedure,
        it is necessary to adjust the beam so as to give moderately high counts in such
        an exposure without saturating the camera. This may require a relatively dim
        beam.</P>
    <P>This routine gives unreliable results for both K2 and K3 cameras, but by
      following the notes below you should be able to get reliable post-actions with a
      K2.&nbsp; Post-actions are disabled by default for K3 cameras, and the camera
      property &#39;AllowPostActions 1&#39; would have to be added to enable them.&nbsp; It
      seemed for a while that a startup delay of 1.5 sec was reliable, until a report
      came in of problems with a delay of 1.8 sec.&nbsp; If you want to enable and try
      post-actions with a K3, add at least 0.7 to the suggested value from this
      routine and do not use a value less than 1.9 sec.</P>
    <P>For a K2 Summit or K3 camera, the procedure takes super-resolution mode images, which
      have the longest startup time.&nbsp; The mean counts do not need to be very
      high, because the mean counts in such images are very reproducible.&nbsp; The
      binning does not matter.&nbsp;&nbsp;&nbsp; </P>
      <P>When the operation is started, the program first takes several reference
        pictures. It then varies the timing of initial blanking to find a duration that
        will occlude about the first half of the exposure.&nbsp; Then it takes many
        pictures (100 by default, or 40 for K2 Summit or K3) after adjusting the timing
        parameters to give this amount of extra beam blanking; the counts in such
        pictures indicate how long this blanking occurred during each exposure. From the
        range of values, the program estimates values for several properties:
        StartupDelay and ExtraBeamTime for all non-STEM cameras, plus MinimumDriftSettling and possibly BuiltInSettling for a Gatan
        camera with two shutters.&nbsp; If the blanking apparently ended before or after
        the exposure for some of these pictures, the
        program will recommend rerunning the procedure with a longer exposure time.</P>
    <P><i>For a camera with the NoShutter property set</i>, the program will switch from
      NoShutter 2 to 1 for the timing measurements.&nbsp; This means that during the
      reference images, it will unblank before requesting the exposure and reblank
      after the image is acquired and returned.&nbsp; During the test images, it will
      unblank at various times after the acquisition is requested, but still not
      reblank until the image is returned.</P>
    <P><i>For a K2 Summit camera but not K3</i>, the procedure starts with a much longer initial
      blanking to save time.&nbsp; If this blanking is too long, a shorter value can
      be set with the general property &#39;CalibTimingK2InitialStartup&#39;.&nbsp; Because a
      startup delay measured in linear or counting mode with earlier versions of
      SerialEM would be considerably shorter and can lead to problems, the program
      will not allow post-exposure actions if the StartupDelay property is less than a
      minimum value.&nbsp; If your camera gives a startup delay less than this limit,
      the program will tell you that it is not safe to use and recommend setting the delay above the default
      minimum.&nbsp; Although it is possible to add the property &#39;K2MinStartupDelay&#39; with a number
      less than your measured delay, experience has shown that this is unreliable.&nbsp;
      This property has no effect with a K3, where initial indications are that the
      startup delay is much shorter and more reliable.</P>
    <P>As of SerialEM 3.7, K2 and K3 exposures with dose fractionation will have
      an added delay of 5 ms per frame by default (set by the camera property
      &#39;StartDelayPerFrame&#39;).&nbsp; This addition should give reliable timing even with
      the default minimum startup delay.&nbsp; The signs that the startup delay are
      too short are:
      when calibrating image shift, images after the first one may be smeared or the
      calibration may be bad; when taking tilt series, images after the first few
      tilts may be smeared; when saving frames during tilt series, the final frames of the exposure may
      have excessive drift within each frame; when using the MultipleRecord script
      command and saving frames, the frames near the end of the exposure may shift to
      the next position.&nbsp; If turning off the Post-actions
      option in the Camera menu solves the problem, then the StartupDelay is too
      short.</P>
    <P>Saving frames with the MultipleRecords&nbsp;command, taking two off-center
      shots and a center shot after them, is an efficient way to test whether the
      startup delay, or possibly the added time per frame, is too short.&nbsp;
      Problems will appear in the first two sets of frames.</P>
    <P><i>For a STEM camera</i>, the program does not use the mean counts in an exposure but
      instead finds the line in the image where the beam was unblanked.&nbsp; To take
      interpretable images, it cancels any contrast inversion or image rotation being
      done in SerialEM.&nbsp; The default exposure time is 1.2 seconds, which helps to
      give an accurate estimate of the flyback time (time between each line of
      exposure).&nbsp; Fewer test images are needed to get the final estimate of
      startup delay, so the default there is 30.&nbsp; At the end, the program will
      recommend entries for StartupDelay and AddedFlyback.&nbsp;For DigiScan, this
      should be a small number; it is added to the flyback time set in the DigiScan
      interface.&nbsp; For Thermo/FEI STEM, it will be a large and highly variable number,
      and it is necessary to run the procedure described next to get a more useful set
      of flyback times.&nbsp; The program may also recommend an entry for
      MinimumBlankingTime, which may be needed to get the next procedure to work
      reliably.</P>
      <P><A name="hid_calibration_quick_flyback_time"></A><B>Quick Flyback Time command
        (Calibration menu)</B></P>
      <P>This command will run the Camera Timing routine in a special rapid mode to
        estimate the flyback time (time between successive lines) for Thermo/FEI STEM with
        particular acquisition parameters. This is necessary because the flyback time
        for Thermo/FEI STEM varies over a large range and somewhat unpredictably, depending on exposure time, binning,
        subarea size, and to a small degree, on magnification.&nbsp; An accurate flyback
        time is needed for dynamic focusing to work optimally.&nbsp; </P>
    <P>When you select the command, the program will ask which camera parameter set to
      run the timing for.&nbsp; Answer with the first letter of parameter set name
      (upper or lower case).&nbsp; The program will then run the timing routine with
      either 3 trials at 3 startup delays or 4 trials at 4 startup delays, depending
      on exposure time.&nbsp; At the end it will report the flyback time and startup
      delay and ask if you want to store them in the table of timings, replacing an
      existing value if there is one.&nbsp; When the program exits, this table is
      automatically stored in the file SEMflybackTimes.txt in the SerialEM configuration
      directory (C:\Program Files\SerialEM or C:\ProgramData\SerialEM).&nbsp; The
      table keeps track of the exposure time, binning, image size, magnification, and
      date/time at which each measurement is made.</P>
    <P>The flyback time has a predictable, linear dependence on exposure time over
      some ranges of time.&nbsp; However, there can also be a small interval within
      such a range with values that differ from the linear relationship by 20% or
      more.&nbsp; For example, with full-sized images binned to 1K, there are special
      intervals at 3 and 6 seconds.&nbsp; Also, the slope of the linear relationship
      can change between low and high exposure times.&nbsp; When doing dynamic focus
      with a given exposure time that is not in the table, the program will attempt to
      interpolate or extrapolate from entries in the table with nearby exposure times
      and other conditions matching.&nbsp; It will even eliminate one outlier when
      finding the linear relationship between flyback time and exposure time.&nbsp;
      This estimate may be adequate over some ranges of exposure times and not good
      enough in other regions.&nbsp; You thus have three choices: 1) use dynamic focus
      only with parameters that have a measured flyback time and do not vary exposure
      during a tilt series; 2) vary exposure in discrete steps where the flyback time
      is measured (using the ability to vary parameters like exposure time during a
      tilt series); or 3) vary exposure continuously over a range where there are no
      special intervals.&nbsp; The second and third strategy in particular would
      require this timing routine to be run many times.&nbsp; There is a script
      command, 'QuickFlyback', that will run this routine and save the result
      automatically in the table for a specified camera parameter set and an exposure
      time that replaces the time in that set.&nbsp; For example, a script like this
      could be used to measure a series of times at two different intervals.<br />
      <pre>
       exptime = 0.6
      interval = 0.2
      loop 15
        QuickFlyback R $exptime
        exptime = $exptime + $interval
      endloop
      interval = 0.5
      loop 10
        QuickFlyback R $exptime
        exptime = $exptime + $interval
      endloop
      </pre>
      <P><A name="hid_calibration_shutterdeadtime"></A><B>Shutter Dead Time command
          (Calibration menu)</B></P>
      <P>This command will take a series of pictures with very short exposure times to
        determine the dead time of the beam shutter, namely the amount of exposure
        lost. The calibration is needed on JEOLs because the dead time can be ~0.01
        sec, and this can lead to incorrect shutter time changes in routines that need
        to change the shutter time to reduce specimen exposure. It cannot be run for direct
        detector cameras, which have other constraints  that prevent very small exposure times.  Before running it, set
        the Trial exposure to 0.1 second and adjust the beam and binning to give a
        moderate number of counts (1/4 - 1/2 saturation). Start the routine and accept
        the default for the starting exposure time. The program will take 7 pictures
        with progressively longer exposures and fit a line to determine the exposure
        that would give no counts. It will then redo the procedure, starting at 0.01
        sec above this exposure level. At the end it will recommend an entry for
        ShutterDeadTime in the properties of the camera in question.</P>
      <P>When there is a dead time property, the program will use this in estimating how
        to change an exposure time when going to a lower magnification, which it may
        have to do if the beam intensity cannot be lowered enough. The value is also
        used when computing the dose resulting from camera exposures.</P>
      <P><A name="hid_calibration_distortion"></A><B>Distortion command (Calibration menu)</B></P>
      <P>This command will allow you to capture a pair of images that can be used for
        measuring the microscope distortion field with programs in IMOD. The pairs can overlap side by side,
        top to bottom, or diagonally. The direction of overlap is specified by a number
        from 0 to 7. Directions 4 to 7 are equivalent to directions 0 to 3, so you just
        need to use directions 0 to 3 to obtain a complete set of the different kinds
        of overlapping pictures that will give twice as much data as unknowns when
        solving for a distortion field.</P>
      <P>Before starting, center the specimen on an area that has rich image information
        throughout. Set up Record parameters for fairly high counts in images binned to
        1Kx1K. Select the command and specify a direction for the pairs. The program
        will offer to set image shift to zero if you have not done so already. Then it
        will proceed to take overlapping image pairs with stage movement between the
        two images of a pair, until it acquires a pair with overlap within acceptable
        limits. It will try ten times. If it fails, just try again, perhaps moving to a
        new area.</P>
    <P>At high magnification, addition delay time after moving the stage may be
      needed.&nbsp; This can be imposed by setting the property &#39;DistortionStageDelay&#39;
      to the desired value in milliseconds, which will replace the default delay time
      set by the property &#39;StageMoveDelay&#39;.</P>
      <P><A name="hid_calibration_setoverlaps"></A><B>Set Overlaps command (Calibration menu)</B></P>
      <P>This command allows you to set the limits within which overlap factors must fall
        for the distortion pairs. You might need to expand the range of acceptable
        overlaps if you are trying to get pairs at a high magnification. Images
        arranged side by side or one on top of the other must meet three criteria. The
        overlap factor in the direction separating the images must fall between a
        minimum and a maximum value, and the overlap in the perpendicular direction
        must exceed a high minimum value. There are two separate criteria for images
        arranged diagonally: the minimum and maximum overlap factors, which must be met
        separately in X and Y. If you need to change these factors, try to expand the
        maxima more than you reduce the minima.</P>
      <P><A name="hid_calibration_administrator"></A><B>Administrator command (Calibration
          menu)</B></P>
      <P>This command will toggle 'Administrator mode', which will enable you to save
        calibrations. Administrator mode will also enable some procedures to make
        diagnostic outputs to message boxes or to the Log Window.</P>
      <P><A name="hid_settings_savecalibrations"></A><B>Save Calibrations command
          (Calibration menu)</B></P>
      <P>This command will save the calibrations currently in the program to the system
        calibration file (SerialEMCalibrations.txt, in the system folder defined in
        your settings file). The existing file will be renamed to
        SerialEMCalibrations.bak. As a slight protection against accidental saving of
        this file, you must activate Administrator mode to enable this command. In
        Administrator mode, the program will ask whether you want to save any changed
        calibrations before exiting.</P>
      <P><A name="hid_calibration_setdebugoutput"></A><B>Set Debug Output command
          (Calibration menu)</B></P>
      <P style="Z-INDEX: 0">Use this command to change the key letters for debugging
        output, which are specified by the entry for DebugOutput in the properties
        file. Any entry besides 0 will activate debugging output. 1 is used to get
        general output, while other letters give additional output: i for image
        shift-related items, l (lower case L) for low dose, L for more verbose low
        dose, u for update items when polling, e for event reports, and J for complete
        listing of JEOL calls.</P>
    </basefont>
  </BODY>
</HTML>

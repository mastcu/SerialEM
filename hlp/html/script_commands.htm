<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
  <HEAD>
    <TITLE>Script Commands</TITLE>
    <META content="text/html; charset=Windows-1252" http-equiv="Content-Type">
    <style type="text/css"> <!-- BODY { font-family:"Arial" }
  TD { font-size:16 }
      .style4
      {
        width: 241px;
      }
      .style7
      {
        }
      .style8
      {
        width: 215px;
      }
      .style10
      {
        width: 237px;
        height: 24px;
      }
      .style11
      {
        height: 24px;
      }
      .style12
      {
        width: 214px;
      }
      .style13
      {
        width: 237px;
      }
      .style14
      {
        width: 237px;
        height: 78px;
      }
      .style15
      {
        height: 78px;
      }
        .auto-style1 {
            width: 230px;
        }
      --></style>
  </HEAD>
  <BODY bgColor="#ffffff" text="#000000">
    <basefont size="2">
      <P><A name="script_commands"></A><B><FONT size="3">Script commands</FONT></B></P>
      <P>The script processor is case-insensitive; you can enter commands as ALLCAPS or 
        alllowercase, but for readability it is helpful to use MixedCase as in the 
        table. Completing a command by typing tab or ` will convert it to MixedCase.&nbsp; 
        In the table, the &#39;#&#39; symbols or letters after a command should be replaced by 
        an actual numeric or other entry.&nbsp;&nbsp; Brackets around an entry indicate 
        that the entry is optional; do not include the brackets in your script. When 
        there are multiple optional entries, there needs to be an entry for every one up 
        to the last one that you want to enter.&nbsp; If there are several entries 
        within one set of brackets, they must all be entered if any of them are desired.&nbsp; 
        For example, &#39;RealignToNavItem #r [#c] [#s #n #z]&#39; must have at least one entry, 
        and can have 2 or 5, such as &#39;RealignToNavItem 0&#39;, &#39; RealignToNavItem 0 1&#39;, or 
        &#39;RealignToNavItem 0 0 0.3 2 0&#39;.</P>
    <P>Commands starting with &#39;Report...&#39; will assign output to one or more variable 
        names listed after the command (omitting the &#39;$&#39;), except where the table notes 
        otherwise.&nbsp; For other commands, the table explicitly states when they 
      accept variable names.&nbsp; Arithmetic expressions can be used after virtually 
      all commands starting with 'Set' and with the commands listed in
      <A HREF="#arithForArgs">Commands Allowing Arithmetic Expressions for Arguments</A>.</P>
    <P>Some commands will call functions that may not be supported by the FEI 
      scripting adapter or JEOL scripting interface on your scope.&nbsp; In either 
      case, the program will crash if it calls a function that does not exist in the 
      scripting interface.&nbsp; (Neither of these interfaces has a version number 
      that could be used to prevent this.)&nbsp; For a JEOL, the version of TemExt.dll 
      that provides the interface may be new enough to have the function, but the call 
      will fail with an error if it is not supported by the microscope 
      software/hardware.</P>
      <BR>
      <A href="#macro_control_commands">Script Control Commands</A>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#flow_control">Flow Control Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#other_control">Other Script Operation Control Commands</A><br>
      <A href="#camera_commands">Camera Commands</A>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#acquisition_param">Acquisition and Parameter Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#continuous_mode">Continuous Mode Control</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#other_camera">Other Camera Commands</A><br>
      <A href="#buffer_file_commands">Buffer and File Commands</A>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#buffer_image">Buffer and Image Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#directory">Directory and Miscellaneous Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#imagefile">Image File Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#textfile">Text File Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#autodoc">Autodoc/.mdoc File Commands</A><br>
      <A href="#scope_filter_commands">Microscope and Filter Commands</A>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#stage_commands">Stage-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#focus_commands">Focus-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#mag_commands">Magnification-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#beam_commands">Beam-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#image_shift">Image Shift-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#misc_scope">Miscellaneous Scope Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#filter_commands">Energy Filter Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#loader_vacuum">Autoloader, Refrigerant, and Vacuum Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#piezo_commands">Piezo Drive Commands</A><br>
      <A href="#high_level_operations">Higher Level Operations and Tasks</A>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#autoalign">Autoalign-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#autofocus">Autofocus/Autotuning-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#low_dose">Low Dose Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#task_commands">Task-Related Commands</A><br>
      &nbsp;&nbsp;&nbsp;&nbsp; <A href="#navigator">Navigator-Related Commands</A><br>
      <A href="#miscellaneous">Miscellaneous Commands</A><br />
    <A HREF="#arithForArgs">Commands Allowing Arithmetic Expressions for Arguments</A><br>
      
    <P></P>
      <P><A name="macro_control_commands"></A><B>Script Control Commands</B></P>
      <TABLE border="1" cols="2">
       <TR  vAlign="top">
         <TD colspan="2"><A name="flow_control"></A><B>Flow Control Commands</B></TD>
       </TR>
        <TR vAlign="top">
          <TD class="style4">Repeat</TD>
          <TD>Place at end of script to repeat it</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Loop # [variable]</TD>
          <TD>Loop the given # of times until EndLoop; optionally set variable with index.&nbsp; 
              A loop count less than or equal to 0 is allowed and 
            will cause the loop to be skipped.&nbsp; If a script relying on this is liable 
            to run on earlier versions, it should include the line 'Require zeroloop'.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">DoLoop var #s #e [#i]</TD>
          <TD>Loop from #s to #e, inclusive, assigning the loop index to the variable &#39;var&#39;.&nbsp; 
              The optional #i can be entered to set the increment, which is 1 by default.&nbsp; 
              If the starting index is already past the ending one, the loop will be skipped.&nbsp; 
              Integer values should be entered; non-integer values will be truncated to 
              integers.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EndLoop</TD>
          <TD>Marks the end of a loop</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">DoScript #<br />
            DoMacro #</TD>
          <TD>Switches to given script #</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">CallScript #<br />
            CallMacro #</TD>
          <TD>Calls other script by # and returns</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Call text</TD>
          <TD>Calls other script by name. Names are case-sensitive and must match exactly,
            including spaces</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">CallStringArray var [#e]</TD>
          <TD>
            Places the array of strings in variable &#39;var&#39; into an &#39;extra&#39; script and runs 
            it.&nbsp; Extra scripts are temporary and available only until a script ends.&nbsp; Up to 
              5 extra scripts can be defined; they are added sequentially to positions 
              numbered 1 to 5.&nbsp; The optional '#e' can be entered to place a script into a 
              previously used position or the next unused position.&nbsp; If the script 
              depends on other temporary scripts, they can be loaded first with 
              'StringArrayToScript'.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Function name [#n] [s] [args]</TD>
          <TD>Defines a function with the given name (without embedded spaces).&nbsp; The
            optional #n indicates the number of numeric arguments and s is non-zero to
            indicate that a string argument occurs after the numeric ones.&nbsp; Optional 
            variable names can be provided for the arguments.&nbsp; Functions
            must be placed at the ends of scripts.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EndFunction</TD>
          <TD>Required ending to a function definition.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">CallFunction name [args]</TD>
          <TD>Calls the function with the given name and supplies arguments for the function
            to receive.&nbsp; If the name could occur in more than one script, it must be
            qualified with a script number or name, i.e. &#39;5::GoodFunc&#39; or &#39;Func
            Script::GoodFunc&#39;.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">If expression</TD>
          <TD>Starts a block that is executed conditionally on the value of 'expression'</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Endif</TD>
          <TD>Ends a block started with If</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Elseif expression</TD>
          <TD>Inside of an If/Endif block, starts a block that is executed conditionally on
            the value of 'expression' if the expressions in the starting If statement and
            any preceding Elseif statements were not true.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Else</TD>
          <TD>Inside of an If/Endif block, starts a block that is executed if the expression
            after the 'If' and any preceding 'Elseif' commands is false</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Break</TD>
          <TD>Stops execution of the innermost Loop containing this statement</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">KeyBreak [key]</TD>
          <TD>If the user presses &#39;B&#39;, or the key given by the optional &#39;key&#39; entry, the
            script breaks out of the innermost Loop containing this statement.&nbsp; &#39;key&#39;
            should be a letter or number; the test for the key is case-insensitive.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Continue</TD>
          <TD>Skips the rest of the current iteration of the innermost Loop containing this
            statement</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">SkipTo label</TD>
          <TD>Skips forward to the line starting with the given label, where the label has a
            colon (:) at the end of it and is the only item on the line.&nbsp; The colon is
            not included in the label in the SkipTo statement.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">OnStopCallFunc name</TD>
          <TD>Calls the function with the given name when the script is stopped by the user 
            pressing STOP or by an error in a script operation or in an external routine.&nbsp; 
            The function must not take any arguments, and it should not call other functions 
            or scripts (such calls will be skipped).&nbsp; The function will be called only 
            once, even if there is an error or STOP while it is running.&nbsp; The script 
            will be aborted (not left in a resumable state) when the end of the function is 
            reached.&nbsp; </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Return</TD>
          <TD>Without executing to the end of the current script, returns to calling script or
            ends execution if this is the top-level script</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Exit</TD>
          <TD>Ends execution unconditionally</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="other_control"></A><B>Other Script Operation
          Control Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ScriptName text<br />
            MacroName text</TD>
          <TD>Name the script to the given text, which can include spaces</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">LongName text</TD>
          <TD>A longer name to appear in the Run submenu of the Script menu; if this name is
            not defined, the regular name defined by ScriptName or MacroName appears there.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ReadOnlyUnlessAdmin</TD>
          <TD>Prevent changing the script in the script editor from this command to the end
            of the script, unless Administrator mode is 
            turned on in the Calibration menu.&nbsp; Place the command at the beginning of
            script to make the whole script read-only.&nbsp; Command added in 3.8, 12/24/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Delay # [units]</TD>
          <TD>Wait for given amount of time. The optional 'units' can be 'msec', 'sec', or
            'min'. If no units are given, a # &lt;= 60 is taken to be seconds, and a # &gt;
            60 is taken to be milliseconds</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">WaitForMidnight #B #A [Hr Min]</TD>
          <TD>If the current time is between #B minutes before and #A minutes after 
            midnight, or an alternative time specified by the optional entries Hr (the hour from 0 to 23) and 
            Min (the minute from 0 to 59), the script will wait until #A minutes after 
            midnight or the given time.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Echo [text]</TD>
          <TD>Prints the text to the log window, or a blank line if there is no text.&nbsp; 
            Variables are substituted but arithmetic expressions are not evaluated.&nbsp; 
            Multiple spaces between words are preserved.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EchoEval [text]</TD>
          <TD>Prints the text to the log window after substituting variables and evaluating 
            arithmetic expressions.&nbsp; Multiple spaces between words will be lost.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EchoNoLineEnd [text]</TD>
          <TD>Prints the text to the log window after substituting variables and evaluating 
            arithmetic expressions, without adding a line ending, so more text can be 
            written to the line.&nbsp; Multiple spaces between words will be lost.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EchoReplaceLine [text]</TD>
          <TD>Removes existing text from the log back to the last line ending, if there is 
            any such text, then prints the given&nbsp; text to the log after substituting 
            variables and evaluating arithmetic expressions, without adding a line ending.&nbsp; 
            This command can be used repeatedly to update the text on a line, such as with a 
            status output.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Pause [text]</TD>
          <TD>Opens message box with optional text plus question of whether to proceed with
            script.  Is not suppressed by NoMessageBoxOnError.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">YesNoBox text</TD>
          <TD>Opens a Yes-No message box with the given text, which should be a question that
            can be answered with yes or no. Sets ReportedValue1 to 1 or 0 for a yes or no
            answer.  If NoMessageBoxOnError is set, no box appears, the text is printed to the
            log, and the ReportedValue is 0.
          </TD>
        </TR>
       <TR vAlign="top">
          <TD class="style4">OKBox text</TD>
          <TD>Opens a message box with the given text and just an OK button.  The box is
            not suppressed by NoMessageBoxOnError.  Command added in 3.8, 10/17/19.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EnterOneNumber text</TD>
          <TD>Opens a dialog box for the user to enter one floating point number, with the
            given text as the prompt.&nbsp; Sets ReportedValue1 to the entered value.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EnterDefaultedNumber #V #D text</TD>
          <TD>Opens a dialog box for the user to enter one floating point or
            integer value.&nbsp; Follow with the default value to show in the box, the
            number of decimal places to show for a float entry or -1 for an integer entry,
            and the prompt text on the rest of the line.&nbsp; Sets ReportedValue1 to the
            entered value.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">EnterString variable text</TD>
          <TD>Opens a dialog box for the user to enter a string of text, with the
            given text as the prompt, and assigns it to the given variable name (without a 
            $).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">CompareStrings variable text</TD>
          <TD>Compares the strings in the given variable (without a $) and in the text on 
            the rest of the line.&nbsp; Sets reportedValue1 to 0 if the strings are equal, a 
            negative number if the variable is alphabetically before the text, and a 
            positive number if it is after.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">CompareNoCase variable text</TD>
          <TD>Like CompareStrings except that upper/lower&nbsp; case differences are ignored 
            in the comparison.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ParseQuotedStrings [#]</TD>
          <TD>Allows strings that may have spaces to be enclosed in single quotes (e.g., 
            'text string') and treated as a single entity in cases where it would be broken 
            up at the spaces.&nbsp; Follow with a 0 to turn off such parsing.&nbsp; The best 
            use of this feature would be for making an array of strings in a single 
            statement that encloses the entries with braces.&nbsp; It also allows a string 
            to be assigned to a variable without using '=@'.&nbsp; Command added in 3.8, 
            12/27/19. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">StripEndingDigits var1 var2</TD>
          <TD>Removes any digits from the end of the variable var1 and assigns it to the 
            variable var2 (both named without a $).&nbsp; The digits are converted to a 
            number and assigned to reportedValue1.</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style4">FlashDisplay [#T] [#D] [#C]</TD>
          <TD>Flashes between a uniformly colored screen and normal image display
            several times.&nbsp; The first optional entry, #T, sets the number of times to
            flash (default 4) and the second optional entry, #D, sets the duration of each
            state in seconds (default 0.3).&nbsp; Total duration may not exceed 6 seconds.
            The third optional entry, #C, sets the color of the flashing screen in
            hexadecimal (RRGGBB) notation, e.g. FF5500 is orange.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Verbose #</TD>
          <TD>Turns echoing of each script line on or off for # 1 or 0</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">SuppressReports</TD>
          <TD>Do not print any of these reports, just assign the values to report variables</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ErrorsToLog [#]</TD>
          <TD>Makes most script error messages be duplicated in the log
            window.&nbsp; Follow with a 0 to turn off the feature again.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">NoMessageBoxOnError [#]</TD>
          <TD>Outputs an error message to the log instead of opening a message box.&nbsp; 
            The script stops, but if it is being run from Navigator Acquire at Items, the 
            Navigator is able to go to the next item.&nbsp; Follow with 0 to turn the 
            feature off again.</TD>
        </TR>
        <TR vAlign="top">
            <TD class="style4">ListVars</TD>
            <TD>Lists all variables and their values in the log window, including reported 
            values, persistent variables, and loop indicies.&nbsp; Command added in 3.8.
            </TD>
        </TR>
        <TR vAlign="top">
            <TD class="style4">ListPersistentVars</TD>
            <TD>Lists all variables defined as persistent and their values in the log
            window.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ClearPersistentVars</TD>
          <TD>Removes all persistent variables defined with :=</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">MakeVarPersistent [#]</TD>
          <TD>Changes a regular variable to persistent, or if a 0 is entered for #, makes a 
              persistent variable non-persistent.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">IsVariableDefined Var</TD>
          <TD>Reports whether a variable is defined, placing a 1 in
            reportedValue1 if it is and a 0 if it is not.&nbsp; Follow with the variable
            name without a $.&nbsp; Value can be assigned to a variable at end of commmand.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">LocalVar var [var] ...</TD>
          <TD>Create the listed variables as variables local to the current script or 
            function.&nbsp; They will not be accessible outside this script or function and 
            will become undefined when returning from the script or function.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">LocalLoopIndexes</TD>
          <TD>Make loop indexes local; this means that a called function or script cannot 
            access the index value in the caller and is free to reuse the variable name 
              as a loop index or other variable.&nbsp; If this feature is used, this 
              command should 
            be near the start of any script that may be started independently.&nbsp; Once 
            the feature is invoked, it cannot be turned off.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">NewArray var #PL #E</TD>
          <TD>Creates a new variable with the given name, making it persistent or local if
               #PL is 1 or -1, respectively, and initialize it with an array of #E zeros.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">New2DArray var [#PL] [#R #E]</TD>
          <TD>Creates a 2D array variable with the given name, making it persistent or 
              local if #PL is 1 or -1, respectively.&nbsp; If the optional #R and #C are
               given, the array is initialized with #R rows of #E zeros each, where both
               must be positive.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">AppendToArray var item</TD>
          <TD>Appends one item or an array or items either to a 1D variable, which may
               already be an array or not, or to a row of a 2D array, specified with var
              [row], or as a new row of a 2D array, specified without a subscript.&nbsp;
               As with setting a variable, if there are multiple items on the line not 
              specified as an array, only the first item will be added, whereas if there 
              the multiple items are enclosed in { }, all items will be added to the 
              array.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">TruncateArray var #</TD>
          <TD>Truncates the given array variable to # elements; # must be positive. For a
               1D array,&nbsp; the values is truncated to # elements; for a row of a 2D
               array,&nbsp; specified by var[row], the row of values is truncated; for a 
              2D array given without a subscript, the number of rows is truncated to #.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">ArrayStatistics var</TD>
          <TD>For the set of values in the given array variable, computes and reports the
              total number of values, the minimum, the maximum, the mean, the standard deviation
              and the median.  For a 2D array, the statistics can be of the whole array, or of
              one row if the variable is given with a row subscript. Values can be assigned
               to variables at end of commmand.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">LinearFitToVars var1 var2 [var3]</TD>
          <TD>Computes a linear least-squares fit between values in 2 or 3 array variables.&nbsp; With
            two variables, fits to the equation&nbsp; v2 = slope * v1 + intercept and reports the 
            number of values, slope, intercept, and correlation coefficient 'ro'.&nbsp; With 
            three variables, fits to the equation v3 = a1 * v1 + a2 * v2 + c and reports the 
            number of values, a1, a2, and c.&nbsp; All variables must have the same number 
            of values.&nbsp; Command added in 3.8, 11/17/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">StringArrayToScript var [#e]</TD>
          <TD>Loads the array of strings in 'var' into an 'extra' or regular script.&nbsp; Use 
              this command to make functions in an extra script available, such as to another 
              extra script.&nbsp; Extra scripts are added sequentially to positions numbered 1 
              to 5.&nbsp; A positive value '#e' can be entered to place a script into a 
              previously used position or the next unused position.&nbsp; A negative value (-1 
              to -20) can be used to replace the script in one of the regular script positions 
              that are editable and saved to settings.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">GetFileInWatchedDir pattern</TD>
          <TD>Looks for a file matching the given pattern, where pattern can be a directory 
            followed by a filename including &#39;*&#39; to match multiple names.&nbsp; If
             just a directory is entered, the program appends a &#39;*&#39;.&nbsp; If a file
             is found, it returns 1 in reportedValue1 and the filename in reportedValue2;
            otherwise it returns 0 in reportedValue1.  A file is ignored if a file with the same 
            name plus &#39;.lock&#39; is found as well.  Thus, if there is a risk that a file
            might not all be present when SerialEM first sees it, the program creating the file
            should create the &#39;.lock&#39; file (which can be empty), then create and finish
             writing to the file to be found, then remove the &#39;.lock&#39; file.&nbsp;
             The file will need to be removed to avoid finding it again on the next call.
            &nbsp; Command added in 3.8, 12/26/19.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">RunScriptInWatchedDir pattern</TD>
          <TD>Looks for a file matching the given pattern, like &#39;GetFileInWatchedDir&#39;,
            and reads the file, places its contents in an extra script position, removes the file,
            and runs that script. &nbsp;As for &#39;GetFileInWatchedDir&#39;, a &#39;.lock&#39; 
            file can be used to avoid the risk that the file is not complete when SerialEM 
            sees it.&nbsp; Command added in 3.8, 12/26/19</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Require feature [feature] ...<br />
&nbsp;&nbsp;&nbsp; or<br />
            Require script_version_number</TD>
          <TD>This command tests whether scripting features used in the script are available in this 
            version of SerialEM.&nbsp; Earlier versions will not generate an error when some 
            newer features are used, so including this command is the only way to test 
            whether the script will run correctly.&nbsp; Initially these features were 
            specified by name, but this was silly and the command now takes a scripting 
            version number, which is unrelated to the program version number.&nbsp; You can 
            enter either the latest feature name or the version number that your script 
            needs. The available features, in order of addition, were: 1) &#39;variable1&#39;,
               which includes two capabilities: assigning reported values 
            directly to variables listed after a command, and assigning function arguments 
            directly to variables listed on the &#39;Function&#39; line.&nbsp; 2) &#39;arrays&#39;, 
            which is the ability to define a variable with an indexable array of values.&nbsp; 
            3) &#39;keepcase&#39;, which means that case will be preserved when assigning text to a 
            variable.&nbsp; 4) 'zeroloop', which means that a non-positive loop count is 
            allowed.&nbsp; 5) &#39;evalargs&#39;, which means that arithmetic expressions will be 
            evaluated in arguments to some commands.&nbsp; 6) Scripting version 201, which 
            means commands can be continued onto multiple lines with backslash.&nbsp; 
              7) Scripting version 202, which means that limited arithmetic can be done in 
              array subscripts (without spaces) and that arithmetic clauses can start with a minus sign.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">IsVersionAtLeast #v [#d]</TD>
          <TD>Tests whether the program version is at least the version specified with #v, 
            and also if its build date is at least that specified by the optional #d.&nbsp; 
            The version should be 5 digits: the initial version number (currently 3) times 
            10000, plus the major release version times 100, plus the minor version (.e.g, 
            3.6.3 is 30603).&nbsp; The build date should have the format yyyymmdd, e.g., 
            &quot;Sep 12 2017&quot; is specified as 20170912.&nbsp; Sets reportedValue1 to 1 if the 
            version is high enough, 0 if not.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">SkipIfVersionLessThan #v [#d]</TD>
          <TD>Skips the command on the next line if the program version is earlier than the 
            version specified with #v, or if the build date is earlier than the optional 
            entry #d.&nbsp; The format of these entries is as just described.&nbsp; The next 
            line will be skipped unconditionally when checking the script before execution.&nbsp; 
            Thus, loop and conditional control statements cannot be on that line.&nbsp; This 
            command is intended to provide a way to place a newer command into a script and 
            allow it to be runnable on older versions.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">Test expression</TD>
          <TD>Evaluates a conditional expression (just as would be used for an IF statement) 
            or a single number or variable value and stores whether the test passed (i.e., 
            if the expression is true or if the number is non-zero) internally, as well as 
            storing a 1 for success or 0 for failure in ReportedValue1 and a veariable 
            TestResult</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">PauseIfFailed [text]</TD>
          <TD>If the last &#39;Test&#39; command failed, this command opens a message box with the 
            optional text plus the question of whether to proceed with the script, even if 
            &#39;NoMessageBoxOnError&#39; is set.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style4">AbortIfFailed [text]</TD>
          <TD>If the last &#39;Test&#39; command failed, this command opens a message box with the 
            optional text (unless &#39;NoMessageBoxOnError&#39; is set) and aborts the script.</TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="camera_commands"></A><B>Camera Commands</B></P>
      <TABLE border="1" cols="2">
        <TR vAlign="top">
          <TD colspan="2"><A name="acquisition_param"></A><B>Acquisition and
          Parameter Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">V or View</TD>
          <TD>Acquire image with 'view' parameters</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">F or Focus</TD>
          <TD>Acquire image with 'focus' parameters</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">T or Trial</TD>
          <TD>Acquire image with 'trial' parameters</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">R or Record</TD>
          <TD>Acquire image with 'record' parameters</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">L or Preview</TD>
          <TD>Acquire image with 'preview' parameters</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">M or Montage</TD>
          <TD>Acquire montage</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">Search</TD>
          <TD>In Low Dose mode, go to Search area conditions and acquire image with &#39;View&#39; 
            camera parameters.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">PreCookMontage #D [#P] [#C]&nbsp; [#S]</TD>
          <TD>If montaging is enabled with stage movement, this command lowers the screen to
            expose the specimen, then moves the stage to each piece position and waits there
            for the number of seconds indicated by #D, if the number is positive.&nbsp; If 
              #D is negative or #P is entered, it skips pieces within each column, with an interval given by the 
              #P or the negative 
            of #D: 2 will stop at every second piece, 3 at every third, etc.&nbsp; 
            For convenience, 1 is equivalent to a large interval and will make 
            it stop only at the bottom and top of each column.&nbsp; Set #C non-zero to skip 
              columns partially or 0 not to: in every other column, the stage will be moved 
              only to the first and last piece and to any piece that does not have an adjacent 
              piece in the columns on both sides.&nbsp; This entry will make no difference if 
              you use 1 or a very large number for the skip interval.&nbsp; Set #S with a stage movement speed factor or 
              0 for normal speed.&nbsp; If setting a speed factor crashes SerialEM or 
              FEI-SEMserver, see notes under <a href="#tiltDuringRecord">TiltDuringRecord</a>.</TD>
        </TR>
         <TR vAlign="top">
          <TD class="style8"><b>Set Parameter Commands</b>&nbsp;</TD>
          <TD>The following &#39;Set...&#39; commands change values in one of the camera parameter
            sets.&nbsp; The set &#39;S&#39; can be specified as either V, F, T, R, P or 0, 1, 2, 3,
            4 for view, focus, trial,
            record, preview, respectively.&nbsp; Parameters will be restored whenever the
            script ends or stops or when a different camera is selected.&nbsp; However, if
            the script is suspended, any changed parameters will be set again when the script
            resumes.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetExposure S #E [#D]</TD>
          <TD>Set exposure and, optionally, drift settling for exposure set S&nbsp; to the given values E and D.&nbsp;&nbsp; If D is omitted, the existing
            drift settling will be unchanged.&nbsp;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetBinning S #B</TD>
          <TD>Set binning for exposure set S to B.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetCameraArea S L R T B</TD>
          <TD>Set the acquisition area for exposure set S.&nbsp; Follow the set specifier S with
            either 4 numbers for the unbinned left, right, top, and bottom coordinates (the
            same kind of numbers as in the camera setup dialog) or with F, H, Q, WH or WQ
            for full, half, quarter, wide half, or wide quarter.&nbsp; Values will be adjusted
            for a legal area.&nbsp; </TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetCenteredSize S #B # #</TD>
          <TD>Set exposure set S for acquisition from a centered area.&nbsp; Follow the set
            specifier S with 3 numbers: the binning B, the binned size in X, and the binned
            size in Y.&nbsp; </TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetContinuous S #</TD>
          <TD>Set the acquisition mode for exposure set S for continuous if # is non-zero,
            or single-frame if # is 0.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetSTEMDetectors S #D...</TD>
          <TD>Set the STEM detectors for each available channel of exposure set S.&nbsp;
            Follow the set specifier S with a detector number for each channel, numbered
            from 0, or -1 to select no detector for that channel.&nbsp; At least one actual
            detector must be specified.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp; &nbsp;SetProcessing S #P</TD>
          <TD>Set processing for exposure set S to the given value, which should be 0 for 
            unporcessed, 1 for dark-subtracted, or 2 for gain-normalized.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetK2ReadMode S #M&nbsp;</TD>
          <TD>Set the processing mode for exposure set S to the given value.&nbsp; For a K2 
          or DE camera, this should be 
            0 for linear, 1 for counting, or 2 for super-resolution mode.&nbsp; For a Falcon 
            or K3 camera, it would be 0 for linear or 1 for counting mode.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetFrameTime &nbsp;S #F</TD>
          <TD>Set the frame time for a K2/K3 camera to the given number.</TD>
        </TR>
        <TR>
          <TD class="style8">&nbsp;&nbsp;&nbsp; SetDoseFracParams S #D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [#S] [#A] [#M] [#C]&nbsp;</TD>
          <TD>Set dose fractionation parametes for exposure set S; follow with up to 5 
            numbers: D non-zero for dose-fractionation mode on K2/K3; S non-zero to save frames 
            (not just for K2/K3); A non-zero to align frames; M 0 to align in DM, 1 to align in 
            plugin, or 2 to save a command file for alignframes; C non-zero to combine 
            frames into sums.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">RestoreCameraSet [S]</TD>
          <TD>Restore one or all camera parameter set(s) modified with the &#39;Set&#39; commands
            above.&nbsp; If S is omitted, all modified sets will be restored.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">KeepCameraSetChanges [S]</TD>
          <TD>Retain changes in one or all modified camera parameter sets when script ends.&nbsp; 
              Use this after making all the changes with the &#39;Set&#39; commands that you wish to 
              retain.&nbsp; If S is omitted, all modified sets will be retained.&nbsp; &#39;RestoreCameraSet&#39; 
              cannot be used on a set that has been retained.&nbsp; Subsequent changes by the 
              &#39;Set&#39; commands will be restored on script end or by &#39;RestoreCameraSet&#39;,&nbsp; 
              unless this command is given again.&nbsp; Command added in 3.8. </TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="continuous_mode"></A><B>Continuous Mode Control</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">StopContinuous</TD>
          <TD>Stops continuous acquisition if it is running.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportContinuous</TD>
          <TD>Returns -1 if continuous acquisition is not running, or the camera parameter
            set number being used if it is running, numbered from 0.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">UseContinuousFrames #</TD>
          <TD>If # is non-zero, the script will keep executing commands (such as stage
            movement and alignment) even when the camera is acquiring in continuous mode.&nbsp;
            Use 0 to return to normal operation, in which the script will wait for continuous
            acquisition to be ended by the user.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">WaitForNextFrame [#S] [#A]</TD>
          <TD>After starting a continuous acquisition, use this command to wait until the
            next image becomes available in buffer A.&nbsp; The program will wait until the exposure
            time has elapsed so that the image is likely to be taken after completion of
            previous operations, unless the command &#39;StartFrameWaitTime -1&#39; is used first.&nbsp; For the next script command, the image will be available 
            in buffers A and B, but for commands after that, buffer B should be accessed instead 
            because the copy in A may be overwritten with a new continuous frame by then.   
            &nbsp; The &#39;UseContinuousFrames 1&#39; command must be used before the
            acquisition is started.&nbsp; If the optional #S is given, that number of frames 
            will be aligned with the Framealign module and summed, or averaged if the optional #A is non-zero.&nbsp; Use
            averaging if the sum may exceed 32767 (for signed images) or 65535.&nbsp; Essential frame
            alignment parameters are controlled by <A href ="about_properties.htm#continuousAlign">
              several properties</A>; the default is for alignment 
            to a cumulative sum, which is somewhat faster than pairwise alignments and should be adequate
            for high-contrast frames.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">StartFrameWaitTimer [-1]</TD>
          <TD>With no optional value, sets the time from which the next &#39;WaitForNextFrame&#39; will require an exposure 
            time to elapse.&nbsp; Without this command, the program will wait the full 
            exposure time after the &#39;WaitNextFrameCommand&#39;. If this command is given 
            with no value just 
            after getting a frame, and operations are done before waiting for the next 
            frame, the next frame may be obtained sooner.&nbsp; However, if the command is 
            followed by a negative value, then the program will not wait for the exposure 
            time to elapse but just return the next distinct frame.&nbsp; Use this command 
            with a -1 before WaitForNextFrame to get every successive frame if possible, 
            such as after starting a continuous tilt.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetLiveSettleFraction #</TD>
          <TD>Set the fraction of the usual settling time to apply in continuous mode after
            image shift or stage movement.&nbsp; By default, no settling is applied in
            continuous mode (i.e., the fraction is 0), but some settling may be needed when
            a script or other operation is using continuous frames.&nbsp; The fraction is
            reset to zero when continuous mode ends.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="other_camera"></A><B>Other Camera Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">CameraProperties [#C] [#M]</TD>
          <TD>Reports unbinned size in X and Y, RotationAndFlip property, size of 
            detector pixel in microns, and unbinned pixel size of the current camera, or 
            of the active camera whose number is given by the optional #C, numbered from 1. 
             The unbinned pixel size is for the current magnification, or for the magnification
             index given by the optional #M.  (unbinned pixel size added in 3.8, 11/29/19)</TD>
        </TR>
        <TR>
          <TD class="style8">SelectCamera #</TD>
          <TD>Make the given camera be the active camera, where the number is the position 
            of the camera in the ActiveCameraList property or Camera setup dialog, numbered 
            from 1.&nbsp; Will switch
            in and out of EFTEM mode or STEM mode if appropriate.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">RetractCamera</TD>
          <TD>Retracts all retractable cameras</TD>
        </TR>
        <TR>
          <TD class="style8">OppositeFocus</TD>
          <TD>In low dose mode, acquire Focus image from area on opposite side of Record from
            the defined&nbsp;Focus area.&nbsp; Opposite areas are not available if Balance
            Shifts is turned on.</TD>
        </TR>
        <TR>
          <TD class="style8">OppositeTrial</TD>
          <TD>In low dose mode, acquire&nbsp;Trial image from area on opposite side of Record
            from the&nbsp;defined&nbsp;Trial area.</TD>
        </TR>
        <TR>
          <TD class="style8">AcquireToMatchBuffer buf</TD>
          <TD>Acquire an image whose size matches that of the image in the given buffer, with
             camera parameters matching those used to acquire that image.&nbsp; The image will
             be cropped after acquisition if necessary.&nbsp; The camera parameters will be based
             on the parameter set used for buffer's image, with the exposure time and binning taken
            from values stored in the buffer.&nbsp; In Low Dose mode, the image will be acquire from the
            corresponding Low Dose area.
          </TD>
        </TR>
        <TR>
          <TD class="style8">StepFocusNextShot # # [# #]</TD>
          <TD>Do one or two focus changes during the next exposure.&nbsp; Follow with 2 or 4
            numbers: the time in seconds from start of the exposure to the first focus
            change, the first focus change in microns, the time from start of the exposure
            to the second focus change if any, and the second focus change relative to the
            starting focus, not relative to the focus after the first change.&nbsp; The
            command will have no effect if the exposure time is less than the time to the&nbsp;
            first change, and the second change will not be done if the time for it is
            greater than the exposure time.</TD>
        </TR>
        <TR>
          <TD class="style8">SmoothFocusNextShot # #</TD>
          <TD>Change focus linearly through next exposure.&nbsp; Follow with 2 numbers, the
            starting and ending defocus relative to the current focus.&nbsp; This command
            and StepFocusNextShot are enabled for Gatan, Falcon, and Tietz cameras.</TD>
        </TR>
        <TR>
          <TD class="style8">EarlyReturnNextShot # [#]</TD>
          <TD>Return as early as possible from the next acquisition, which must involve
            either aligning or saving dose-fractionation frames from a K2/K3 camera.&nbsp; Follow with the number
            of frames to be summed in the returned image, 0 to return without any summed
            image, or -1 to return with the full sum (the latter is available only on GMS
            2.31 or higher).&nbsp; The second optional number should be 1 to make a deferred 
            full sum when not aligning in the plugin; this sum is always made when aligning in the plugin.&nbsp;
            Single-shot and dose-fractionation images can be
            requested without delay in the script.&nbsp; The single-shot images will be taken
            as soon as possible (after the end of the exposure before GMS 2.31, after the
            frame stack has been accessed in GMS 2.31 and higher).&nbsp; Another
            dose-fractionation shot will be delayed until saving is finished for the current
            shot.</TD>
        </TR>
        <TR>
          <TD class="style8">GetDeferredSum</TD>
          <TD>Acquire the deferred full sum that was saved as a result of 
            &#39;EarlyReturnNextShot&#39;.</TD>
        </TR>
        <TR>
          <TD class="style8">FrameThresholdNextShot #T [#S] [#E]</TD>
          <TD>Skip saving frames whose mean value is below the given threshold #T in the next 
            shot&nbsp; from a K2/K3 camera.&nbsp; The mean value used for comparison with
            the threshold will be the value that the frame would have after saving, thus 
            a scaled electron count value when taking normalized frames or actual electron
            counts otherwise.&nbsp; The first and last frame will be saved 
            regardless.&nbsp; The plugin will write a list of frames actually saved, 
            numbered from 0, named as the root of the frame stack name and &#39;_saved.txt&#39;.
            &nbsp; The SEMCCD plugin must be dated 
            12/18/19 or later.&nbsp; If a command file is being saved for aligning in IMOD,
             and this command includes the optional #S and #E, these values will be used for the entry
            to the PartialFrameThreshold option to Alignframes, which takes thresholds for skipping
            the frames at the start and end of a tilt.&nbsp These relative thresholds are 
            between 0 and 1.&nbsp If #E is omitted, #s will be used for both values.
          </TD>
        </TR>
        <TR>
          <TD class="style8">QueueFrameTiltSeries #S #I #N [#D] [#O] [#W] [#F] [#X #Y]</TD>
          <TD>Sets up a tilt series with discrete tilts and other uniform changes to occur 
            during the next shot, provided frames are saved.&nbsp; Follow with starting 
            angle (#S), increment (#I) and number of tilt steps (#N), plus optional entries 
            #D for the initial delay before starting the starts, #O for the time the beam 
            should be unblanked, #W for time to wait between tilting and unblanking, #F for 
            a change in focus per step, #X and #Y for a change in image shift values for 
            each step.&nbsp; Image shift values are in microns in &#39;specimen&#39; coordinates, 
            i.e. with the X axis along the tilt axis, and they will be converted to image 
            shift units at the Record magnification if in Low Dose mode, or at the current 
            magnification if not.&nbsp; All times are in seconds.&nbsp; A frame stack mdoc file
            with tilt angle and dose information is written by the SEMCCD plugin regardless of
             whether the option for one is turned on.
          </TD>
        </TR>
        <TR>
          <TD class="style8">FrameSeriesFromVar var #F [#D]</TD>
          <TD>Sets up a tilt series with all steps specified in the given array variable, 
            which should contain 1 to 6 values per step of the series, with the values for 
            one step followed by those for the next step, etc.&nbsp; #F is the sum of 1 if 
            there are tilt angles, 2 if there are shutter open times, 4 if there are&nbsp; 
            wait times or intervals between steps, 8 if there are changes in defocus from 
            the current value, and 16 if there are image shift changes from the current 
            value.&nbsp; In the latter case there would be values for X and Y in microns in&nbsp; 
            &#39;specimen&#39; coordinates, i.e. with the X axis along the tilt axis.&nbsp; The 
            shifts will be converted to image shift units at the Record magnification if in 
            Low Dose mode, or at the current magnification if not.&nbsp; The values must be 
            present in the order just listed.&nbsp; If there are tilt angles, then the third 
            item (wait times or intervals) is a delay between the end of the tilt and the 
            opening of the shutter, if any.&nbsp; If there are no tilt angles because 
            continuous tilt is being used, then this item sets the total interval between 
            steps of the series.&nbsp; #D is an optional initial delay before the first 
            step.&nbsp; All times are in seconds.&nbsp; If there are discrete tilts, a frame
             stack mdoc file with tilt angle and dose information is written.</TD>
        </TR>
        <TR>
          <TD class="style8">SetFrameSeriesParams #B [#S] [#X #Y]</TD>
          <TD>Sets optional parameters for frame tilt series.&nbsp; Set #B non-zero to use 
              backlash for all tilt steps not in the same direction as the first one, 0 
              otherwise; #S with a tilting speed factor or 0 for normal speed, and #X and #Y 
              for X and Y stage coordinates to restore after the tilt or values greater than 9000 for no 
              stage restoration.&nbsp; For CryoARM, speed factors of 100 - 105 will select pre-set speeds
              of 10, 2, 1, 0.5, 0.25, and 0.1 degrees/sec.&nbsp; If setting a speed factor crashes SerialEM or
              FEI-SEMserver, see notes under <a href="#tiltDuringRecord">TiltDuringRecord</a>.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR>
          <TD class="style8">WriteFrameSeriesAngles file</TD>
          <TD>Write the actual tilt angles from the last frame tilt series to the given 
            file, one per line.</TD>
        </TR>
        <TR>
          <TD class="style8">RecordAndTiltUp [#R] [#X #Y]</TD>
          <TD>Starts a Record acquisition and tilts the stage up by the current increment 
            after the exposure is expected to be done.&nbsp; Post-exposure actions must be 
            allowed for the current camera, at least for current Record parameters, but need 
            not be not enabled by the user in the Camera menu.&nbsp; If optional #R is 
              non-zero, then the program will restore the stage X and Y positions after 
              tilting, either to the position before starting or to #X, #Y if they are 
              entered.</TD>
        </TR>
        <TR>
          <TD class="style8">RecordAndTiltDown [#R] [#X #Y]</TD>
          <TD>Like 'RecordAndTiltUp', but tilts the stage down by the current increment.</TD>
        </TR>
        <TR>
          <TD class="style8">RecordAndTiltTo #T [#B] [#R] [#X #Y]</TD>
          <TD>Like 'RecordAndTiltUp', but tilts the stage to the given angle #T.&nbsp; If an 
            optional non-zero backlash is entered in #B, the stage will tilt first to #T +/- #B, then 
            back to #T. Prior to 5/23/19, #T + #B was used and the sign of #B had to be set
            to correct the backlash for the desired direction; after then, the program sets
            the sign properly and a positive value can always be entered. </TD>
        </TR>
        <TR>
          <TD class="style8">ArePostActionsEnabled</TD>
          <TD>Reports whether post-exposure actions are allowed for the current camera for 
            all shots, and for Record shots specifically, and 
            sets reportedValue1 and reportedValue2 to 1 if so, 0 if not.&nbsp; For Falcon 
            and DE cameras, post-actions are allowed only when frames are being aligned in 
            SerialEM.&nbsp; The values can be assigned to a 
            variable after the command.</TD>
        </TR>
        <TR>
          <TD class="style8"><a name="tiltDuringRecord">TiltDuringRecord #A #D [#S]</a></TD>
          <TD>Starts a Record acquisition and starts the stage tilting to angle #A after the 
            delay #D in milliseconds.&nbsp; On FEI scopes with recent enough versions of FEI 
            scripting, or JEOL scopes with recent versions of TemExt.dll, #S can be added with a speed multiplier (&lt; 1 for slower, &gt; 1 for 
            faster).&nbsp; For CryoARM, speed factors of 100 - 105 will select pre-set speeds
              of 10, 2, 1, 0.5, 0.25, and 0.1 degrees/sec.&nbsp; On FEI scopes this command will freeze the user 
            interface and prevent scope updates while the stage is tilting.  If the command 
              crashes SerialEM or FEI-SEMserver with 
              a speed multiplier but runs OK without one, it means 
              that the FEI scripting version is too old to support the speed command.  In that case,
              define an environment variable SEM_USE_TOMMONIKER with the value of 1 on the 
              microscope computer to use an alternate interface (as of SerialEM 3.8.0, 7/8/19, 
              FEI-SEMserver version 109).
          </TD>
        </TR>
        <TR>
          <TD class="style8">DeferStackingNextShot</TD>
          <TD>Do not stack Falcon intermediate frames after the next exposure.&nbsp; To
            stack frames from multiple exposures into one stack, use this command before
            each exposure except the last one.</TD>
        </TR>
        <TR>
          <TD class="style8">OpenDECameraCover</TD>
          <TD>Opens the protection cover of the Direct Electron camera for the remainder of
            the script, if it is the current camera.&nbsp; Without this command, the cover
            will be opened and closed for each exposure except during tasks.</TD>
        </TR>
        <TR>
          <TD class="style8">SetDECamFrameRate #</TD>
          <TD>Sets the frame rate of the current camera if it is a DE camera; follow with 
            the new rate in frames per second, which must be positive and less than the 
            maximum frame rate.&nbsp; The user&#39;s original frame rate is placed into 
            ReportedValue1 and is restored when the script ends.</TD>
        </TR>
        <TR>
          <TD class="style8">NewDEserverDarkRef #P #H</TD>
          <TD>Acquires a dark reference in the DE server if the known interval since the 
            last reference for processing mode #P is longer than #H in hours. #P must be 0 
            for linear mode or 1 for counting mode.&nbsp; Parameters for the reference are 
            those specified in the <a href="hidd_de_reference.htm">Direct Electron Server 
            Reference Maker Dialog</a> for the given mode.&nbsp; If #H is 0, the reference 
            is done unconditionally; if #H is negative (-1), the command simply records the 
            current time as the time of the last reference.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">UpdateHWDarkRef #</TD>
          <TD>Updates the K2 hardware dark reference if the known interval since the last
            update is longer than # in hours.&nbsp; If # is 0, the update is done
            unconditionally; if # is negative (-1), it simply records the current time as
            the time of the last update.&nbsp; In order for the time interval to be kept 
            track of between runs of the program, the property IgnoreShortTermCals must not 
            be set.  This command is available on a K3 with GMS 3.31 or higher.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">AlignWholeTSOnly [#]</TD>
          <TD>Allows a whole tilt series taken from a K2/K3, Falcon, or DE camera through the script to be 
            aligned with one command file in IMOD, just as when using the tilt series 
            controller.&nbsp; Specifically, no command files will be written for individual 
            Record images taken after the command is given, and a single command file to 
            align all frame stacks in the series is written at the end with the 
            &#39;WriteComForTSAlign&#39; command.&nbsp; The command has no effect unless frame 
            alignment in IMOD is selected in the Record parameter set and &#39;Align only whole 
            tilt series&#39; is selected in the Frame Alignment Parameters dialog.&nbsp; If 
            these conditions are satisfied, there must already be a current image file with 
            an associated .mdoc file.&nbsp; The optional # can be 0 to turn this mode of 
            operation off.&nbsp; Sets reportedValue1 to 1 or 0 depending on whether this 
            operating mode was switched to or not.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportK2FileParams</TD>
          <TD>Reports values selected in the Frame File Options dialog: 0 for MRC, 1 for 
            TIFF LZW, or 2 for TIFF ZIP; sum of 1 to pack unnormalized data at all, plus 2 
            to pack counting mode to bytes; 1 to save MRC files in 4-bit mode 101; 1 to save 
            normalized data times 100; 1 to skip rotation and flip of frames; 1 for one file 
            per frame. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetK2FileParams #T [#P]<br />
&nbsp;&nbsp;&nbsp; [#M] [#N] [#R] [#O]</TD>
          <TD>Set values to control K2/K3 frame file saving.&nbsp; Follow with up to 6 values: 
            T 0 for MRC, 1 for TIFF LZW, or 2 for TIFF ZIP; P as the sum of 1 to pack 
            unnormalized data at all, plus 2 to pack counting mode to bytes; M non-zero to 
            save MRC files in 4-bit mode 101; N non-zero to save normalized data times 100; 
            R non-zero to skip rotation and flip of frames; O non-zero for one file per 
            frame.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportK3CDSmode</TD>
          <TD>Reports 1 if CDS mode is on for a K3 camera acquisitions, 0 if not.&nbsp; Command added in 3.8, 11/17/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetK3CDSmode #O [#P]</TD>
          <TD>Sets the CDS mode option for K3 camera acquisitions on if #O is non-zero, off 
            otherwise.&nbsp; The existing value is restored at the end of the script unless 
            #P as entered with a non-zero value to make it permanent.&nbsp; Command added in 3.8, 11/17/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportCountScaling</TD>
          <TD>Reports two values of current camera: either the scaling being applied to 
            counting/super-resolution mode images returned from a K2 camera, or the 
            'CountsPerElectron' property; and whether division by 2 is on.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetDivideBy2 #</TD>
          <TD>Turns division by 2 for the current camera on or off if # is 1 or 0, 
            respectively.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportNumFramesSaved</TD>
          <TD>Reports the number of frames saved, or being saved, in the last acquisition 
            that saved frames.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportFrameAliParams</TD>
          <TD>Reports six values for the frame alignment parameter set selected to be used 
            for Record images: the binning or target size for alignment, whether to keep precision for 
            gain-normalized images when doing early returns or GPU frame alignment, the strategy (0 to 3, 
            corresponding to the radio buttons in the Frame Alignment dialog), the number of 
            frames to align all pairs among, the number of iterations to refine (negative if 
            refinement off), and the group size (negative if using groups is off).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetFrameAliParams #B [#K]<br />
&nbsp;&nbsp;&nbsp; [#S] [#A] [#R] [#G]</TD>
          <TD>In the frame alignment parameter set selected to be used for Record images, 
            sets the binning to B if B is 1-16 or the target size to B otherwise, and optionally sets whether to keep precision during 
            early returns or GPU frame alignment if K is 1, the strategy from S, the number of frames for all pairs 
            from A, the number of refinement iterations from |R| and to do refinement if R 
            is positive, and the group size from |G| and the whether to use groups if G is 
            positive.&nbsp; </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">ReportFrameAli2</TD>
          <TD>Reports more values for frame alignment: whether GPU use is selected, and for 
            the Record parameter set: truncation limit (negative if truncation is off), 
            whether to use hybrid shifts, and the three filter radii.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SetFrameAli2 #G [#T] [#H]<br />
&nbsp;&nbsp;&nbsp; [#R1] [#R2] [#R3]</TD>
          <TD>Sets whether to use GPU for frame alignment and, in the frame alignment 
            parameters for Record, optionally sets truncation limit from |T| and to truncate 
            if T is positive, whether to use hybrid shifts if H is 1, primary filter radius 
            from R1, and second and third filter radii from R2 and R3 or 0 for either if R1 
            is present and R2 or R3 is not.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style8">SkipFrameAliParamCheck [#]</TD>
          <TD>Disables the checking of whether the selected frame alignment parameter set 
            fits the constraints for use selected in the Frame Alignment dialog.&nbsp; This 
            can be used when modifying frame alignment parameters or Record parameters to 
            avoid an annoying message before every shot.&nbsp; The optional value of 0 can 
            be supplied to re-enable the checking. </TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="buffer_file_commands"></A><B>Buffer and File Commands</B></P>
    <P>In all commands including a buffer to operate on, the buffer can be specified 
      with either the buffer letter or the corresponding number, where A corresponds 
      to 1.</P>
      <TABLE border="1" cols="2">
        <TR vAlign="top">
          <TD colspan="2"><A name="buffer_image"></A><B>Buffer and Image Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">Copy buf1 buf2</TD>
          <TD>Copy from buf1 to buf2 (e.g., Copy C A)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">Show buf</TD>
          <TD>Display the given buffer (e.g., Show C)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CropImage buf x0 x1 y0 y1</TD>
          <TD>Crop out a subarea of the given buffer from x0 to x1 in X and from y0 to y1 in
            Y. Coordinates are numbered from 0 to size - 1 in each dimension and 0 in Y is
            at the top.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CropCenterToSize buf #X #Y</TD>
          <TD>Crop out a centered subarea of the given buffer of size #X by #Y.&nbsp; Command
            added in 3.8, 11/29/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReduceImage buf #</TD>
          <TD>Reduce the image in the given buffer by the factor #, which must be greater 
            than 1 but need not be an integer.&nbsp; Antialiased reduction (with a Lanczos 2 
            filter) is used instead of binning.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">FFT buf [#B]</TD>
          <TD>Takes the FFT of the image in the given buffer, optionally applying the 
            binning given in #B.&nbsp; The FFT will appear in buffer A, or in the 
            side-by-side FFT window if that option is on.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ImageProperties [buf]</TD>
          <TD>Report size in X and Y, binning, exposure, pixel size, and parameter set
            used&nbsp;for the image in buffer A or in the buffer indicated by 'buf'.
            &nbsp; Values can be assigned to variables after a buffer letter/number.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ImageLowDoseSet [buf]</TD>
          <TD>Report the parameter set that an image was taken with and whether it was taken
            in Low Dose mode, for the image in buffer A or in the buffer indicated by 'buf'.&nbsp;
            For one of the 5 standard parameter sets, it will report the set name.&nbsp; For
            a montage image, it will report Record.&nbsp; For a tracking image, it will
            report View if the mag matches that of View in Low Dose; if the mag matches
            Record in Low Dose, it will report Record or Preview depending on which has an
            closest exposure time closest to that of the image.
            &nbsp; Values can be assigned to variables after a buffer letter/number.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportMeanCounts [buf] [#]</TD>
          <TD>Report the mean counts of the A buffer, or of the buffer indicated by 'buf';
            add a 1 to get unbinned counts per second.
            &nbsp; No optional assignment to variable.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ElectronStats [buf]</TD>
          <TD>Report the min, max, mean, and SD of the A buffer, or of the buffer indicated
            by &#39;buf&#39;, scaled to electrons, and also report the electrons per unbinned pixel
            per second.&nbsp; The camera must have a defined counts per electron.  Values 
            recorded in electron counting mode will be linearized if possible 
            (corrected for decreasing counting efficiency at higher dose rates).
            &nbsp; Values can be assigned to variables after a buffer letter/number.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">RawElectronStats [buf]</TD>
          <TD>Report the same items as 'ElectronStats' without linearizing them for loss in
          counting mode.&nbsp; Values can be assigned to variables after a buffer letter/number.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SubareaMean x0 x1 y0 y1</TD>
          <TD>Report the mean counts in a subarea of the A buffer from x0 to x1 in X and from
            y0 to y1 in Y. Coordinates are numbered from 0 to size - 1 in each dimension
            and 0 in Y is at the top.&nbsp; Value can be assigned to variable at end of command.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">QuadrantMeans [n] [f1] [f2]</TD>
          <TD>Report means of strips along quadrant boundaries. Optional entries are 'n' for
            the number of pixels between strip and boundary (default 2), 'f1' for the strip
            width as a fraction of quadrant extent (default 0.1), and 'f2' for the fraction
            of quadrant extent to trim off the length of the strip (default 0.1). Output is
            labeled by quadrant number (1 to 4) and 'h' for horizontal strips or 'v' for
            vertical strips.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CheckForBadStripe [buf] [#H]</TD>
          <TD>Check for sharp transitions between columns or rows in an image and for 
            whether they occur at expected positions for a bad channel of data from a K2 or 
            K3 camera.&nbsp; Analyzes the image in buffer A, or the buffer indicated by 
            &#39;buf&#39;.&nbsp; It uses the RotationAndFlip property of the camera, if it can be 
            identified, to determine if vertical or horizontal stripes should be sought, 
            unless the option #H is entered with 1 for horizontal or 0 for vertical 
            stripes.&nbsp; Reports the number of significant transitions found and the number 
            of those that are within a few pixels of the expected boundaries between channels for a 
            K2 or K3 camera.&nbsp; The latter would be a more reliable number to use if 
            there is a risk of very straight grid bars in the field.  Command added in 3.8.0, 11/3/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CtfFind buf dmin dmax [fast] [box] [phmin] [phmax] [phstep] 
            [afix]</TD>
          <TD>Determines defocus and astigmatism by fitting to Thon rings in an FFT of the 
            image in the given buffer.&nbsp; Follow the buffer letter/number with the minimum and 
            maximum defocus for the search (in microns, underfocus negative), and with these 
            optional entries: 
            <br />&nbsp; &#39;fast&#39; non-zero to do a 1-D initial search instead of a slower 2D one<br />
&nbsp; &#39;box&#39; between 128 and 640 to set the box size for the amplitude spectrum to analyze, 
            or zero to use the default (256)<br />
&nbsp; &#39;phmin&#39; alone to set the additional phase shift, in degrees, or 0 (or 0 0) to use the 
            phase shift set in the <A HREF="#hid_process_setphaseplateshift">Set Phase Plate Shift</A> 
            menu item<br />
&nbsp; &#39;phmin&#39; and &#39;phmax&#39; to set the minimum and maximum phase shift for a search that 
            includes phase shift; the range must be less than 90 degrees.&nbsp; Such a 
            search may be slow.<br />
            &nbsp; &#39;phstep&#39; nonzero to set the phase shift search step, or 0 to use the default 
            (5.7 degrees)<br />
&nbsp; &#39;afix&#39; non-zero to fix astigmatism at zero.<br />
            See <a href="#hid_process_doctffindfitonclick">Do Ctffind On Click</a> and <a href="#hid_process_setctffindoptions">Set Ctffind Options</a> 
            for more details on these options.<br />
            After successful fitting, the command will set reportedValue1-6 with 
            mean defocus and astigmatism (difference between maximum and minimum defocus) in 
            microns (underfocus negative), astigmatism angle in degrees, additional phase shift 
            in degrees, fitting score, and 
            resolution in Angstroms to which Thon rings fit.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="directory"></A><B>Directory and Miscellaneous Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SetDirectory dir</TD>
          <TD>Change the working directory to 'dir', which can contain spaces.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportDirectory</TD>
          <TD>Reports the current working directory, which is where a file will be created 
            if it is opened from a script command without a full path.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">UserSetDirectory [prompt]</TD>
          <TD>Open a directory chooser dialog to allow user to select or make a directory,
            and change the working directory to it.&nbsp; If the optional prompt string is
            not supplied, the dialog title is &#39;Choose a new current working directory&#39;.&nbsp;
            The chosen directory is stored in ReportedValue1.</TD>
        </TR>
        <TR>
          <TD class="style7">MakeDirectory dir</TD>
          <TD>Create the directory 'dir' if it does not already exist.&nbsp; 'dir' can
            contain spaces.&nbsp; The parent directory must already exist.</TD>
        </TR>
        <TR>
          <TD class="style7">MakeDateTimeDir</TD>
          <TD>Create a directory named by the date and time (e.g., Aug15_12.23.15) under the
            current directory and change to this as the new working directory.</TD>
        </TR>
        <TR>
          <TD class="style7">AllowFileOverwrite #</TD>
          <TD>Allow 'OpenNewFile', 'OpenNewMontage', and 'OpenTextFile ID W...' to overwrite an existing file if # is
            1, or disallow it again if # is 0.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">RemoveFile file</TD>
          <TD>Removes the given file unconditionally, prints a warning if it cannot be 
            removed.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">WriteComForTSAlign</TD>
          <TD>Writes the command file for aliging a whole tilt series if this mode of 
            operation was selected with the AlignWholeTSOnly command; otherwise it has no 
            effect.  The tilt series file with associated .mdoc must still be the current 
            open file.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SaveLogOpenNew [newFile]</TD>
          <TD>Closes the log window and opens a new one.&nbsp; If a log file has been saved, 
            the log is automatically saved to it before closing.&nbsp; If there is no log 
            file and the log has new contents since program startup, the program will ask 
            the user whether to save to log first; if the user cancels, the script is 
            aborted.&nbsp; If a filename (newFile) is added, the new log will be saved with 
            that name.&nbsp; Variables will be substituted before using the name.  
            An extension in this name will be stripped off before adding 
            '.log', so if you want to preserve extensions or other text after a period, add 
            '.log' to the end of the name.&nbsp; If the file already exists, a number will 
            be added to get a unique new name.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CloseLogOpenNew [#]</TD>
          <TD>Closes the log window and opens a new one.&nbsp; If a log file has been saved, the 
              log is automatically saved to it before closing.&nbsp; If there is no log file and 
              the log has new contents since program startup, the program will ask the user 
              whether to save to log first unless a non-zero value is entered for the optional 
              #, in which case the contents of the log are discarded. If the user cancels the 
              query, the script is aborted.&nbsp; Command added in 3.8.&nbsp;&nbsp;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SaveLog [#O newFile]</TD>
          <TD>Saves the log to a file.&nbsp; If no optional entries are made, it will be saved 
              to the current file if there is one; otherwise the user will be asked for a 
              filename in which to save.&nbsp; If a filename is entered on this command, the 
              log will be saved to a new file with that name.&nbsp; Variables will be substituted 
              before using the name. An extension in this name will be stripped off before 
              adding &#39;.log&#39;, so if you want to preserve extensions or other text after a 
              period, add &#39;.log&#39; to the end of the name.&nbsp; Enter a non-zero value for #O to 
              overwrite the file if it already exists, or zero to have a number added to get a 
              unique new name.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SaveCalibrations</TD>
          <TD>Saves the calibrations to a file. The name of the calibrations file is printed in the
              log window; execution of this command requires Administrator mode to be enabled in the
              Calibrations menu. Command added in 3.8, 11/29/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="imagefile"></A><B>Image File Commands</B></TD>
        </TR>
         <TR vAlign="top">
          <TD class="style11">S or Save [buf] [file #]</TD>
          <TD class="style11">Save image in A or in buf to current open file, or to the given file number</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style7">SetNewFileType # [#]</TD>
          <TD>Set to 0 to open files as MRC, or 1 to open files as a TIFF series described in
            an image autodoc file. The optional second value sets whether to open montaged
            files as MRC or as a TIFF series, but only if the property
            MontageAutodocOptions is set.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">OpenNewFile file</TD>
          <TD>Open a file with the given name, which can contain spaces. The file properties 
            dialog will be bypassed. Since the current working directory can be 
            unpredictable, depending on whether the user has opened a file with the file 
            chooser, it is advisable either to specify an absolute path for the filename, 
            use a &#39;SetDirectory&#39; with an absolute path, or use a filename in a variable set 
            by &#39;ChooserForNewFile&#39;.&nbsp; The same advice applies for the following 
            commands that open files as well.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">OpenNewMontage #x #y file</TD>
          <TD>Open a file with the given name for montaging, with the number of frames in X
            and Y given by '#x' and '#y'. If either #x or #y is 0, the number of frames
            will be taken from the last montage that was open. The file properties and
            montage setup dialogs will be bypassed, and some properties like overlap and
            whether to do a stage montage will be taken from the last montage that was
            open.  If no montage has been opened through the dialogs, some parameter settings with&nbsp; 
              SetMontageParams will work, some will crash the program.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SetMontageParams # [# # # # # #]</TD>
          <TD>Sets up to 7 montage parameters after a montage file has been opened; enter a value or -1 to leave the parameter
            unchanged. The entries are: 1 to use stage movement or 0 not to; overlap in X;
            overlap in Y; frame size in X; frame size in Y, 1 to skip correlations or 0 not
            to; a binning.&nbsp; The frame sizes, overlaps, and binnings cannot validly be changed after 
            acquiring into the file.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SetupWaffleMontage #B file</TD>
          <TD>Open a montage file or adjust the current file&#39;s properties so that it will
            hold an image of the cross-line (waffle) replica grating with at least #B blocks
            in X and Y at the current magnification. Follow with the minimum # of blocks and
            the name of the file to be opened if necessary.&nbsp; If montaging is not
            needed, no changes are made.&nbsp; If there is an existing montage that is
            adequate, its properties will be adjusted to work at the current mag.&nbsp; If a
            new montage is needed, it will close the current file if it is a montage and
            open a new one with the given name.&nbsp; Variables will be substituted, so the
            name can contain the mag index, for example. It sets reportedValue1 to 1 or 0
            depending on whether montaging is needed or not. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportNumMontagePieces</TD>
          <TD>Report the number of pieces that will be acquired for a montage if one is 
            currently open, or 1 if not.&nbsp; Command added in 3.8, 11/29/19.</TD>
        </TR>
        <TR>
          <TD class="style7">SaveToOtherFile buf typ cmp file</TD>
          <TD>Saves one image in the given buffer to the file with the given name and closes 
            the file.&nbsp; &#39;typ&#39; specifies the type of file and can be MRC, TIF, TIFF, 
            JPG, JPEG, CUR, 
            or -1 (case insensitive), where CUR or -1 means use the current file type for 
            the File menu entry Save Single/Save to Other.&nbsp; If that type is a series of 
            TIFF files, a single TIFF will be written with the given name instead.&nbsp; &#39;cmp&#39; 
            specifies the compression for a TIFF file and can be NONE,&nbsp; LZW, ZIP, JPG, 
            JPEG, CUR, or -1 (case insensitive), where CUR or -1 means use the current 
            compression for Save Single/Save to Other.&nbsp; If JPG or JPEG is entered for 
            &#39;typ&#39;, a true JPEG file will be written, not a JPEG-compressed TIFF, and the 
            compression entry does not matter (but must be present before the filename).</TD>
        </TR>
       <TR>
          <TD class="style7">SnapshotToFile imsc szsc feat typ cmp file</TD>
          <TD>Takes a snapshot of the image display in the current active buffer and saves 
            it to the file with the given name and closes the file.&nbsp; &#39;imsc&#39; sets the amount 
            of image scaling relative to the display with a value of 1 or greater, or 0 or 
            less to take the whole image at 1:1 zoom.&nbsp; &#39;szsc&#39; sets the scaling of text 
            labels and line thicknesses with a value of 1 or more, or 0 or less to use the 
            same scaling as for the image.&nbsp; &#39;typ&#39; specifies the type of file and can be TIF, TIFF, 
            JPG, JPEG, CUR, 
            or -1 (case insensitive), where CUR or -1 means use the current file type selected in the 
            <a href="hidd_screenshot.htm">Image Snapshots dialog</a>.&nbsp; &#39;cmp&#39; 
            specifies the compression for a TIFF file and can be NONE,&nbsp; LZW, ZIP, JPG, 
            JPEG, CUR, or -1 (case insensitive), where CUR or -1 means use the current 
            compression in the Image Snapshots dialog.&nbsp; If JPG or JPEG is entered for 
            &#39;typ&#39;, a true JPEG file will be written, not a JPEG-compressed TIFF, and the 
            compression entry does not matter (but must be present before the filename).</TD>
        </TR>
        <TR>
          <TD class="style7">EnterNameOpenFile [prompt]</TD>
          <TD>Get a filename through a dialog with a simple text box and open it as a new
            file.&nbsp; If the optional prompt string is not supplied, the prompt is &quot;Enter
            name for new file:&quot;.</TD>
        </TR>
        <TR>
          <TD class="style7">ChooserForNewFile # var</TD>
          <TD>Open a file chooser for the user to specify a new file; # should be 0 for an 
            MRC file or non-zero for an .idoc file, and &#39;var&#39; must be the name of a variable 
            to which the full filename will be assigned.&nbsp; Since the user will confirm 
            the replacement of a file, the command also allows &#39;OpenNewFile&#39; and 
            &#39;OpenNewMontage&#39; to overwrite an existing file.</TD>
        </TR>
        <TR>
          <TD class="style7">OpenFrameSumFile suffix</TD>
          <TD>Open a file whose name starts with the last name used for saving
            frames from a K2/K3, DE, or Falcon camera, and ends with the string given in the command.&nbsp;
            The string can contain spaces and variables. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">OpenOldFile file</TD>
          <TD>Open an existing MRC or ADOC file with the given name, which can contain
            spaces.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReadFile # [buf]</TD>
          <TD>Reads the given section # (numbered from 0) from the current open file into
            the standard Read buffer, or into the buffer indicated by the optional &#39;buf&#39;</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReadOtherFile # buf file</TD>
          <TD>Reads the given section # (numbered from 0) from a file into the given buffer 
            buf and leaves the file closed; buf can be a buffer letter/number or -1 to use the 
            standard Read buffer; end with filename.&nbsp; This command can read from a TIFF 
            file, which cannot be opened otherwise.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">RetryReadOtherFile #</TD>
          <TD>Sets the number of times to retry if there is an error in ReadOtherFile, 
            with a 2-second wait between trials.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CloseFile [e]</TD>
          <TD>Close the current file. Enter optional 'e' to stop script if no file is open.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportFileNumber</TD>
          <TD>Report the number of the currently selected file, numbered from 1, or -1 if 
            there is no file open.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">SwitchToFile #</TD>
          <TD>Make the given file number, numbered from 1, be the current open file.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportFileZsize</TD>
          <TD>Report the number of frames in currently open file</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportCurrentFilename [#]</TD>
          <TD>Reports the full path and filename of the current open file and sets it into 
            ReportedValue1; or if the optional # is entered with a 1, sets the root of the 
            filename including the path in ReportedValue1, the extension (including the dot) in 
            ReportedValue2, the path only in ReportedValue3, and the rest of the rootname 
            in ReportedValue4.&nbsp; No optional assignment to variable.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportLastFrameFile</TD>
          <TD>Reports the full path and filename of the last frame file saved from a K2/K3, DE, or 
            Falcon camera and sets it into ReportedValue1.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportFrameBaseName</TD>
          <TD>Reports the base name if one is included in frame file names; sets 
              reportedValue1 to 1 if it is included and 0 if not, and if it is included, sets 
              reportedValue2 to the base name.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="textfile"></A><B>Text File Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReadTextFile var file</TD>
          <TD>Reads the entire contents of the given text file, breaks it up by spaces or tabs, and 
            stores the words or numbers as an array in the variable &#39;var&#39;.&nbsp; All lines 
            will be read and combined into the one variable.&nbsp; The file will be closed 
              after reading.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReadStringsFromFile var file</TD>
          <TD>Reads the entire contents of the given text file as a whole string per line, and 
              stores the lines as an array in the variable 'var'.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">Read2DTextFile var file</TD>
          <TD>Reads the entire contents of the given text file, breaks it up by spaces or tabs, and 
              stores the words or numbers of each line as a separate row of a 2D array in the
               variable &#39;var&#39;.&nbsp; The file will be closed after reading.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7" colspan="2">&nbsp;&nbsp;&nbsp;&nbsp; The following commands allow 
              multiple files to be opened for either reading or writing (not both) and 
              accessed one line at a time.&nbsp; Each 
              file is referred to by an arbitrary one-word identifier (ID) that immediately follows 
              the command; the ID is case-insensitive.</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style7">OpenTextFile ID Mode #K file</TD>
           <td>Opens a file with the given name and ID in the given mode, closing it when the 
               script ends if #K is 0 or keeping it open if #K is non-zero.&nbsp; The mode can 
               be: <br />
               &nbsp;&nbsp;
               R or r to open for reading, giving an error if the file does not exist; <br />
               &nbsp;&nbsp;
               T or t to try to open for reading, setting reportedValue1 to 1 if the file exists
                or 0 if it does not;
               <br />
&nbsp;&nbsp; W or w to open for writing, giving an error if the file exists unless 
               'AllowFileOverwrite 1' has been used;<br />
&nbsp;&nbsp; O or o to open for writing, overwriting an existing file if any;<br />
&nbsp;&nbsp; A or a to open for appending (writing at the end), giving an error if the file 
               does not exist.<br />
               The same file cannot be opened under two different ID's.&nbsp; The 'T' mode can 
               be used to avoid a script error and also can be used in a loop to wait for a 
               file to appear from an external source.&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">WriteLineToFile ID line</TD>
           <td>Writes the remainder of the text on the script line (after variable 
               substitution) to the file with the given ID.&nbsp; The comment character '#' can 
               be included and text after it will be written.&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">ReadLineToArray ID var</TD>
           <td>Reads the next line of the file with the given ID, breaks it into words, and 
               sets up an array variable with each word as an element.&nbsp; '#' is treated as 
               the start of comment and the rest of the line is discarded. Blank lines and 
               lines starting with '#' will be skipped.&nbsp; Parts of the line enclosed in 
               single quotes will be treated as single strings if the 'ParseQuotedStrings' 
             command has been given.&nbsp; Reaching the end of the file does 
               not give a script error; instead, reportedValue1 is set to 1 when a line is read 
               or 0 if nothing was read.&nbsp; This command could be used in a loop to wait for 
               a file to be added to by external source.&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">ReadLineToString ID var</TD>
           <td>Like 'ReadLineToArray ', but the line is stored in the variable exactly as it is 
               in the file, including a line starting with '#'.&nbsp; Blank lines will still be 
               skipped.&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">FlushTextFile ID</TD>
           <td>Flushes the output added to the file with the given ID to disk .&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">CloseTextFile ID</TD>
           <td>Closes the file with the given ID.&nbsp; Command added in 3.8.</td>
        </TR>
       <TR vAlign="top">
          <TD class="style7">IsTextFileOpen ID [file]</TD>
           <td>Sets reportedValue1 to 1 if there is an open file with the given ID, or with the 
               given optional name, and to 0 otherwise.&nbsp; The ID can be nonsense when 
               testing with a filename.&nbsp; Command added in 3.8.</td>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="autodoc"></A><B>Autodoc/.mdoc File Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">AddToAutodoc key value</TD>
          <TD>Adds a key-value pair to the last section of the autodoc associated with the
            current open image file, if any.&nbsp; The next word after the command is the key, and
            the remainder of the text on the line is taken as the value.&nbsp; Variables are
            substituted before using the text.&nbsp; After one or more additions to a
            section of the autodoc, a WriteAutodoc command must be used to save the values
            before closing the file or saving another image to it.&nbsp; If no images have 
            been written yet, the entry will be added to the global section.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">WriteAutodoc</TD>
          <TD>Writes the autodoc associated with the current open image file.&nbsp; Use this
            command once after adding one or more values to a section of the autodoc.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">OpenFrameMdoc filename</TD>
          <TD>Opens an '.mdoc' file with the given name for information about image 
            acquisitions that save frames, the same as using the
            <a href="menu_file.htm#hid_file_open_mdoc">Open .mdoc for Frames</a> command.&nbsp; 
            An error is generated if such a file is already open.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">CloseFrameMdoc [#]</TD>
            <td>Closes the '.mdoc' file for acquisitions that save frames, if one is open. 
                If the optional # is non-zero, an error is generated if no file is open.&nbsp; Command added in 3.8.
            </TD>
        </TR>
         <TR vAlign="top">
          <TD class="style7">AddToFrameMdoc key value</TD>
          <TD>Adds a key-value pair to the last section of the autodoc opened with the
            <a href="menu_file.htm#hid_file_open_mdoc">Open .mdoc for Frames</a> or 
              'OpenFrameMdoc' command.&nbsp; 
            This works just like AddToAutodoc, but the WriteFrameMdoc command must be used 
            instead after adding values.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">WriteFrameMdoc</TD>
          <TD>Writes the frame autodoc file; use this command after adding one or more 
            values to a section.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">ReportFrameMdocOpen</TD>
          <TD>Reports whether a frame .mdoc file is open; sets ReportedValue1 to 1 if so.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">DeferWritingFrameMdoc</TD>
          <TD>Prevents the program from appending a new section to the frame .mdoc file 
            after frames are acquired.&nbsp; If you use this command before starting the 
            acquisition, add values after acquisition with &#39;AddToFrameMdoc &#39;, and finish 
            with &#39;WriteFrameMdoc&#39;, the new section with your additions can be appended to 
            the file rather than rewriting the whole file.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">StartNextFrameStackMdoc key value</TD>
          <TD>Adds a key-value pair to the global section of the .mdoc file written with 
            each frame stack when the option for such a file is selected in the
            <a href="#hidd_k2_save_options.htm">Frame File Options</a> dialog, after 
            clearing out any previous entries in the global section.&nbsp; This command and 
            the next must be given before acquiring.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style7">AddToNextFrameStackMdoc key value</TD>
          <TD>Adds a key-value pair to the global section of the frame stack .mdoc file 
            while retaining previous entries there.</TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="scope_filter_commands"></A><B>Microscope and Filter Control Commands</B></P>
      <TABLE style="Z-INDEX: 0" border="1" cols="2">
        <TR vAlign="top">
          <TD colspan="2"><A name="stage_commands"></A><B>Stage-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">U or TiltUp [#R] [#X #Y]</TD>
          <TD>Tilt up by preset increment.&nbsp; If optional #R is non-zero, then the program 
              will restore the stage X and Y positions after tilting, either to the position 
              before starting or to #X, #Y if they are entered.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">D or TiltDown&nbsp; [#R] [#X #Y]</TD>
          <TD>Like TiltUp, but tilt down by preset increment</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style10">TiltTo #A&nbsp; [#R] [#X #Y]</TD>
          <TD class="style11">Like TiltUp, but tilt to given angle #A</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">TiltBy #A&nbsp; [#R] [#X #Y]</TD>
          <TD>Like TiltUp, but change tilt by the given amount #A</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">BackgroundTilt #A [#S]</TD>
          <TD>Start tilting stage in the background; images can be taken and scripts can run 
            during the tilt.&nbsp; Follow with #A, the angle to tilt to, and optionally with 
            #S, a speed factor for FEI or JEOL scopes that support this (&lt; 1 for slower than normal tilting).&nbsp; 
            For CryoARM, speed factors of 100 - 105 will select pre-set speeds
              of 10, 2, 1, 0.5, 0.25, and 0.1 degrees/sec.&nbsp; On FEI scopes, background stage movement requires the property 
            &#39;BackgroundSocketToFEI&#39; set to 1 so that the fourth socket for background stage 
            operations is opened when the program starts.  If the command 
              crashes SerialEM or FEI-SEMserver, see notes under <a href="#tiltDuringRecord">TiltDuringRecord</a>.
              </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportTiltAngle</TD>
          <TD>Report current tilt angle</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MoveStage #X #Y [#Z]</TD>
          <TD>Move stage by micron increments in X, Y, Z (Z optional)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MoveStageTo #X #Y [#Z]</TD>
          <TD>Move stage to given position in microns. Z is optional and Z will not be
            changed if it is omitted.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">StageShiftByPixels #X #Y</TD>
          <TD>Move the stage by the given number of unbinned pixels in X and Y on the 
            current camera.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportStageXYZ</TD>
          <TD>Report current stage position</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportStageBusy</TD>
          <TD>Report if the stage is busy and set ReportedValue1 to 1 if so, 0 if not.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">TestRelaxingStage #X #Y [#B] [#R]</TD>
          <TD>Move stage by the micron increments in X and Y with backlash correction and a 
            small relaxation in the opposite direction from the backlash correction.&nbsp; 
            The optional B can be set with the backlash amount, otherwise the value of the 
            property &#39;StageMontageBacklash&#39; will be used.&nbsp; The optional R can be set 
            with the relaxation amount in microns; otherwise the value of the property 
            &#39;StageRelaxation&#39; will be used (default 0.025).&nbsp; The backlash movement will 
            be opposite to the stage movement unless B is negative.&nbsp; To assess the 
            value of relaxation, a measurement of the time it takes for drift to settle 
            should be done after this command.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">RelaxStage [#R]</TD>
          <TD>If the stage is in a known backlash state, move the stage in the opposite 
            direction from its last movement by the amount given by the optional R, or the 
            StageRelaxation property (0.025 by default).&nbsp; A message is printed if the 
            stage backlash state is not known.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportStageBAxis</TD>
          <TD>Reports the B axis value of the stage in degrees, if such an item exists.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetStageBAxis #</TD>
          <TD>Sets the stage B axis to the given value in degrees.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="focus_commands"></A><B>Focus-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ChangeFocus #</TD>
          <TD>Change defocus by the given value in microns</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetDefocus #</TD>
          <TD>Set the defocus to the given value in microns</TD>
        </TR>
        <TR>
          <TD class="style13">SetAbsoluteFocus #</TD>
          <TD>Set focus to a an absolute (standardized)&nbsp;value as reported earlier by
            ReportAbsoluteFocus or ReportFocus</TD>
        </TR>
        <TR>
          <TD class="style13">SetStandardFocus #</TD>
          <TD>Same as &#39;SetAbsoluteFocus&#39;, which is preferred to avoid confusion with the
            calibrated standard or eucentric focus value</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetObjFocus #</TD>
          <TD>Calls SetObjFocus on JEOL with the given #, an integer increment, and reports
            change in focus</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportDefocus</TD>
          <TD>Report current defocus readout in microns</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportAbsoluteFocus</TD>
          <TD>Report an absolute (standardized) value for the current focus setting</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportFocus</TD>
          <TD>Same as &#39;ReportAbsoluteFocus&#39;, which is a better description of the operation</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetEucentricFocus</TD>
          <TD>If in low mag, sets to the standard focus for the current mag or nearest LM
            mag if one has been set; otherwise on FEI it assumes standard focus is 0 and on
            JEOL it stops with an error.&nbsp; If not in LM, sets to the standard focus for
            the nearest nonLM mag if one has been set or stops with an an error if none were
            set.&nbsp; On FEI scopes, it issues a warning if it is using a calibrated value
            from a different mag.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">CalEucentricFocus</TD>
          <TD>Stores the current standardized focus value as the standard focus for the
            current mag, just as the Calibrate menu item
            <a href="menu_calibration.htm#hid_calibration_standardlmfocus">Standard Focus</a>
            does.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SaveFocus</TD>
          <TD>Saves the current focus; the focus will be restored to this value either by
            RestoreFocus or when the script stops or exits.&nbsp; The script will not be
            resumable if it stops.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">RestoreFocus</TD>
          <TD>Restores the focus value when SaveFocus was run.&nbsp; After this is run, the
            focus will not be restored again when the script ends.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ResetDefocus</TD>
          <TD>Sets the defocus readout to 0, just as
            <a href="menu_focus.htm#hid_focus_resetdefocus">Reset Defocus</a> in Focus menu
            does.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="mag_commands"></A><B>Magnification-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetMag #M [#D]</TD>
          <TD>Set the mag to an actual mag value in #M.&nbsp; In STEM mode, set the optional 
            #D non-zero to set STEM mag directly to the given value, without trying to find 
            it in the mag table.</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style13">SetMagIndex #</TD>
          <TD>Set the magnification index to the given value</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ChangeMag #</TD>
          <TD>Change mag by given number of mag steps, positive to increase mag index and 
            negative to decrease it.&nbsp; If the property &#39;UseInvertedMagRange&#39; is set, 
            positive and negative increase or decrease the mag rather than the mag index in 
            the inverted range.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportMag</TD>
          <TD>Report the current mag; also set ReportedValue2 to 1 if low mag mode, 0 if not</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportMagIndex</TD>
          <TD>Report the current mag index; also set ReportedValue2 to 1 if low mag mode, 0
            if not</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportCameraLength</TD>
          <TD>Report the camera length in meters, or 0 if not in diffraction mode.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetCamLenIndex #</TD>
          <TD>Set the camera length index to the given number; on an FEI scope, values higher
            than 30 set the index to (# - 30) in LAD mode</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetMagAndIntensity #</TD>
          <TD>Set the mag to the actual film mag value and change the beam to maintain the
            same brightness. Two values are reported: the initial percent C2 value and the
            remaining factor of intensity change needed if it was not possible to change
            the intensity by the full amount needed. The C2 value should be used to restore
            intensity when the mag is restored. The remaining intensity change could be
            applied to the exposure time if necessary. The script will stop if there is an
            error in the intensity change.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ChangeMagAndIntensity #</TD>
          <TD>Change mag by the given number of mag steps and change the beam to maintain the
            same brightness. Behaves same as SetMagAndIntensity, and steps in the same way 
            as ChangeMag.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">IncMagIfFoundPixel #</TD>
          <TD>Increase or decrease mag by one step if the pixel size has been found at the
            current mag with the <a href="menu_calibration.htm#hid_process_findpixelsize">Find Pixel Size</a>
            routine, depending on whether # is positive or negative.&nbsp; Sets
            reportedValue1 to 1 if the mag is changed, 0 otherwise.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="beam_commands"></A><B>Beam-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetSpotSize #</TD>
          <TD>Set the spot size to the given number</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportSpotSize</TD>
          <TD>Report the current spot size</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetPercentC2 #</TD>
          <TD>Set the C2/C3 lens strength to the given percentage, or illuminated area on
            Titan to given value in microns.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">IncPercentC2 #</TD>
          <TD>Change the C2/C3 lens strength percentage or illuminated area in microns by the given amount</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportPercentC2</TD>
          <TD>Report the percent C2/C3 (on an FEI scope, this number matches the value in MUI)
            and the fractional lens strength.&nbsp; On a Titan, if illuminated area is being
            used for intensity, this reports the illuminated area value.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportCrossoverPercentC2</TD>
          <TD>Report the percent C2/C3 and the fractional lens strength of the crossover at the
            current spot size and probe mode as calibrated. If illuminated area is being
            used for intensity, this reports the illuminated area value at crossover.
            Command added in 3.8, 11/29/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportIlluminatedArea</TD>
          <TD>Report the illuminated area on a Titan in the units that are used internally, which are 
            microns times 0.01.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetIlluminatedArea #</TD>
          <TD>Set the illuminated area on a Titan to the given value, expressed in microns 
            times 0.01.</TD>
        </TR>
       <TR vAlign="top">
          <TD class="style13">ReportImageDistanceOffset</TD>
          <TD>Report the offset of the distance from the condenser plane to the image plane
           on a Titan in the units from the scope.  Older versions of the scripting software
           do not have this function, and with them, this command and the next one will crash SerialEM or FEI-SEMserver.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetImageDistanceOffset #</TD>
          <TD>Set the offset of the distance from the condenser plane to the image plane
           on a Titan; the allowed range is +/- 0.02.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetIntensityForMean #</TD>
          <TD>Adjust beam intensity to yield the given number of counts in a Record image, based on counts in
            the tilt-foreshortened area of the image in A. In Low Dose mode, this operates
            only on Record images and will change the intensity only of the Record area.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetExposureForMean #M [#K]</TD>
          <TD>Adjust Record exposure time to yield the gven number of counts #M, based on 
            counts in the tilt-foreshortened area of the image in A, which must be a Record 
            image in Low Dose mode.&nbsp; For a K2/K3 camera taking dose-fractionated images, a 
            non-zero value can be given for the optional #K to modify frame time so as to             non-zero value can be given for the optional #K to modify frame time so as to 
            keep the same number of frames.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetIntensityByLastTilt</TD>
          <TD>Adjust beam intensity by the change in cosine of the tilt angle from the last
            tilt change. In low dose mode, this changes the intensity only of the Record
            area.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ChangeIntensityBy #</TD>
          <TD>Change beam intensity by the given factor using calibrations. In low dose mode
            this changes the intensity of the current area.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetDoseRate #</TD>
          <TD>Change the beam intensity to set the dose rate at the camera to the given value
            in electrons per unbinned pixel per second beam intensity, based on the image in 
            buffer A.  This command is the same as running 
            <a href="menu_tasks.htm#hid_tasks_set_dose_rate">Set Dose Rate</a> in the Tasks
            menu. In low dose mode it changes the intensity of the current area.  
            Command added in 3.8, 10/24/19.
          </TD>
        </TR>
         <TR vAlign="top">
          <TD class="style13">SetAlpha #</TD>
          <TD>Sets alpha value on JEOL.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportAlpha</TD>
          <TD>Reports alpha value on JEOL.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetBeamShift #X #Y</TD>
          <TD>Set the beam shift to the given values (nominal micron units)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportBeamShift</TD>
          <TD>Report the beam shift in nominal micron units</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MoveBeamByMicrons #X #Y</TD>
          <TD>Moves the beam by the given number of microns in X and Y.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MoveBeamByFieldFraction #X #Y</TD>
          <TD>Moves the beam by the given fractions of the current camera field of view in X 
            and Y; e.g. 0.5,0.5 would move the center of the beam from the center of the 
            field to the upper right corner.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetBeamTilt #X #Y</TD>
          <TD>Set the beam tilt to the given values (milliradians or % of full scale)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportBeamTilt</TD>
          <TD>Reports the beam tilt in milliradians for FEI, % of full-scale value for JEOL</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetProbeMode #</TD>
          <TD>Sets the mode to microprobe or nanoprobe on an FEI scope.&nbsp; Follow with 0 
            or &quot;nano&quot; for nanoprobe, or 1 or &quot;micro&quot; for microprobe.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SaveBeamTilt</TD>
          <TD>Saves the current X and Y beam tilt (specifically for the current probe mode 
            on an FEI scope).&nbsp; It will be restored to these values 
            either by RestoreBeamTilt or when the script stops or exits.&nbsp; The script will not be
            resumable if it stops.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">RestoreBeamTilt</TD>
          <TD>Restores the beam tilt saved when SaveBeamTilt was run or another command 
            saved the beam tilt (AdjustBeamTiltForIS or several ImageShift commands).&nbsp; After this is run, 
            the beam tilt will not be restored again when the script ends.&nbsp; For an FEI 
            scope, it is restored for the current probe mode provided that a value was saved 
            in that mode.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportProbeMode</TD>
          <TD>Reports whether an FEI scope is in nanoprobe or microprobe mode; sets first 
            reported value to 0 or 1, respectively.</TD>
        </TR>
        <TR vAlign="top">
          <TD colspan="2"><A name="image_shift"></A><B>Image Shift-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style14">SetImageShift #X #Y [#D] [#A]</TD>
          <TD class="style15">Set the image shift to the given values (image shift units).&nbsp; The values
            correspond to the ones give by ReportImageShift, which are adjusted for tilt
            axis offset, image shift offset, and low dose area shift.&nbsp; Add the optional 
            #D to impose a settling time before the next camera image equal to D times 
            the normal settling time (i.e., 1 for regular settling).&nbsp; Add the optional 
            #A to use the <a href="menu_calibration.htm#hid_focustuning_comavs">Coma vs. 
            Image Shift</a> calibration to adjust beam tilt for the incremental change in 
            image shift from its current value. With that option, the command saves the 
            current beam tilt, if it has not been saved before in the script, and it will be 
            automatically restored when the script exits.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ImageShiftByPixels #X #Y [#D] [#A]</TD>
          <TD>Change image shift by given # of unbinned pixels in camera X and Y; optional #D 
            and #A provide settling time and beam-tilt adjustment for the image shift as just described.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ImageShiftByUnits #X #Y&nbsp; [#D] [#A]</TD>
          <TD>Change image shift by given # of IS units in X &amp; Y; optional #D and #A provide settling time 
            and beam-tilt adjustment for the image shift as just described.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ImageShiftByMicrons #X #Y [#D] [#A]</TD>
          <TD>Change image shift by given distance on specimen (X is tilt axis); optional #D 
            and #A provide settling time and beam-tilt adjustment for the image shift as just described.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ImageShiftByStageDiff #X #Y [#D] [#A]</TD>
          <TD>Change image shift by the equivalent of the given stage shift in X and Y; optional #D 
            and #A provide settling time and beam-tilt adjustment for the image shift as just described.&nbsp; 
            Command added in 3.8, 12/24/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportImageShift</TD>
          <TD>Report the image shift in IS units, adjusted for tilt axis offset, image shift
            offset, and low dose area shift; if image shift is calibrated, also report the equivalent shift in unbinned 
            pixels on the current camera at the current magnification, and the amount the 
            stage would need to be moved to compensate for resetting this image shift.&nbsp; Positive values of the 
            camera shift will result from an image shift 
            imposed by dragging an image to the upper right.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportSpecimenShift</TD>
          <TD>Report the image shift, as just described, in the &quot;specimen&quot; coordinates used 
            internally by the program, which are coordinates in microns with X along the tilt 
            axis.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="misc_scope"></A><B>Miscellaneous Scope Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetObjectiveStigmator #X #Y</TD>
          <TD>Set the objective lens stigmator to the given values (between -1 and 1)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportObjectiveStigmator</TD>
          <TD>Report the X and Y values of the objective stigmator, between -1 and 1</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetBeamBlank #</TD>
          <TD>Blank beam if # is 1, unblank if # is 0</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">NormalizeLenses #</TD>
          <TD>Normalize selected lenses on an FEI or Hitachi scope; # is the sum of 1 for projector, 2
            for objective, 4 for condenser lenses</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">NormalizeAllLenses [#]</TD>
          <TD>Normalize all lenses, or in a lens group, on an FEI scope.&nbsp; With # 0 or
            not present, it normalizes all lenses in one call.&nbsp; Otherwise, # can be the
            sum of 1 to normalize the illumination group (which includes condenser,
            minicondenser, and objective lenses) and 2 to normalize the projection group (which includes objective and projector
            lenses) in a separate call.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportColumnOrGunValve</TD>
          <TD>Report 0 or 1 if column/gun valve is closed or open on FEG scopes, or if 
            filament on JEOL is clearly off or on.&nbsp; Reports -1 if the filament current 
            is inconsistent with the beam switch state.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetColumnOrGunValve #</TD>
          <TD>Close column/gun valve on FEG scope or turn off filament on JEOL if # is 0; open valve or turn on filament if # is 1.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportFilamentCurrent</TD>
          <TD>Report the filament current on a non-FEG JEOL scope.&nbsp; The value is between 
              0 and 100 unless the property 'FilamentCurrentScale' is set with a scaling 
              other than 100.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetFilamentCurrent #</TD>
          <TD>Set the filament current on a non-FEG JEOL to #, in the same units as&nbsp; 
              'ReportFilamentCurrent'.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ScreenUp</TD>
          <TD>Raise the main screen</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ScreenDown</TD>
          <TD>Lower the main screen</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportScreen</TD>
          <TD>Report if screen is up or down; reportedValue1 is set to 0 or 1, respectively.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportScreenCurrent</TD>
          <TD>Reports the unsmoothed screen current in nA. Command added in
          3.8, 11/29/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportLens name</TD>
          <TD>For a Hitachi or JEOL scope, reports the lens value by its abbreviated name.&nbsp; 
            For JEOL, allowed names are CL1, CL2, OM2, IL1, IL2, IL3, PL1, PL2, PL3, PL4, 
            FLf, FLc, FLcomp1, FLcomp2.  Value cannot be assigned to a variable at end of commmand</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportDeflector name</TD>
          <TD>For a Hitachi scope, reports the X and Y values of deflector specified by its 
            abbreviated name.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetFreeLensControl&nbsp; #L #S</TD>
          <TD>On a JEOL with scripting support for free lens control, turn free lens control 
            for the lens given by #L off if #S is 0 and on otherwise.&nbsp;&nbsp; Lens 
            numbers are: 0: CL1,&nbsp; 2: CL3,&nbsp; 6: OL Coarse,&nbsp; 7: OL Fine,&nbsp; 
            8: OM,&nbsp; I0: IL1,&nbsp; 11: IL2,&nbsp; 12: IL3, 13: IL4,&nbsp; 14: PL1,&nbsp; 
            15 or 16: PL2,&nbsp; 19: FL Coarse,&nbsp; 20: FL Fine,&nbsp; 21: FL Ratio </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetLensWithFLC #L #V [#R]</TD>
          <TD>Using free lens control, sets the lens given by #L (see SetFreeLensControl) to 
            the value #V between 0 and 1 if the optional #R is 0 or absent, or changes it by 
            #V if #R is non-zero.&nbsp; This command probably turns on FLC for that lens.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportLensFLCStatus #L</TD>
          <TD>For the lens given by #L (see SetFreeLensControl), reports whether free lens 
            control is on and the value for the lens.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">RemoveAperture #</TD>
          <TD>Remove the aperture whose index is the given # (JEOL only).&nbsp; If the 
            property JeolHasExtraApertures is not set, 1 and 2 are the 
            condenser and objective apertures, others are 3:HCA, 4:SAA, 5:ENTA, 6:EDS.&nbsp; 
            If that property is set (e.g., for CryoARM), indexes are 0:CL1, 1:CL2, 
            2:OL(OL Upper), 3:HC(OL Lower), 4:SA, 5:ENT, 6:HX, 7:BF, 8:AUX1, 
             9:AUX2, 10:AUX3, 11:AUX4.&nbsp;
            The size and position of the aperture will be recorded before it is removed.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReInsertAperture #</TD>
          <TD>Replace the aperture whose index is the given # after it has been removed with 
            &#39;RemoveAperture&#39; (JEOL only).&nbsp; The aperture of the stored size will be 
            inserted and it will be set to the stored position.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">PhasePlateToNextPos</TD>
          <TD>Move phase plate to next position.&nbsp; Works on JEOL and FEI scopes, but for 
            FEI scopes it requires server version 6.13 and a license for advanced scripting.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportPhasePlatePos</TD>
          <TD>Report the current phase plate position number, numbered from 1 (FEI scopes only)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportVacuumGauge name</TD>
          <TD>Reports the status and pressure reading from a vacuum gauge identified by the 
              given name.&nbsp; For FEI scopes, the names are of the style accepted in the 
              WatchGauge property; status values are 0 for undefined, 1 for underflow, 2 for 
              overflow, 3 for invalid, and 4 for valid; pressure is in pascals.&nbsp; For JEOL 
              scopes, the command requires a relatively recent version of TemExt; names can be 
              Pir0 to Pir9 or Pen0 to Pen9; status values are 0 for not ready, 1 for low, 2 
              for high, and 3 for ready; and pressure values are between 0 and 1 (the value 
              returned by the scope is divided by 4095).&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportHighVoltage</TD>
          <TD>Reports the current value of the high tension in kV.&nbsp; Command added in 3.8, 9/30/19</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ManualFilmExposure #</TD>
          <TD>Film exposure time in seconds for manual exposures, or 0 for automatic exposure
            (the default)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ExposeFilm</TD>
          <TD>Take a film exposure</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SpecialExposeFilm # [#] [#]</TD>
          <TD>Expose film with special handling: the first # specifies a delay in seconds
            after loading the plate; the second # specifies a pre-exposure of the specimen
            before exposing the plate, in seconds. The third # suppresses dimming of the
            screen if it is nonzero.  This command command does not raise the
            screen if it is down. It requires the adaexp server to be installed.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetupMessageBox #B [#T] [text]</TD>
          <TD>Sets properties for a message box to be shown on an FEI microscope computer 
            with the next command.&nbsp; B specifies the type of buttons: 0 for OK, 1 for OK 
            - Cancel, 2 for Yes - No, 3 for Yes - No - Cancel.&nbsp; The optional T sets the 
            time interval between message box displays, or 0 to display it unconditionally 
            or -1 just to set the time of display to the current time.&nbsp; The optional 
            rest of the line specified the text inside the message.&nbsp; If you just want 
            to specify an interval, enter &#39; 0 interval&#39;; if you just want to specify text 
            for a box to be displayed unconditionally, enter &#39;0 0 text&#39;.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ShowMessageOnScope title</TD>
          <TD>Opens a message box on an FEI microscope computer with the given title, which 
            can include spaces.&nbsp; The box is displayed with the &quot;long operation&quot; 
            mechanism described below, so it is possible to have it displayed only after an 
            interval has elapsed.&nbsp; If SetupMessageBox was not used, the default is for 
            a box with an OK button, opened unconditionally, with the text &quot;SerialEM 
            message&quot;.&nbsp; When the command is finished, reportedValue1 is set with 1 if 
            the box was displayed or 0 if it was not, and reportedValue2 is set with the 
            reply from the box: 2 for Yes or OK, 1 for No, 0 for Cancel, or -1 for an error.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportXLensDeflector #D</TD>
          <TD>Report the X and Y values of a deflector associated with the X lens, where #D 
            should be 1 for shift, 2 for tilt, 3 for stigmators.&nbsp; To use X lens 
            commands, the adatl module must be registered and the environment variable 
            SEM_USE_ADATL must be set to any value on the microscope, and XL mode must be 
            turned on in the microscope interface.&nbsp; Commands added in 3.8, 12/5/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetXLensDeflector #D #X #Y</TD>
          <TD>Set the X and Y values of an X lens deflector, where #D is 1 for shift, 2 for 
            tilt, 3 for stigmator.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportXLensFocus</TD>
          <TD>Report the focus setting of the X lens.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetXLensFocus #</TD>
          <TD>Set the focus setting of the X lens.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="filter_commands"></A><B>Energy Filter Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetSlitWidth #</TD>
          <TD>Sets energy filter slit width in eV</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetSlitIn [#]</TD>
          <TD>Inserts the slit; or if # is entered, inserts if 1 or retracts if 0</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SetEnergyLoss #</TD>
          <TD>Set sthe energy loss to the #</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ChangeEnergyLoss #</TD>
          <TD>Changes the energy loss by the #</TD>
        </TR>
        <TR>
          <TD class="style13">ReportEnergyFilter</TD>
          <TD>Reports the slit width, energy loss, and whether the slit is in or out (the
            latter is placed in ReportedValue3 as a 1 or 0)</TD>
        </TR>
        <TR>
          <TD class="style13">SetJeolGIF #</TD>
          <TD>Calls JEOL function to set GIF mode on (if # is nonzero) or off.</TD>
        </TR>
        <TR>
          <TD class="style13">ReportJeolGIF</TD>
          <TD>Calls JEOL function to get whether GIF mode is on.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="loader_vacuum"></A><B>Autoloader,
          Refrigerant, and Vacuum Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">LoadCartridge #</TD>
          <TD>Loads the cartridge from the given slot # (numbered from 1) if there is an
            FEI autoloader.  This command starts a long operation.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">UnloadCartridge</TD>
          <TD>If there is an FEI autoloader, unloads the cartridge.  This command starts a long operation</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportSlotStatus #</TD>
          <TD>Report the status of the cartridge slot given by # (numbered from 1) if there
            is an FEI autoloader.&nbsp; Status is -1 for an error, 0 for empty, and 1 for
            occupied.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">AreDewarsFilling</TD>
          <TD>Report whether any of the dewars in a temperature control system on an FEI 
            scope are busy
            filling (reported value 1 is set to 0 or 1).
            &nbsp; Also reports if tanks are being refilled on a JEOL if the interface 
            exists for determining that (reported value is set to 1 for stage tank plus 2 
            for transfer tank).&nbsp; Value can be assigned to a variable at end of commmand.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">DewarsRemainingTime</TD>
          <TD>Report the time remaining for until next automatic dewar filling on an FEI 
            scope, or -1 if
            none is scheduled.&nbsp; Value can be assigned to a variable at end of commmand.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">RefrigerantLevel #</TD>
          <TD>Report the refrigerant level of the given dewar on an FEI scope: 1 for autoloader, 2 for
            column, 3 for liquid helium. &nbsp; Value can be assigned to a variable at end of commmand.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">IsPVPRunning</TD>
          <TD>Report whether the PVP is running on an FEI scope.&nbsp; Value can be assigned 
          to a variable at end of commmand.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">LongOperation Op # [Op #...]</TD>
          <TD>Starts one or more time-consuming operations: Buffer cycle (Bu), Refill
            refrigerant on FEI (Re), Inventory cassettes (In), Loader buffer cycle (Lo), 
            Unload cartridge (Un), Dark
            reference update for K2 (or K3 with GMS 3.31+) (Da), Refill Stage tank&nbsp; (RS) or Refill Transfer 
            tank (RT) on JEOL, or Flash FEG (FF) on JEOL.&nbsp; Operations are identified by the first two
            letters of whatever full word you use (case insensitive).&nbsp; Each operation
            except Inventory and Unload cartridge must be followed by an interval in hours (#).&nbsp; If # is &gt;
            0, the operation is done only if the time since the last such operation is
            greater than #; if # is 0, the operation is done unconditionally; if # is -1, it
            simply records the current time as the time of the last operation; if # is &lt; -1, 
              it reports the time in hours since the last operation and places it into one of 
              the reportedValue variables.&nbsp;&nbsp; The scope operations will occur sequentially
            and be started in &nbsp;the order that they are listed. The dark reference update
            will be done simultaneously with scope operations.&nbsp; If an error occurs in a
            scope operation, other operations will be finished and the error reported at the
            end.&nbsp; Errors other than in refilling refrigerant will cause the script to
            stop.&nbsp; The user
            interface should not hang during long operations, and users will be asked to confirm that they want to
            kill the operation threads if they press STOP or try to exit the program.&nbsp;
            The consequences of killing these threads are uncertain.&nbsp; If a tank 
            refilling on a JEOL is included in the operations, a STOP will just stop all 
            filling.&nbsp; In order for time 
            intervals to be kept track of between runs of the program, the property 
            IgnoreShortTermCals must not be set.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="piezo_commands"></A><B>Piezo Drive Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">SelectPiezo # #</TD>
          <TD>Select a piezo drive for reports or movements, follow with the plugin number
            (numbered from 0, enter 0 if there is only one plugin controlling piezos) and
            the piezo number (numbered from 0).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportPiezoXY</TD>
          <TD>Reports the X and Y position of the currently selected piezo, if there is 
              a piezo plugin loaded, or of the piezos on a JEOL stage if not.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">ReportPiezoZ</TD>
          <TD>Reports the Z position, or the position of the only axis for a single-axis
            piezo, of the currently selected piezo</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MovePiezoXY #X #Y [#]</TD>
          <TD>Sets the X and Y position to #X, #Y for the currently selected piezo, if a 
              piezo plugin is loaded, or for the piezos on a JEOL stage if not. If the
            optional third # is non-zero, moves the piezo by #X, #Y.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="style13">MovePiezoZ #Z [#]</TD>
          <TD>Sets the Z position, or position of a single-axis piezo, to #Z for the
            currently selected piezo, or if the optional second # is non-zero, moves the
            piezo by #Z</TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="high_level_operations"></A><B>Higher Level Operations and Tasks</B></P>
      <TABLE border="1" cols="2">
        <TR  vAlign="top">
          <TD colspan="2"><A name="autoalign"></A><B>Autoalign-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">A or Autoalign</TD>
          <TD>Align buffer A to autoalign buffer</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">AlignTo buf [#IS] [#T]</TD>
          <TD>Align buffer A to given buffer (e.g. B or 2). Optionally, enter 1 for '#IS' to
            avoid changing microscope image shift, and 1 for &#39;#T&#39; to prevent trimming of 
            dark borders.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ClearAlignment [#IS]</TD>
          <TD>Clear the alignment shift of the image in buffer A.&nbsp; Optionally, enter 1 
            for &#39;#IS&#39; to avoid changing microscope image shift.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">LimitNextAutoAlign</TD>
          <TD>Sets a limit in microns to the amount of shift allowed in the next autoalign.
            If there are no correlation peaks within that limit, no shift will be imposed.
            &nbsp; Command added in 3.8, 10/20/19</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ConicalAlignTo buf # [show]</TD>
          <TD>Align buffer A to the given buffer 'buf' assuming a specimen rotation given by
            #. Optionally, enter 1 for 'show' to show the cross-correlation.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportAlignTrimming</TD>
          <TD>Report the sum of left and right borders and the sum of top and bottom borders
            in the last autoalign for the image in A and for the reference image.&nbsp; The
            numbers are in pixels of the respective images before the additional binning
            applied for correlation, and will thus differ from the binned values reported by
            the autoalign routine.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportAlignShift</TD>
          <TD>Report the X and Y alignment shift of the current image in A in unbinned pixels
            on image, in nanometers along the image shift axes, and in nanometers on the
            specimen, where the tilt axis is along X.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportShiftDiffFrom #</TD>
          <TD>Report the difference between the alignment shift of the current image and the
            given value in microns, as percentage of the value; the cumulative sum of
            differences in microns, and the total sum of shifts in microns. For monitoring
            variability in successive stage movements.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportAccumShift</TD>
          <TD>Report sum of shifts given by ReportAlignShift or ReportShiftDiffFrom</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ResetAccumShift</TD>
          <TD>Reset the sum of shifts given by ReportAlignShift to 0 or ReportShiftDiffFrom</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="autofocus"></A><B>Autofocus/Autotuning-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">G or Autofocus [#] [#]</TD>
          <TD>Autofocus; set optional first # to -2 to measure shift and drift, -1 to just measure defocus without changing,
            or 1 for normal autofocus that changes focus to target; set optional second # to 1
            or 2 to focus with View area in Low Dose mode, or -1 to focus with Record area. With&nbsp; &#39;-1 1&#39;, the measured 
            defocus is that of the View area, i.e., not adjusted for View defocus offset; 
            with &#39;-1 2&#39; the measured defocus is adjusted for the offset to give an estimate 
            of defocus in the Record area. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">IncTargetDefocus #</TD>
          <TD>Change the defocus target by #</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetTargetDefocus #</TD>
          <TD>Set the defocus target to #</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportAutofocusOffset</TD>
          <TD>Report the current value of the defocus offset used for autofocusing</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetAutofocusOffset #</TD>
          <TD>Set the defocus offset for autofocusing to the given #.&nbsp; The first time 
            it is set, the current value is saved, and it will be restored automatically 
            when the script ends.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">BeamTiltDirection #</TD>
          <TD>Set beam tilt direction for autofocusing to # (a value from 0 to 3)</TD>
        </TR>
        <TR>
          <TD class="auto-style1">OppositeAutofocus [#]</TD>
          <TD>In low dose mode, autofocus in area on opposite side of Record from the defined
            Focus area; if optional # is -1, just measure defocus without changing.&nbsp;
            Not available if Balance Shifts is on.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">FocusChangeLimits # #</TD>
          <TD>Set limits on the focus change during autofocus runs for the remainder of the
            script; follow with a negative and a positive number for the limits in microns.&nbsp;
            When an autofocus run exceeds a limit, it will abort and return to the starting
            defocus.&nbsp; Enter with 0 0 to cancel these limits.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">AbsoluteFocusLimits # #</TD>
          <TD>Set limits on the absolute focus reached during autofocus runs.&nbsp; Follow
            with a lower and a upper limit as given by ReportAbsoluteFocus, or 0 0 to cancel
            these limits.&nbsp; Autofocus will abort when a limit is exceeded.&nbsp; These 
            values will override the absolute limits that can be specificed through the 
            Focus menu, but a 0 0 will not prevent those limits from being applied.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportFocusDrift</TD>
          <TD>Report the drift estimate from the last autofocus, if available</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportAutofocus</TD>
          <TD>Report measured defocus from last autofocus, or whether it failed.&nbsp; The 
            defocus is placed into reportedValue1 and a failure code in reportedValue2 (1 
            for inconsistent focus, 2 for absolute limits exceeded, 3 for focus change 
            limits exceeded, or -1 for other error).</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportTargetDefocus</TD>
          <TD>Report the defocus target</TD>
        </TR>
        <TR>
          <TD class="auto-style1">FixAstigmatismByCTF [#M] [#L]</TD>
          <TD>Measure astigmatism by CTF fitting, report the stigmation change, and correct 
            for those values (or just measure, if the optional #M is nonzero).&nbsp; Image 
            shift is set to 0 unless the optional #L is non-zero.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">FixComaByCtf&nbsp; [#M] [#L] [#F]</TD>
          <TD>Measure beam-tilt misalignment by CTF fitting, report beam tilt change needed, 
            and correct for it (or just measure, if the optional #M is nonzero).&nbsp; Image 
            shift is set to 0 unless the optional #L is non-zero.&nbsp; The user setting for 
            whether to do a full array of images is used unless optional #F is 0 for 5 
            images &gt; 0 for a full array. </TD>
        </TR>
        <TR>
          <TD class="auto-style1">CorrectAstigmatism [#]</TD>
          <TD>Measure astigmatism by beam-tilt-induced displacements (BTID), report the stigmator values, and correct for those values 
            (or do not correct, if the optional # is -1)</TD>
        </TR>
        <TR>
          <TD class="auto-style1">CorrectComa [#]</TD>
          <TD>Measure beam-tilt misalignment by beam-tilt-induced displacements (BTID), report the estimated beam tilt, and correct to 
            bring beam tilt to zero. If the optional # is -1, it will simply measure the 
            misalignment once and report it without correcting it.&nbsp; If the # is 1, it 
            will do another iteration of estimating beam tilt and average the result with 
            the previous iterations.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportStigmatorNeeded</TD>
          <TD>Report the needed stigmator change in X and Y that was measured only, but not 
            imposed, after running &#39;FixAstigmatismByCTF 1&#39; or &#39;CorrectAstigmatism 1&#39;.&nbsp; 
            The last run of either astigmatism routine must be by one of these commands; 
            otherwise it will return 0 and 0.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportComaTiltNeeded</TD>
          <TD>Report the needed change in X and Y beam tilt that was measured only, but not 
            imposed, after running &#39;FixComaByCTF 1&#39;.&nbsp; If the last run of the coma 
            routine applied rather than just measured the tilt, it will return 0 and 0.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ZemlinTableau #T [#S] [#C]</TD>
          <TD>Make an array of 8 FFTs of beam-tilted images around a central FFT without 
            beam tilt.&nbsp; The first value #T specifies the beam tilt to use, in 
            milliradians on an FEI scope or percent of full scale on other scopes.&nbsp; The 
            optional entry #S sets the cropped size of each FFT in the array (default 340) 
            and #C sets the number of pixels to crop (default 170).&nbsp; See
            <a href="menu_focus.htm#hid_focus_zemlintableau">Beam-Tilted FFT Array</a> for other details.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportComaVsISmatrix</TD>
          <TD>Report the matrix computed from the
            <a href="menu_calibration.htm#hid_focustuning_comavs">Coma vs. Image Shift</a> 
            calibration.&nbsp; The 4 values are xpx, xpy, ypx, and ypy, where the change in 
            beam tilt for a given image shift (in IS units) is given by<br />
&nbsp; BTx = ISx * xpx + ISy * xpy<br />
&nbsp; BTy = ISx * ypx + ISy * ypy</TD>
        </TR>
        <TR>
          <TD class="auto-style1">AdjustBeamTiltforIS</TD>
          <TD>&nbsp;Adjusts beam tilt to compensate for the current image shift (as 
            displayed in the Scope Status panel), provided that the
            <a href="menu_calibration.htm#hid_focustuning_comavs">Coma vs. Image Shift</a> 
            calibration has been done.&nbsp; This command saves the current beam tilt, if it 
            has not been saved before in the script, and it will be automatically restored 
            when the script exits.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">CBAstigComa #T #C [#A] [#L] </TD>
          <TD>FOR TESTING: Runs the routine for astigmatism and coma by CTF fitting.&nbsp; Set #T 
            0 for astigmatism, 1 for coma with 5 images, 2 for coma with full array; #C 0/1 to measure/calibrate; #A 0 to apply a 
            measurement, 1 to just measure, 2 to measure from images in the buffers; #L 
            non-zero to 
            leave image shift as it is.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="low_dose"></A><B>Low Dose Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">GoToLowDoseArea area</TD>
          <TD>Switches to the low dose area given by 'area', which must be one of V, F, T, R,
            or S. This will not work if the screen is down.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetLowDoseMode #</TD>
          <TD>Turns low dose mode on for # nonzero or off for # 0; the previous state of low
            dose is saved in ReportedValue1 as a 0 or 1.&nbsp; This value can be assigned 
            to a variable at the end of the command.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportLowDose</TD>
          <TD>Report whether low dose is on or not and the current area, if it is defined.&nbsp;
            The number of the area (0 for V, etc.) is placed in ReportedValue2.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">UpdateLowDoseParams A [#K]</TD>
          <TD>Activates continuous update of the area given by &#39;A&#39; whenever necessary to 
              reflect changes made by the script to any of the parameters that are recorded 
              when &#39;Continuous update&#39; is on the Low Dose panel.&nbsp; Specifically, the area 
              is updated to the current parameters if it is the current area when this command 
              is given (thus recording changes made before this entry), and also updated 
              thereafter whenever one of the commands are used to change a relevant parameter.&nbsp; 
              Set the optional #K non-zero to keep the parameter changes when the script ends; 
              otherwise the parameters saved when this command is first given will be restored 
              on script end.&nbsp; A must be one of V, F, T, R, or S.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">SetLDAddedBeamButton [#]</TD>
          <TD>Turns the &#39;Set&#39; button in the Low Dose panel for recording additional beam shift 
              on, or turns it off if the optional # is 0.&nbsp; The original state of the 
              button will be restored on script end.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">RestoreLowDoseParams [A]</TD>
          <TD>Restores parameters saved for the given area when &#39;UpdateLowDoseParams&#39; was 
              entered for this area.&nbsp; Omit &#39;A&#39; to restore parameters for all areas, 
              including ones marked to be kept when the script ends.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">SetLDContinuousUpdate #</TD>
          <TD>Turns &quot;Continuous update&quot; in the Low Dose panel on if # is 
            non-zero or off if # is 0.&nbsp; Continuous update is not active while any script 
            is running.&nbsp; If it is on, microscope parameter changes will have no effect on
               Low Dose settings during a script, but when the script ends, changes will update
               the current Low Dose area.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">ReportAxisPosition F/T</TD>
          <TD>Reports the axis position in microns and the rotation of the inter-area axis, 
            for the Focus and/or Trial area as specified by F or T.&nbsp;The offset from center 
            of the camera acquisition subarea is also reported in unbinned pixels (in 
            left-handed camera coordinates).</TD>
        </TR>
        <TR>
          <TD class="auto-style1">SetAxisPosition F/T #D [#A]</TD>
          <TD>Modifies the axis position, and optionally the rotation of the inter-area 
            axis, for the Focus and/or Trial area.&nbsp; Follow with F or T to specify the 
            area (both will be changed if Focus and Trial settings are being kept 
            identical); with #D, the distance in microns; and optionally with #A, a rotation 
            angle.&nbsp; If an angle is set, the option to apply the angle will be turned on 
            in the Low Dose control panel.&nbsp; Low dose mode must be on to use this 
            command.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">CurrentSettingsToLDArea A</TD>
          <TD>Sets the parameters for low dose area A, which must be one of V, F, T, R, or S, 
              from the current microscope settings.&nbsp; It must be run while not in low dose 
              mode and after adjusting to scope state to the desired settings for the area.&nbsp; 
              It clears out the parameters for the area, enters low dose mode, and goes to the 
              area so that it is assigned the current state.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="task_commands"></A><B>Task-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ResetImageShift [#B] [#R]</TD>
          <TD>Reset image shift and move stage to compensate.&nbsp; Follow with a 1 or 2 for 
            the optional B to move the stage so as to retain or impose backlash, even if the user has not 
            selected the option to do so in the Image Alignment &amp; Focus control panel.&nbsp; 
            With a value of 2, it will relax from the stage movement by the amount given in 
            the optional R, or by the value of the StageRelaxation property (0.025 by 
            default).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ResetShiftIfAbove #</TD>
          <TD>Reset image shift and realign image if image shift is greater than the given #
            in microns</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">Eucentricity [#]</TD>
          <TD>Refine eucentricity, or if optional # is entered, do rough eucentricity only
            (1), refine only (2), both steps (3), or refine and realign (6)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportLastAxisOffset</TD>
          <TD>Reports the total lateral offset of the tilt axis estimated from the last Refine 
            Eucentricity run; aborts the script if no offset is available.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">WalkUpTo #</TD>
          <TD>Tilt up to given angle in steps and track image position</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReverseTilt [#]</TD>
          <TD>Work out backlash and realign image after reversing tilt direction; enter
            optional 1 or -1 to specify a specific direction for further tilts</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">RefineZLP [#]</TD>
          <TD>Report time of day and run Refine Zero Loss Peak procedure.&nbsp; If the 
            optional # is entered with an interval in minutes, the procedure is not run if 
            the time since the last run is less than that interval.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">AutocenterBeam [#]</TD>
          <TD>Start the Beam Autocenter routine.&nbsp; The optional # sets a maximum 
            beam shift in microns; the beam will not be moved if the shift determined 
            from the circle fit to the beam edges exceeds this value.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">CookSpecimen</TD>
          <TD>Run the Specimen Cooker routine</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">WaitForDose #d [#r]</TD>
          <TD>Start accumulating dose and wait until it reaches the given #d in electrons per
            square Angstrom. Enter the optional #r to set how many times it reports
            progress while waiting (default is 10). Be sure that the screen is down and, if
            in low dose, that the beam is unblanked.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">CenterBeamFromImage [#C] [#M]</TD>
          <TD>Center beam using the existing image in the active buffer by detecting the
            edges of the beam, or from the centroid of the image intensities if #C is
            nonzero. In the latter case the beam should be completely within the camera
            field.&nbsp; The optional #M sets a maximum beam shift in microns; the beam will
            not be moved if the shift determined from the circle fit to the beam edges 
            exceeds this value.&nbsp; Sets reportedValue1 to -1 if no beam edges are detected,
            5 if there is a failure fitting edges to a circle, 6 if beam was not moved because
            the radius was too high, and 7 if the beam was not moved because the fitting error was too high.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">MeasureBeamSize [#B]</TD>
          <TD>Measures the beam diameter by detecting its edges in the image in buffer A, or in 
            the buffer given by the optional #B.&nbsp; The value is reported in microns.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">DriftWaitTask [#R] [U] [#M] [#I] [#G] [T] [#C] [#E] [#B]</TD>
          <TD>Runs the Wait for Drift task using parameters set in the 
            <a href="hidd_driftwaitsetup.htm">Wait for Drift Setup dialog</a> if there are no 
              optional entries.&nbsp; Any optional entry that is not zero overrides the 
              parameter set in the dialog; enter a 0 to use the dialog setting for any 
              parameter.&nbsp; The parameters are: #R for target drift rate; U nm or A; #M for maximum time to wait in sec; #I for 
              interval over which drift is measured in sec; #G 1 
              to generate an error when maximum time reached or -1 not to; T for type of 
              measurement (T for Trial, F for Focus, A for 
              within autofocus runs, or 0 for dialog setting); #C to correct drift with image 
              shift; #E for Trial exposure, #B for Trial binning.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">GetWaitTaskDrift</TD>
          <TD>Places the final drift measurement from the last Wait for Drift task into 
              reportedValue1 and a non-zero number if the task failed in reportedValue2.
              Values can be assigned to variables after command.
              Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ConditionPhasePlate [#]</TD>
          <TD>Run the routine to condition a phase plate using parameters set in the 
            <a href="hidd_vpp_expose_setup.htm">Phase Plate Conditioning Setup dialog.</a>
            &nbsp; If the optional # is non-zero, it will move to the next phase plate position 
            first, provided this is supported by scripting on the microscope.&nbsp; Command added in 3.8, 11/17/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">MultipleRecords [#N] [#C] [#O] [#D] [#S] [#E] [#F] [#H]</TD>
          <TD>Acquire multiple Record images around the periphery of a hole, using image 
            shift to move to each off-center position.&nbsp; The parameters set in the 
            <a href="hidd_multi_shot_setup.htm">Multiple Record Setup dialog</a> control the 
            operation of this task, but any subset of them can be overridden by entering 
            optional parameters here.&nbsp; The value in the dialog is used if -9 is entered 
            for the corresponding parameter here, or if the optional entries end before the 
            given parameter.&nbsp; The parameters are: #N for number of shots around the 
            center; #C -1 or 1 for a shot in the center before or after the off-center 
            shots; #O for the distance from center of the off-center shots, in microns; #D 
            for the extra delay after the image shift, in seconds; #S 1 to save a Record 
            image at each position or 0 not to; #E 1 or 2 to use early return for a K2/K3 
            camera after the last shot or after all shots; #F for the number of frames in 
            the early returned image (or -1 for all, 0 for none); #H the sum of 1 to do 
            shots around a center (within a hole) and 2 to do shots in multiple holes or 
            specified positions.&nbsp; (In addition, the sum in #H can include 4 for testing 
            image locations or 8 for testing the coma correction.) For example, 
            &#39;MultipleRecords -9 -9 -9 4. 1&#39; will use an extra delay of 4 seconds and save 
            Records, but take all other parameters from the dialog.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">TestNextMultiShot #</TD>
          <TD>Set a variable so that the next MultipleRecords command will test image 
            location by acquiring a Record or montage at each location (if # is 1) or by 
            measuring coma at each location (if # is 2).&nbsp; See
            <a href="hidd_multi_shot_setup.htm#testing">Testing Image Location and Coma Adjustment</a> for details on 
            this testing.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">StageToLastMultiHole</TD>
          <TD>Move the stage to the center of the last hole position acquired with 
              MultipleRecords.&nbsp; This command can be used to position over a hole for 
              occasional post-acquisition tasks when using a hole pattern centered on the 
              support film.&nbsp; There is no backlash correction.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ImageShiftToLastMultiHole</TD>
          <TD>Change image shift by the offset to the last hole position acquired with 
              MultipleRecords.&nbsp; This command combined with &#39;ResetImageShift&#39; will be more 
              accurate than &#39;StageToLastMultiHole&#39; if backlash correction is needed and 
              enabled in the Image Alignment &amp; Focus control panel.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">CalibrateImageShift [#]</TD>
          <TD>Calibrate image shift at the current mag. Do the calibration from scratch if
            the optional # is nonzero.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ShiftCalSkipLensNorm [0]</TD>
          <TD>Keeps projector lens normalization from being done before the next image or 
            stage shift calibration provided that normalization was last done at the current 
            magnification.&nbsp; Follow with an optional 0 to NOT skip normalization.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">FindPixelSize</TD>
          <TD>Run the routine to find the pixel size in an image of a cross-line grating.</TD>
        </TR>
        <TR>
          <TD class="auto-style1">QuickFlyback set# #e</TD>
          <TD>Run the camera timing calibration routine in quick flyback mode for an FEI
            STEM camera, where 'set#' specifies the camera parameter set and must be V, F,
            T, R, or P, and #e is the exposure time to use.&nbsp; The routine will not ask for
            confirmation before saving the resulting flyback time and startup delay in the
            master list of flyback times.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ShiftImageForDrift # # #</TD>
          <TD>Apply image shift during the next exposure to compensate for a drift in X and Y
            given by the first and second numbers; the third number should be 0 if the
            drift is in unbinned pixels/sec and 1 if it is in nm/sec</TD>
        </TR>
        <TR  vAlign="top">
          <TD colspan="2"><A name="navigator"></A><B>Navigator-Related Commands</B></TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportIfNavOpen</TD>
          <TD>Report whether the Navigator is open; sets reportedValue1 to 1 if it is open 
            and 2 if there is a Navigator file defined 2.&nbsp; Virtually all of the commands 
            described in this section will generate an error if the Navigator is not open.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">NewMap [#n&nbsp; text]</TD>
          <TD>Make the current image or montage a new Navigator map.&nbsp; If an optional #n 
            is entered, text after that replaces, or is added to, the standard note for a 
            map.&nbsp; The text replaces the standard note if #n is 0, is added before it if 
            #n is &lt; 0, or is added after it if # &gt; 0.&nbsp; Places the index of the 
            new map in reportedValue1.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">MakeAnchorMap</TD>
          <TD>Calls the routine to make an anchor map and does the same tests and operations 
            as when run from the button in the dialog, including saving the current image 
            and making it a map if it is not already.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">MoveToNavItem [#]</TD>
          <TD>Move the stage to a Navigator item; if no # is entered, move to the current
            Navigator item or to the item that this script is being run on, otherwise move
            to the item whose index in the table is # (numbered from 1)</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">RealignToNavItem #r [#c] [#s #n #z]</TD>
          <TD>Realign to the current Navigator item, or to the item that this script is being
            run on. For #r, enter 1 to restore the microscope state to the current state
            after the procedure, or 0 not to.&nbsp; For optional #c, enter 1 to use
            continuous acquisition mode and end it at end of procedure, or 2 to leave it
            running if possible. The three optional entries #s, #n, #z control the resetting 
            of image shift at the end of the procedure when aligning a single map at one 
            magnification.&nbsp; It will reset image shift and move the stage to compensate, 
            realigning with a new image up to #n times and if the starting shift is more 
            than the criterion #s.&nbsp; Enter 0 or 1 for #z to end with nonzero or zero 
            image shift, respectively, i.e. with the image realigned or with a final image 
            shift reset and stage movement.&nbsp; This procedure occurs only if realignment 
            is to a single map.&nbsp; All three values must be entered if any are, plus a 
            value for #c.&nbsp; An entry of 0 for #n and 1 for #z will make it move the 
            stage to the target position and skip the regular realignment there.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">RealignToOtherItem #i #r [#c] [#s #n #z]</TD>
          <TD>Realign to the Navigator item whose index in the table is #i, numbered from 1.
            For #r, enter 1 to restore the microscope state to the current state after the
            procedure, or 0 not to.&nbsp; For optional #c, enter 1 to use continuous
            acquisition mode and end it at end of procedure, or 2 to leave it running if
            possible.&nbsp; Entries for #s, #n, and #z control image shift reset when 
            aligning to a single map, as decribed for &#39;RealignToNavItem&#39;.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">RealignToMapDrawnOn #i #r</TD>
          <TD>Center on the specified item by first realigning to the map that the item was drawn
              on, then using image shift to center on the marked item.&nbsp;  The specified item
              must have been drawn on a higher-magnification map that can be aligned to in two rounds
              using some lower mignification map, such as an anchor map.  For #i, enter 0 for
              the current item or the item being acquired; an index greater than 0 for the item with
              that index in the table; or a value less than 0 to count back from the end of the 
              table, where -1 is the last item.  For #r, enter 1 to restore the microscope state
              to the current state after the procedure, or 0 not to.&nbsp; Command added in 3.8.
          </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">GetRealignToItemError</TD>
          <TD>Gets the total stage error in X and Y and the second move error in X and Y from 
              the last Realign to Item and assigns them to ReportedValue1-4 and to optional 
              variables included after the command.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ForceCenterRealign</TD>
          <TD>Makes Realign to Item align to the map center instead of skipping the first
            round because it was aligned to recently.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ShiftItemsByAlignment</TD>
          <TD>Shift items at the current registration by the alignment shift of the image in
            buffer A. If rerun on the same image, it applies the change in shift between
            the current and previous run.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ShiftItemsByCurrentDiff #</TD>
          <TD>Shift items at the current registration by the difference between the current 
            stage position and the recorded position of the current Navigator item or the 
            item that this script is being run on.&nbsp; The shift is done only if the 
            difference is less than the # in microns.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ShiftItemsByMicrons #x #y [#r]</TD>
          <TD>Shift items at the current registration, or at the registration given by the 
            optional #r, by the amount in microns in #x and #y.&nbsp; Each component of the 
            shift must be less than 100 microns.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">UpdateItemZ</TD>
          <TD>Assign current stage Z value to the current Navigator item, or item that this
            script is being run on.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">UpdateGroupZ</TD>
          <TD>Assign current stage Z value to the whole group that the current Navigator
            item, or item that this script is being run on, belongs to. The item must have a
            non-zero group ID. If the group would show up on more than one line with
            'Collapse groups' on, items on all lines will be updated, unlike with the
            'Update Z' button.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">LoadNavMap</TD>
          <TD>Load the current Navigator item, or the item this script is being run on, if 
            it is a map.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">LoadOtherMap #</TD>
          <TD>Load the Navigator item whose index in the table is #, if it is a map; ; or if 
            # is negative, load the item that many items from the end of the table, i.e., 
            -1 loads on the last item. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportNavItem</TD>
          <TD>Report the index, stage X, Y, Z, label, and note string for the current 
            Navigator item, or the item this script is being run on. The index and stage 
            coordinates are placed in &#39;reportedValue&#39; variables as usual, and the item type 
            is placed in &#39;reportedValue5&#39; (0 for point, 1 for polygon, 2 for map). In 
            addition, variables &#39;navLabel&#39;, and &#39;navNote&#39; are set with the label and note 
            strings, variables 'navIndex' and 'navIntLabel' are set with integer values
            of the item index (numbered from 1) and of the label (up to any non-numeric characters), 
            variable &#39;navRegis&#39; is set with the item&#39;s registration value, and 
              variable &#39;navColor&#39; is set with the item&#39;s color (a value from 0 to 5).
            If the Navigator is currently acquiring at points, a variable &#39;navAcqIndex&#39; is
            set with the number of items already acquired plus 1.&nbsp; Any of
            these variables can then be used to make filenames, and the latter two can be
            used in arithmetic and IF statements.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportOtherItem #</TD>
          <TD>Report similarly on the Navigator item whose index in the table is #, numbered 
            from 1; or if # is negative, reports on item that many items from the end of the 
            table, i.e., -1 reports on the last item. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportNextNavAcqItem</TD>
          <TD>Report similarly on the next Navigator item to be acquired.&nbsp; The 
            Navigator must be acquiring.&nbsp; If the last item is being acquired, navIndex 
            is set to -1.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportGroupStatus</TD>
          <TD>For the current Navigator item or the item this script is being run on, 
            reports a code for whether the item is first to be acquired in a group: -1 if 
            Navigator not acquiring, 0 if not in a group, 1 if first to be acquired in a 
            group, 2 if later in the group. If the group would show up on more than one line 
            with &#39;Collapse groups&#39; on, a value of 1 is returned for the first item to be 
            acquired in each subgroup.&nbsp; It also reports the group ID of the item&nbsp; (ID is 0 
            for an item not in a group), the total number in the group, and the number in 
            the group still marked for acquisition.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportNumNavAcquire</TD>
          <TD>Report the number of Navigator marked for Acquire and marked for Tilt Series 
            as two values; return each as -1 if Navigator is not open.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportItemAcquire [#]</TD>
          <TD>Report the Acquire state of the Navigator item whose index in the table is #,
            numbered from 1; or if # is negative, reports on item that many items from the
            end of the table, i.e., -1 reports on the last item, or if no # is specified of
            the current item. Command added in 3.8. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetItemAcquire [#a] [#i]</TD>
          <TD>Enables or disables Acquire for a Navigator item: if #a is 0, Acquire is disabled,
            if this parameter is not specified or nonzero, Acquire becomes enabled. The item index
            is specified by #i (see also ReportAcquire), if no #i is specified the current item is
            changed. This command may not be used from within a running acquisition. Command added
            in 3.8. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportNumTableItems</TD>
          <TD>Report the number of items in the Navigator table.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">NavIndexWithLabel str</TD>
          <TD>Report the index in the Navigator table of the item whose label is the given 
            string, or 0 if there is none.&nbsp; Sets reportedValue1 with the index.&nbsp; 
            The string can contain spaces and the comparison is not case-sensitive.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">NavIndexWithNote str</TD>
          <TD>Report the Navigator index of the item whose note is the given string, 
            otherwise just like ItemIndexWithLabel.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">NavIndexItemDrawnOn #</TD>
          <TD>Report the Navigator index of the map that the specified item was drawn on, 
              or 0 if it was not drawn on a map.  For #, enter 0 for
              the current item or the item being acquired; an index greater than 0 for the item with
              that index in the table; or a value less than 0 to count back from the end of the 
              table, where -1 is the last item.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">NavItemFileToOpen #</TD>
          <TD>Report the name of the file set to be opened for the specified Navigator item.&nbsp; 
            Sets reportedValue1 to the filename or to 0 if there is none.&nbsp; For #, enter 0 for
              the current item; an index greater than 0 for the item with
              that index in the table; or a value less than 0 to count back from the end of the 
              table, where -1 is the last item.&nbsp; The command will not work for the item
            being acquired, as the stored name is cleared out when the file is opened.
            &nbsp; Command added in 3.8, 11/29/19.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetNavRegistration #</TD>
          <TD>Set the current registration of the Navigator window to the given number.&nbsp; 
            No item registration values are changed.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ChangeItemRegistration #i #r</TD>
          <TD>Change the registration number of the Navigator item with table index #i to 
            #r.&nbsp; This works just like the Navigator menu entry
            <a href="menu_navigator.htm#hid_navigator_changeregistration">Change 
            Registrationn</a>: the registration number must be in the legal range,the item 
            cannot be a registration point, and you cannot change an item between imported 
            and regular registrations.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ChangeItemColor #i #c</TD>
          <TD>Change the color index of the Navigator item with table index #i to #c, which 
            must be between 0 and 5.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ChangeItemLabel #i text</TD>
          <TD>Change the label of the Navigator item with table index #i to the given text.&nbsp; 
            The text is limited to 16 characters; items with labels longer than 10 
            characters will not display their properties in the right columns in the table. </TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ChangeItemNote #i [text]</TD>
          <TD>Change the note of the Navigator item with table index #i to the given text or
            deletes the note if text is not specified. Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ItemForSuperCoord #</TD>
          <TD>Set the item number that Navigator supplies supermontage coordinates from when
            a montage image is acquired. Set the number to 0 to restore Navigator to using
            coordinates from the item currently being acquired.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SkipPiecesOutsideItem #</TD>
          <TD>Sets the current montage to skip pieces outside the Navigator item whose
            position in the table is # (numbered from 1). If # is 0, uses the current item.
            If # is &lt; 0, disables the skipping of pieces.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SuffixForExtraFile</TD>
          <TD>Sets one or more suffixes so that the Acquire at Items routine will open the 
            corresponding number of extra files whenever it opens a regular file for 
            output.&nbsp;Follow with the suffices, separated by spaces (and thus a suffix cannot 
            contain a space). The name of each extra file 
            will be the root of the regular filename, plus the suffix, followed by the 
            extension of the regular filename.&nbsp; The extra files will be opened before 
            the regular file.&nbsp; They will be closed when the regular file is closed (at 
            the end of acquisition or before opening a new file).</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SkipAcquiringNavItem</TD>
          <TD>Tells the Navigator to skip the current item and move on to the next.&nbsp; 
            This command has an effect only when included in a script being run as a 
            preliminary action before the main action.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SkipAcquiringGroup [ID]</TD>
          <TD>Tells the Navigator to skip points whose group ID match either the group ID of 
            the current acquire item, or the optional ID entered with the command.&nbsp; The 
            Navigator must be acquiring at points.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SkipMoveInNavAcquire [#]</TD>
          <TD>Tells the Navigator to enable skipping the initial stage move for each 
            following item to be acquired.&nbsp; This command is allowed only when the 
            Navigator is already acquiring at items.&nbsp; It does not affect the user&#39;s 
            selection in the Acquire at Items dialog for whether to skip this stage move.&nbsp; 
            Thus a script that is going to use Realign to Item on each point can skip the 
            stage move and there is no need for the user to make this selection.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">StartNavAcquireAtEnd</TD>
          <TD>Starts the Navigator Acquire at Items operation after the script ends 
            successfully, using the parameters last defined in the
      <A HREF="hidd_navacquire.htm">Navigator Acquire</A> dialog.&nbsp; The command cannot 
            be used when Navigator is already acquiring or a tilt series is running.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SaveNavigator</TD>
          <TD>Saves the Navigator data to the current file or opens a file chooser for 
            saving if a file is not yet defined.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReadNavFile name</TD>
          <TD>Reads in the Navigator file with the given name, opening the Navigator if 
            necessary.&nbsp; If there are unsaved changes in the Navigator, the user is 
            asked whether to save those first as usual.&nbsp; A cancel from that, or an 
            error opening, reading, or processing the file will generate an error message.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">MergeNavFile</TD>
          <TD>Merges the Navigator file with the given name into the current items in the 
            Navigator, which must be open.&nbsp; An error opening, reading, or processing the 
            file will generate an error message.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">ReportNavFile [#]</TD>
          <TD>Reports the name of current Navigator file or generates an error if the 
            Navigator is not open with a file defined.&nbsp; Sets the full name into 
            ReportedValue1; or if the optional # is entered with a 1, sets the root of the 
            filename including the path in ReportedValue1, the extension (including the dot) in 
            ReportedValue2, the path only in ReportedValue3, and the rest of the rootname 
            in ReportedValue4.&nbsp; No optional assignment to variable.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">SetMapAcquireState #</TD>
          <TD>Sets the state with which the specified map item was acquired.&nbsp; For #, 
              enter 0 for the current item or the item being acquired; an index greater than 0 
              for the item with that index in the table; or a value less than 0 to count back 
              from the end of the table, where -1 is the last item.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD class="auto-style1">RestoreState</TD>
          <TD>Restore the state if one has been saved with either with 'SetMapAcquireState' or 
              the <A HREF="hidd_statedlg.htm">Imaging States dialog</A>.&nbsp; Command added in 3.8. </TD>
        </TR>
      </TABLE>
      <BR>
      <P><A name="miscellaneous"></A><B>Miscellaneous Commands</B></P>
      <TABLE border="1" cols="2">
        <TR vAlign="top">
          <TD width="210">CircleFromPoints x y x y x y</TD>
          <TD>Report the X and Y center coordinate and the radius in microns for the circle
            through three points whose coordinates are given on the line as x1 y1 x2 y2 x3
            y3..&nbsp; Values can be assigned to variables at end of command.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ReportClock</TD>
          <TD>Report seconds elapsed since last ResetClock command</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ResetClock</TD>
          <TD>Reset the time reported by ReportClock to 0</TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">ReportMinuteTime</TD>
          <TD>Report an absolute time in minutes, a large integer. The difference between
           two such values will give an elapsed time in minutes.  If a variable name is
           included after the command, the value will automatically be assigned to a 
           persistent variable so that it is available across multiple runs of the script.
          </TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">SetCustomTime name [#M]</TD>
          <TD>Store an absolute time in minutes in a 'custom time' with the given name.&nbsp; The current time is stored, or the time given by the optional #M.&nbsp; 
              Custom times are stored in the short-term calibration file, like the times 
              since the last long operations of various kinds.&nbsp; They can be used to 
              perform actions periodically during Navigator acquisitions.&nbsp; ENtries older 
              than 20000 minutes will be removed when the file is read on program startup.&nbsp; Command added in 3.8.</TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">ReportCustomInterval name [#M]</TD>
          <TD>Report the time elapsed, in minutes, from the custom time with the given name to either 
              the current time or the absolute time in minutes given by optional #M.&nbsp; If 
              a time with that name has not be set, an interval of 40000 is returned.
            &nbsp; No optional assignment to variable.&nbsp; Command added in 3.8.
          </TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">ReportTickTime</TD>
          <TD>Report the time in seconds since the program started, like the times that 
            prefix program debug output. The difference between two such values will give an 
            elapsed time in seconds with nominal millisecond precision, as long as the 
            program has been running for fewer than 50 days. If a variable name is included 
            after the command, the value will automatically be assigned to a persistent 
            variable so that it is available across multiple runs of the script.
          </TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">ElapsedTickTime start</TD>
          <TD>Report the time in seconds since the tick time given in &#39;start&#39;, which should 
            be a variable assigned with the result from &#39;ReportTickTime&#39;.&nbsp; This command 
            should be used to measure intervals between tick times if there is any chance 
            that the program will run for more than 50 days.&nbsp; The value can be assigned 
            to a variable at the end of the command.</TD>
        </TR>
         <TR vAlign="top">
          <TD width="210">ReportDateTime</TD>
          <TD>Report a numeric date in the form YYYYMMDD and a time to the minute in the form
              HHMM.&nbsp; Command added in 3.8.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ProgramTimeStamps</TD>
          <TD>Print the program version and build date, and the current date and time.</TD>
        </TR>
        <TR>
          <TD width="207">Plugin name func [args]</TD>
          <TD>Call&nbsp;the function 'func' in the plugin named 'name' with&nbsp;appropriate
            list of arguments for that function.&nbsp; Arguments are entered as items
            separated by spaces, except that a string argument at the end may consist of
            multiple words.&nbsp; The return value of the function is reported and placed
            into reportedValue1.</TD>
        </TR>
        <TR>
          <TD width="210">ListPluginCalls</TD>
          <TD>List the names of script-callable functions in all loaded plugins along with the
            arguments that they expect, in parentheses.&nbsp; For each argument, there
            should be one item provided on the command line calling the function, with all
            items separated by spaces as usual.&nbsp; Two exceptions to this are: a string
            argument at the end can include spaces; an argument listed as [out]double is a
            returned value, assigned to reportedValue2 or higher.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">MailSubject text</TD>
          <TD>Subject line for an email message (default is 'Message from SerialEM script').
            The text can include variables to be substituted.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">SendEmail text</TD>
          <TD>Send an email containing the given text, which can include variables to be
            substituted. An SMTP server and address to send from must be defined in the
            properties file, and recipient(s) must be defined using 'Set Email Address' in
            the Tilt Series Menu.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ErrorBoxSendEmail text</TD>
          <TD>Send an email containing the given text if the script stops with a message box; 
            the text can have variables to be substituted.&nbsp; Requirements are the same 
            as for &#39;SendEmail&#39;.&nbsp; If the message box occurs during Navigator Acquire at 
            Items and the user has selected to send emails there, two emails will be sent, 
            thus allowing more specific information from the one specified here.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">RunInShell command</TD>
          <TD>Run the given command with the system command processor.&nbsp; It appears that 
            any command that will run in a Command Prompt window can be run.&nbsp; Thus 
            commands can include: &#39;|&#39; to pipe from one program to another; &#39;&amp;&#39; to run 
            successive programs unconditionally; &#39;&amp;&amp;&#39; or &#39;||&#39; to run successive programs 
            conditionally; &#39;&gt; outfile&#39; to redirect standard output to a file, &#39;2&gt; errfile&#39; 
            to redirect standard error output to a file, or &#39;&gt; outfile 2&gt;&amp;1&#39; to redirect 
            both to one file.&nbsp; Single arguments like filenames that contain spaces 
            should be enclosed in double quotes.&nbsp; The exit status of the command will 
            be placed in ReportedValue1; if it is -1, this indicates an error in before 
            running the command, and ReportedValue2 will be set with the following values: 1 
            if argument list too big, 2 or 3 if command interpreter cannot be found or is 
            not executable, 4 for insufficient memory or other memory problem, 5 for 
            unidentified error.&nbsp; In any case, a non-zero exit status will not be 
            considered a script error, and you need to test for failure explicitly. These 
            error codes are not very helpful - it seems that the exit status is 1 if the 
            command cannot be found or cannot be started, so if you want to pass information 
            back with the exit status, you cannot use a 1, and might want to use a value 
            besides 1 for failure of the operation to distinguish it from failure to run the 
            command.&nbsp;&nbsp; If STOP is used while the command is running, the script 
            will stop and the thread that is running the command will be killed, but the 
            command will keep running.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">CreateProcess command</TD>
          <TD>Start the program given by 'command' without waiting for it to finish, using 
            the argument list defined previously with the 'NextProcessArgs' command.&nbsp; 
            See <a href = menu_tools.htm>The Tools Menu and Running External Commands</a> 
            for a description of the rules governing this command.</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">NextProcessArgs arg arg...</TD>
          <TD>Set arguments for the next process run with 'CreateProcess' or 'RunExternalTool'.&nbsp; The argument 
          list can contain script variables that are substituted, as well as several keywords
          that are replaced with path entries. &nbsp;See <a href = menu_tools.htm>The Tools
           Menu and Running External Commands</a> for a description of these keywords and
           the rules governing the arguments entry. The arguments are
          used up by running the process and must be defined with this command each time a 
          process is run. </TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">RunExternalTool #N</TD>
          <TD>Run an external tool shown in the Tools menu, where N is either the number of
            the tool in the Tools menu, numbered from 1, or the full name of the tool in the menu.
            If arguments were set with 'NextProcessArgs', they will be included when running the command.</TD>
        </TR>
       <TR vAlign="top">
          <TD width="210">ExternalToolArgPlace #</TD>
          <TD>Specify whether arguments set with 'NextProcessArgs' should be placed before 
            (-1 for #) or after (1 for #) the arguments defined for an external tool in the
             properties file, or replace the defined arguments (0 for #).  The default is 0 
            and a setting is retained for the duration of the script.&nbsp; Command added in 3.8, 12/7/19</TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ReportProperty name</TD>
          <TD>Use this command to report the value of one program property.&nbsp; The command can 
            be used with nearly all of the general (non-camera-specific) properties that 
            contain just a single numeric entry and can be set by name in 
            SerialEMproperties.txt.&nbsp; Follow with the full name of the property (case 
            insensitive) and with an optional variable name for the value.&nbsp;An error will 
            result if the name does not match one of the properties that can be reported.&nbsp; 
            The list of available properties in the development version of SerialEM is in
            <a href="http://bio3d.colorado.edu/ftp/SerialEM/Scripts/ScriptableProperties.txt">
            http://bio3d.colorado.edu/ftp/SerialEM/Scripts/ScriptableProperties.txt</a></TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">SetProperty name value</TD>
          <TD>Use this command to set the value of one program property.&nbsp; This works just 
            like &#39;ReportProperty&#39;.&nbsp; Follow with the full name of the property (case 
            insensitive) and with its new value.&nbsp; </TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">ReportUserSetting name   <TD>Use this command to report the value of one user setting, using the name for 
            it in SerialEMsettings.txt.&nbsp; The command can be used with nearly all of the 
            general (non-camera-specific) settings that contain just a single numeric entry.&nbsp; 
            Follow with the full name of the setting (case insensitive) and with an optional 
            variable name for the value.&nbsp; An error will result if the name does not match 
            one of the settings that can be set.&nbsp; The list of available settings in 
          the development version of SerialEM is in
          <a href="http://bio3d.colorado.edu/ftp/SerialEM/Scripts/ScriptableSettings.txt">http://bio3d.colorado.edu/ftp/SerialEM/Scripts/ScriptableSettings.txt</a></TD>
        </TR>
        <TR vAlign="top">
          <TD width="210">SetUserSetting name val [#K]</TD>
          <TD>Use this command to set the value of one user setting.&nbsp; This works just 
            like &#39;ReportUserSetting&#39;.&nbsp; Follow with the name of the setting and its 
            value.&nbsp; The original value is automatically restored when the script stops 
            unless the optional entry K is non-zero to keep the setting.&nbsp; If the script 
            is suspended, the new value will be set again when it is resumed.&nbsp; Multiple 
            changes in the same setting can be done; the original value or last kept new 
            value will be restored when the script stops, and the latest new value will be 
            set on resume.</TD>
        </TR>
      </TABLE>
    <P><A NAME="arithForArgs"></A><B>Commands Allowing Arithmetic Expressions for Arguments</B></P>
      In addition to the commands starting with 'Set', these commands
    allow arithmetic arguments:
    <pre>
AbsoluteFocusLimits
BackgroundTilt
BeamTiltDirection
ChangeEnergyLoss
ChangeFocus
ChangeIntensityBy
ChangeItemRegistration
ChangeMag
ChangeMagAndIntensity
CircleFromPoints
CropImage
CtfFind
Delay
EarlyReturnNextShot
EchoEval
EchoNoLineEnd
EchoReplaceLine
ElapsedTickTime
ExposeFilm
FocusChangeLimits
FrameThresholdNextShot
ImageShiftByMicrons
ImageShiftByPixels
ImageShiftByUnits
IncPercentC2
IncTargetDefocus
LongOperation
ManualFilmExposure
MoveBeamByFieldFraction
MoveBeamByMicrons
MovePiezoXY
MovePiezoZ
MoveStage
MoveStageTo
MultipleRecords
PreCookMontage
QuickFlyback
RecordAndTiltTo
ReduceImage
RelaxStage
ResetShiftIfAbove
SetSlitIn
ShiftItemsByMicrons
SmoothFocusNextShot
SpecialExposeFilm
StageShiftByPixels
StepFocusNextShot
SubareaMean
TestRelaxingStage
TestSTEMshift
TiltBy
TiltDuringRecord
TiltTo
UpdateHWDarkRef
WaitForDose
WaitForMidnight
WalkUpTo
ZemlinTableau</pre>
    </basefont>
  </BODY>
</HTML>

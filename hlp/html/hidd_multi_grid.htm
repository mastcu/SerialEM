<html>
  <head>
    <title>Multiple Grid Operations Dialog</title>
    <meta HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"/>
    <style type="text/css"> <!-- BODY { font-family:"Arial" }
  TD { font-size:16 }
      .style1
      {
        font-size: larger;
        font-weight: bold;
      }
      --></style>
  </head>
  <body BGCOLOR="#ffffff" TEXT="#000000">
    <basefont size="2">
    <p><a NAME="hidd_multi_grid"></a><span class="style1">Multiple Grid Operations
        Dialog</span></p>
 <p>   <a HREF="#intro">Introduction</a><br>
    <A HREF="#setup">Grid Setup and the Grid Table</a><br>
    <A HREF="#gridActions">Grid Actions</a><br>
    <A HREF="#gridMaps">Acquire Grid Maps</a><br>
    <A HREF="#mediumMag">Acquire Medium Mag Maps</a><br>
    <A HREF="#finalAcq">Run Final Acquisition</a><br>
    <A HREF="#running">Running the Grids, Errors, Pausing, Stopping</a><br>
</p>
    <P><a NAME="intro"></a>
      <em><strong>Introduction</strong></em></P>
   <p>This dialog provides for acquisition from multiple grids using an autoloader.&nbsp; 
      The operations can occur in three phases: acquisition of grid maps at low 
      maginification, acquisition of medium magnification maps using the 'Mapping' 
      parameters of the Navigator Acquire at Items dialog, and acquisition of final 
      data with the 'Final Data' parameters of Acquire at Items.&nbsp; Navigator files 
      are managed throughout the process.&nbsp; Information about the grids and some 
      of the parameter settings are saved automatically in a 'session' file in the 
      autodoc format, with a name of the form 'multiGrid_date_#.adoc', saved into the 
      top working directory for all the files from the runs.&nbsp; The dialog has 
      controls in different sections that can be closed when not relevant, and a
      <strong>Close Right</strong> button at the bottom that can be used to show just the grid 
      table and none of the sections on the right.&nbsp; The +/- button at the upper 
      left can be used to close up or reopen the whole dialog area.</p>
    <p><em>Use of states:</em> In principle, the multiple grid capabilities provided here allow all phases to 
      be done in sequence during one run on a set of grids.&nbsp; The use of imaging 
      states is crucial to being able to run more than one phase at a time with 
      predictable results.&nbsp; The dialog thus includes drop-down boxes with all of 
      the states managed in the Imaging State dialogs.&nbsp; For states with names, 
      the boxes show the state index, the type of state, a 0 if the camera is not 
      currently available, the magnification, and the name.&nbsp;&nbsp; The type can 
      be S, V, R, F, T, or - as in the Imaging States dialog, plus RM for a Low Dose 
      state or -M for a non-Low Dose state that sets Mont-map parameters.&nbsp; For 
      states without names, the box shows the index, type, camera number or 0 if not 
      available, magnification, and spot/probe mode.&nbsp; For grid mapping, only one 
      state can be selected, one directly related to the camera parameter set to be 
      used for the montage.&nbsp; For medium magnification mapping and final 
      acquisition, four states can be selected because up to 5 states can be set in 
      Low Dose and because one can imagine needing three for doing related tasks plus 
      the primary acquisition.&nbsp; If a non-Low Dose state is selected, only one 
      state can be set.&nbsp; The program will reject selections that are inconsistent 
      or redundant, such as selecting a non-Low Dose state when acquiring with View or 
      Search.&nbsp; The controls in the Imaging State dialog for deleting, 
      updating, or renaming an existing state are disabled while the multi-grid dialog 
      is open.&nbsp; If you need to change these settings, just close and reopen this 
      dialog.</p>
    <p><em>Need for reference counts:</em> The first time that the procedure is run on a set of grids, the routine needs 
      to collect an image similar to those which will be taken for the grid map, but 
      with an unobstructed beam.&nbsp; This is necessary to allow proper evaluation of 
      whether a grid is too dark overall, and to pick optimal locations for finding 
      eucentricity and for realigning to the grid map.&nbsp; Thus, it has to unload a 
      grid on the stage, take this image, and load the first grid.&nbsp; When starting 
      the procedure on later phases, or doing more grid maps after the reference 
      counts have been measured, the routine will always start with the grid on the 
      stage.</p>
    <p><em>Eucentricity:</em> Before taking a grid map, the program will initially examine up to four 
      candidate locations for running the coarse eucentricity to find a place that is 
      not too dark.&nbsp; If a suitable position is found, it runs the rough 
      eucentricity routine so that the map will be taken at the eucentric height.&nbsp; 
      Otherwise, it will defer this operation until the map is done, using information 
      gathered during the montage to pick a good location near the center if possible.&nbsp; 
      If the property MaximumTiltAngle is set to less than 8 degrees, the progam will 
      skip doing eucentricity.</p>
    <p><em>Realigning after reload: </em>&nbsp;On Thermo/FEI scopes, a grid has a different 
      center point and rotation every time it is reloaded, so whenever a grid is 
      reloaded for the later phases of operation, it is realigned to the grid map (see 
      Realign to Map below and the &#39;RealignReloadedGrid&#39; script command).&nbsp; 
      Navigator points are transformed based on the shift and rotation.&nbsp;&nbsp; 
      The same routine can be used on a JEOL, but these autoloaders do not allow any 
      rotation and the positional change is apparently small.&nbsp; It is possible to 
      skip this routine, and thus avoid the aperture and lens changes and extra time 
      required for it, by setting the property &#39;MulGridSkipRealign&#39; non-zero.&nbsp; 
      With that set, an option will appear for an alternative alignment routine that 
      works only at a medium magnification, as described below in <em>
        <a href="refineRealign">Optional Controls for Refining Alignment</a></em>.</p>
    <p><em>Aligning to higher magnification:</em>&nbsp; To give a 
      better registration with stage positions at higher magnifications, a one-time 
      Shift to Marker has to be applied to the grid map and any items already marked 
      on it.&nbsp; Thus, in general, such a shift needs to be stored before running 
      the later phases.&nbsp; If the <A href="hidd_shift_to_marker.htm">Shift to Marker</A> 
      dialog is opened while this dialog is open, its radio buttons will be set 
      appropriately for storing a shift.&nbsp;&nbsp; The &#39;ShiftItemsByMicrons&#39; script 
      command can be used instead to apply a shift that will satisfy this requirement.</p>
    <p><em>Retry after aberrant realign:</em>&nbsp; When realigning to a reloaded grid, if the 
      residual error when fitting a transformation to the measured shifts, or the shift 
      or rotation of the transformation exceeds the limits controlled by the 
      properties &#39;GridXformResidualLimit, &#39;GridXformShiftLimit&#39;, and 
      &#39;GridXformRotationLimit&#39;, respectively, 
      then the program will unload the grid, reload it, and try to find the transformation 
      again.&nbsp; This reload is tried only once, and if the transformation still 
      exceeds a limit, the grid is skipped.</p>
    <p><em>Transformation for hole vectors:</em>&nbsp; If you are doing Multiple Records from multiple holes during final data 
      acquisition, there is another situation where a pre-existing transformation is 
      important.&nbsp; In this case, the hole vectors stored with a map after hole 
      finding are used to set the current image shift vectors for points on that map.&nbsp; 
      They are also transformed automatically to work at the Record magnification if 
      an appropriate transformation has been saved from the &#39;Step To and Adjust IS&#39; 
      procedure in the <a href="hidd_multi_shot_setup.htm">Multiple Record Setup</a> dialog.</p>
    <p><em>Managing operations on a single grid with no autoloader:</em> This dialog may also be useful for managing the workflow when 
      there is just one manually loaded grid.&nbsp; When the property 
      'ScopeHasAutoloader 0' is present, the menu entry appears as 'Multiple 
      Operations on Grid', the dialog is simplified to eliminate irrelevant controls, 
      and autoloader-related operations are omitted from the sequence of steps in each 
      phase.&nbsp; File names are based only on the <strong>Prefix</strong> entry, so 
      the name entry in the table is irrelevant.&nbsp; Controls for setting states and 
      parameters for individual grids are omitted.&nbsp; There are two special 
      requirements:</p>
    <ul>
      <li>Before running the first step, the grid map, you need to have an estimate of 
        the number of counts in a blank image (beam only) taken with the same parameters 
        and conditions as for the montage images (i.e., same exposure, binning, 
        magnification, and beam conditions).&nbsp; It does not need to be very accurate; 
        an underestimate is better than an overestimate.</li>
      <li>When a run is started with medium-mag mapping or final acquisition using an 
        existing grid map, the step for realigning to that map is skipped.&nbsp; If you 
        do remove and reinsert a grid, you would need to use the <strong>Realign to Map</strong> 
        button before running operations.</li>
    </ul>
    <p>&nbsp;</p>
    <p><a NAME="setup"></a><strong><em>Grid Setup and the Grid Table</em></strong></p>
    <p>The top section of the dialog has a table showing the grids that are in the 
      autoloader, omitting any empty cartridges.&nbsp; The first column has a set of 
      checkboxes to select which grids will be included in a multi-grid operation, 
      labeled by the order in which they would be run with the current selection of 
      options.&nbsp; 
      The second column is a set of radio push-buttons for selecting one grid for which 
      to do one of the operations in the row of buttons below the table.&nbsp; The 
      push-buttons are labeled with the slot number for Thermo/FEI scopes or the ID 
      number for JEOL scopes.&nbsp; Pressing a button with the Ctrl key held down 
      select that grid and load its navigator file, if one exists.&nbsp; The third column contains indicators of whether 
      the grid has separate states or parameter settings and a 
      status code showing how far the grid has been processed.&nbsp; The fourth column 
      has text boxes to allow you to see and edit the names for each grid.&nbsp; The 
      name of the currently loaded grid will be shown in bold text and its box will 
      have a green border.&nbsp; Once the names are fixed, a small note can be added 
      in the text box below the table and will show up after the name here.</p>
    <p>&nbsp;</p>
    <p><em>Grid Setup: </em>the controls in ths section determine where files will be 
      located and how they will be named. They are disabled and their values are 
      locked in when the first run is started; the name text boxes are also disabled.&nbsp; 
      The controls and outputs here are:</p>
    <p><strong>Run Inventory</strong></p>
    <p>Use this button to run an inventory of the autoloader contents.&nbsp; An 
      inventory is needed to determine which slots are occupied.&nbsp; On a JEOL 
      scope, this is a relatively quick operation that must be run from SerialEM and 
      populates an internal table of grid information.&nbsp; On a Thermo/FEI scope, it 
      is a time-consuming operation that need not be run from SerialEM and can 
      be run just as well with the button in the Autoloader panel of the TEM User 
      Interface.&nbsp; The inventory can be stopped only from that panel, not by 
      SerialEM.</p>
    <p><strong>Get Names</strong></p>
    <p>Use this button to set up the dialog table with a row for each available grid.&nbsp; 
      If there is a name in the microscope&#39;s autoloader interface, it will be used; 
      otherwise the name will be &#39;Car&#39; followed by the slot or ID number.&nbsp; Spaces 
      are replaced by underscores, and a variety of special characters are replaced by 
      &#39;@&#39;.&nbsp; The goal is to eliminate not just characters that are illegal in 
      filenames, but also characters that can cause trouble when using scripting and 
      shell commands to manipulate filenames.&nbsp; When a name is edited, 
      unacceptable characters are immediately replaced.&nbsp; Properties could be 
      added to provide more flexibility (retention of spaces, use of &#39;^&#39; instead of 
      &#39;@&#39;, or retention of characters that are legal in filenames).&nbsp; 
</p>
    <p><em>For Thermo/FEI scopes, it is not possible for SerialEM to determine if 
      there is a grid on the stage unless SerialEM loaded it.&nbsp; </em>The program 
      will ask you to enter the slot number of the grid on the stage, or 0 if there is 
      none.&nbsp; The entry box will default to an unoccupied slot that has a name, or 
      an unoccupied slot surrounded by filled ones, but only if there is just one such 
      slot.</p>
    <p><strong>Reset</strong></p>
    <p>Use this button to discard your name changes and revert to the names from the 
      microscope or the default names provided.&nbsp; The program will ask you to 
      confirm this action if you have edited names.</p>
    <p><strong>Clear</strong></p>
    <p>Use this button to clear out all the names, which might be convenient if you 
      are going to modify all of them. The program will ask you to confirm this action 
      if you have edited names.</p>
    <p><strong>Prefix</strong></p>
    <p>Add an entry to this text box to have the root name for each individual grid 
      start with the prefix.&nbsp; Again, unacceptable characters will be replaced as 
      you add them.&nbsp; The prefix can include a preferred way to refer to the 
      cartridges or grids.&nbsp; Specifically, if the prefix ends with &#39;Car&#39;, &#39;car&#39;, 
      &#39;Grid&#39; or &#39;grid&#39;, or one of these followed by &#39;_&#39;, then the slot or ID number 
      will be appended after this without the default &#39;_C&#39;.</p>
    <p><strong>Append names</strong></p>
    <p>Select this option to have the names shown in the table added to the root name, 
      after an underscore.</p>
    <p><strong>Root name</strong></p>
    <p>&nbsp;This line shows the form of the root name, with &#39;##&#39; for the slot or ID 
      number, and &#39;name&#39; for the individual name.</p>
    <p><strong>Use subdirectories</strong></p>
    <p>Select this option to have files placed in a subdirectory for each grid, named 
      by the root name.</p>
    <p><strong>Current dir/Session dir</strong></p>
    <p>Before any runs have been done, this line shows the program&#39;s current working 
      directory; afterwards, it is labeled &#39;Session dir&#39; and shows the location where this session&#39;s files are.</p>
    <p><strong>Set Current Dir</strong></p>
    <p>Use this button to set the program's current directory, the same as can be done 
      through the File menu.</p>
    <p>&nbsp;</p>
    <p><em><strong>Grid Actions: </strong> </em></p>
    <p><em>The first row of controls consists of:</em></p>
    <p>Unlabeled Toggle All checkbox</p>
    <p>Turning this checkbox on or off will turn the Run checkboxs on or off for all 
      grids.</p>
    <p><strong>Set Order</strong></p>
    <p>Use this button to set a custom order for running the grids.&nbsp; After 
      pressing the button, press the selection push-button for each grid in turn until 
      the order numbers afterthe checkboxes are the way you want them.&nbsp; Press the 
      button again if you are done before pressing all the selection buttons; the 
      button will reset automatically if you do select every grid in turn.&nbsp; 
      Another way to set order is to&nbsp; astart with all grids turned off, or only 
      the first one turned on.&nbsp; Press the button and turn on the checkbox for 
      each grid in order.</p>
    <p><strong>Reset</strong></p>
    <p>Use this button to discard the custom run order amd return to the order defined 
      by current option settings.&nbsp; This button is enabled only when there is a 
      custom order set.</p>
    <p><strong>Note</strong></p>
    <p>This edit box is enabled after the first run, when the names can no longer be 
      edited.&nbsp; It allows you to add a note for the grid selected by the 
      push-buttons in the table.&nbsp; The note will appear after the grid name in the 
      edit box for that grid.</p>
    <p><em>The second row of buttons below the table operate on the grid 
      selected by the push-buttons in the table.</em></p>
    <p><strong>Open Nav</strong></p>
    <p>Use this button to open the Navigator file for the selected grid.&nbsp; It is 
      disabled if there is a no Navigator file or if it is already open.&nbsp; If the 
      current Navigator table has changes, you will be asked whether you want to save 
      them.&nbsp; The Navigator file for a grid has a fixed name.&nbsp; A new 
      Navigator file with that name is started whenever a new grid map is obtained for 
      the grid; if there is a previous Navigator file for that grid, it is renamed to 
      a unique name with '-1.nav', '-2.nav', etc.</p>
    <p><strong>Load Grid</strong></p>
    <p>Use this button to load the selected grid.&nbsp; The program will also load the 
      Navigator file if it exists.</p>
    <p><strong>Realign to Map</strong></p>
    <p>Use this button to run the routine to realign to the grid map for the selected 
      grid, which is necessary after reloading the grid.&nbsp; The program will 
      analyze the image intensity information stored in the map file's '.mdoc'&nbsp; 
      to determine suitable locations for determining the alignment.&nbsp; It will 
      align to a central position and find the rotation angle that best aligns with 
      the map.&nbsp; Then it will move to 4 peripheral positions find the shift at 
      each of those, assuming the rotation found initially.&nbsp; From all of these 
      alignment positions, it determines a more accurate rotation and shift, and uses 
      them to transform the Navigator coordinates of the map and any items at the same 
      registration.</p>
    <p><strong>Params</strong></p>
    <p>Press this button to open the <a href="hidd_mulgrid_settings.htm">Multiple Grid Settings Manager</a> and store some 
      separate settings for the currently selected grid.&nbsp; Up to 5 kinds of 
      settings can be stored: for final data acquisition, autocontouring, hole 
      finding, multiple records, and some general settings that would typically be 
      different for gold grids.&nbsp; The Navigator acquisition parameters are stored 
      in a separate file, named as the root name of the session file plus 
      &#39;_navAcq.txt&#39;.&nbsp; Other parameters are stored as arrays of values within the 
      grid sections of the session autodoc file.&nbsp; When a grid has any one of 
      these kinds of parameters stored, the second character of the status indicator 
      will be 'P' instead of '&mdash;'.</p>
    <p><strong>Logs</strong></p>
    <p>Press this button to open any log files from running Acquire at Items on the 
      grid into secondary log windows.&nbsp; Log files are managed by the routine, with a main log that is repeatedly 
      reopened for top-level information, and a separate log for each Acquire at Items 
      run.&nbsp; If you save the log to a file before starting a run, that file will 
      be retained as the main log; otherwise the log will be named based on the 
      session file name.&nbsp; Log files for each grid are in the subdirectories and 
      named like the grid-level files, with &#39;_MMM&#39; or &#39;_final&#39; for medium mag or final 
      runs, respectively.&nbsp; Similarly to other situations where log files are 
      automatically managed, the first log with a particular name will have no number 
      attached, and further logs (in later runs) will be numbered with &#39;-1&#39;, -&#39;2&#39;, 
      etc.&nbsp; When you open log files with this button, their title bars will 
      contain &#39;SECONDARY Log:&#39; and the file name, and they will have a pale yellow 
      background.&nbsp; If you make changes in one of these logs, you can save it with 
      the File menu item <A HREF="menu_file.htm#hid_logwindow_savesecondarylog">Save Secondary Log</A>,
      which operates on the last secondary log that had focus.&nbsp; If you press this 
      button while some of the grid's logs are already open, the ones that are are 
      open will be raised to the foreground and any that are not will be opened.</p>
    <p>&nbsp;</p>
    <p><em>Optional Controls for Refining Alignment</em></p>
    <p><strong><a NAME="refineRealign"></a>Refine after Realign using</strong>&nbsp;&nbsp; or&nbsp;&nbsp; <strong>
      Refine instead of Realign using</strong></p>
    <p>These options are shown if either the &#39;ShowMulGridRefine&#39; or the 
      &#39;MulGridSkipRealign&#39; property is set non-zero and allow the grid alignment to be 
      refined by correlating images at a medium magnification with scaled up portions 
      of the grid map.&nbsp; The routine is designed to align to three corners of one 
      mesh opening.&nbsp; It does not currently try to detect these openings but 
      instead relies on polygons that have been drawn on the map, either ones produced 
      by autocontouring or manually drawn ones smaller than 250 microns in size.&nbsp; 
      The accuracy deteriorates for mesh openings farther away from the center of a 
      montage piece because of limitations in the accuracy of the stage calibration at 
      the particular location.&nbsp; The routine thus tries to use an opening near the 
      center of a montage piece if possible.&nbsp; It will favor using a montage piece 
      close to the centroid of all polygons, but may use a different piece if the best 
      polygon is much closer to the center of its piece.&nbsp; If you have to add 
      polygons manually to enable use of this routine, try to put them near the 
      centers of montage pieces.</p>
    <p>When this option is checked with the &#39;ShowMulGridRefine&#39; property set, the 
      program will run the refinement after the low mag realign to the grid map when 
      running multiple grids, and will also run it after acquiring a grid map when going 
      right on to acquiring medium-mag maps.&nbsp; With the &#39;MulGridSkipRealign&#39; property set, the 
      program will run only this refinement routine after reloading a grid.&nbsp; The 
      option is labeled <strong>Refine instead of Realign using</strong> in that case, 
      and pressing the <strong>Realign to Map</strong> button will run just the 
      refinement routine.</p>
    <p>The routine can end with an error, causing the grid to be skipped, if the 
      differences among the three shifts all exceed a criterion controlled by the 
      property &#39;MulGridMaxRefineDiff&#39;, whose default is 5 microns.</p>
    <p>This routine is intrinsically only about as accurate as the Realign routine and 
      is not as robust because it involves aligning between mags.&nbsp; However, 
      because it aligns at the medium mag, it can make up for a deficiency in the Low 
      Dose area shift offset and/or marker shift that is otherwise relied on for 
      alignment between low and medium mags.&nbsp; On a Thermo/FEI scope, that is 
      probably the only way in which the routine is useful.&nbsp; On a JEOL, if you 
      find that the routine is useful for this purpose and are acquiring both grid 
      maps and medium mag maps in a single run, add the property &#39;ShowMulGridRefine&#39;, 
      which will enable it to be run even right after taking a grid map.</p>
    <p>On the right side of the line with this option, there is an indicator of the 
      field of view (FOV) of images acquired with the selected method.</p>
    <p><strong>Search&nbsp; -&nbsp; View&nbsp; -&nbsp; State</strong></p>
    <p>Use the radio buttons to select between using Low Dose Search or View with 
      current parameters, or a stored state.&nbsp; If you use a state, it must be 
      either a non-Low Dose state or a View or Search state.&nbsp; If not, the FOV 
      indicator will show &#39;BAD STATE&#39;.&nbsp; If the FOV falls below a minimum value, 
      controlled by the property &#39;MulGridRefineMinField&#39; (with a default of 8 
      microns), the indicator will show &#39;BAD FOV&#39;.&nbsp; The FOV indicator is 
      updated if the magnification of the relevant low dose are is changed with the 
      'Continuous update' option.</p>
    <p>&nbsp;</p>
    <p><a NAME="gridMaps"></a><em><strong>Acquire Grid Maps</strong></em></p>
    <p>This section of the dialog contains parameters for acquiring grid maps; some of 
      them also apply when realigning to a reloaded grid.&nbsp; Grid maps must be 
      montages.</p>
    <p><strong>Use: LD Search&nbsp; -&nbsp; LD View&nbsp; -&nbsp; Current or set state<br />
      Set state
       </strong></p>
    <p>The radio buttons, possibly together with a selected state to be set, determine 
      what type of image will be used to acquire the montage.&nbsp; <strong>LD Search</strong> 
      and <strong>LD View</strong> will result in taking the montage in Low Dose mode 
      with Search or View, respectively.&nbsp; If a state is selected in the drop-down 
      box, it must be consistent, i.e., it must be a Low Dose S or V state.&nbsp; </p>
    <p>The situation is more complicated if <strong>Current or set state</strong> is 
      selected. If <strong>Set state</strong> is also selected, the state picked in 
      the drop-down box determines the acquisition.&nbsp; If no state is to be set, 
      then the current settings govern. The rules are: </p>
    <ul>
      <li>Setting a Low Dose S, V, R, or RM state will 
      result in a map taken in the given state with Search, View, Record, 
        or Mont-map respectively.&nbsp; </li>
      <li>Setting a non-Low Dose state will make the map be taken outside of 
      Low Dose with either Mont-map parameters for a '-M' state or Record otherwise.</li>
      <li>Outside of 
      Low Dose with no state set, the montage will be taken at the current magnification with Record 
      parameters, or with Mont-map parameters if 'Use Montage Mapping, not Record 
        parameters' is set in the Montage Setup dialog.&nbsp; </li>
      <li>In Low Dose mode with no state set and a currently defined area, it will be taken with Search or View if 
      currently in one of those areas, or with Record or Mont-map if in another area, 
        depwnding on whether 'Use Montage Mapping, not Record parameters' is set in the 
        Montage Setup dialog.&nbsp; </li>
      <li>In Low Dose mode with no 
      area is defined yet, it will be taken with Search or View if 'Use Search in Low 
      Dose mode' or 'Use View in Low Dose mode' are selected in the Montage Setup 
      dialog, or with Mont-map if 'Use Montage Mapping, not Record parameters' is set in 
        the Montage Setup dialog; otherwise the program will give an error when trying to set up the 
      montage.</li>
    </ul>
    <p>
      <strong>Remove objective aperture</strong></p>
    <p>Select this option to have the objective aperture removed before starting the 
      grid maps.&nbsp; The aperture will also be removed in later phases if grids are 
      reloaded and maps have to be realigned to.&nbsp; Apertures are always restored 
      to their current state at the end of a run.</strong></p>
    <p>Select this option and fill in a size to have the condenser aperture changed to 
      the given size before starting grid maps.&nbsp; Again, this size will used when 
      realigning after reloading a map.&nbsp; For a JEOL with no 'ApertureSizes' 
      property with actual condenser aperture sizes, this must be a size index between 
      1 and 4.</p>
    <p><strong>Montage: Full grid&nbsp; -&nbsp; N x N pieces</strong></p>
      <p>Use these radio buttons to select whether to do a full grid montage, the same as would be done with the 
      Navigator - Montaging and Grids - Setup Full Montage menu item, or a montage 
      with a specified number of pieces in X and Y.&nbsp; In the latter case, fill in 
      the number of pieces.</p>
    <p><strong>Use overlap of xx %</strong></p>
    <p>A smaller than usual overlap factor may be possible with low-magnification 
      maps.&nbsp; Select the check box and fill in a value to set a specific overlap; 
      otherwise you would have to change it in the Montage Setup dialog.</p>
    <p><strong>Setup Montage</strong></p>
    <p>Press this button to check the montage settings in the Montage Setup dialog.&nbsp; 
      If you do not do this, the dialog will come up when you go to start the run.&nbsp; 
      Only a few parameters can actually be modified in the dialog.</p>
    <p><strong>Autocontour grid squares</strong></p>
    <p>Select this option to run the routine to autocontour grid squares after 
      acquiring the grid map, using parameters set in the&nbsp; <A HREF="menu_navigator.htm#hid_montaginggrids_autocontourgridsquares">Autocontour Grid 
            Squares</A> dialog.&nbsp; </p>
    <p><strong>Setup</strong></p>
    <p>Press this button to open the <A HREF="menu_navigator.htm#hid_montaginggrids_autocontourgridsquares">Autocontour Grid 
            Squares</A> dialog and set parameters.&nbsp; Opened this way, it will 
      allow the group selections to be adjusted even though no contours exist.&nbsp; 
      You must select the set of groups to be converted to contours before starting 
      the first run, unless you have used the autocontouring and selected groups 
      previously in this run of the program and the Autocontouring dialog is still 
      open.&nbsp; The group selection is stored in the session file, so groups will 
      already be defined if you start another run to take maps on other grids in the 
      set.</p>
    <p><strong>Run script at end</strong></p>
    <p>Select this option to run a script after each grid map is finished, after 
      autocontouring if any.&nbsp; Pick the desired script in the drop-down box.</p>
    <p>&nbsp;</p>
    <p><A NAME="mediumMag"></a><strong><em>Acquire Medium Mag Maps</em></strong></p>
    <p>This section contains some controls governing the acThis section contains some controls governing the acquisition of 
      medium-magnification maps, although other aspects are controlled through the 
      <A HREF="hidd_navacquire.htm">Acquire at Items</A> dialog.&nbsp; Select the checkbox to include this phase of 
      operations in the run.</p>
    <p><strong>Use: LD Search&nbsp; -&nbsp; LD View&nbsp; -&nbsp; Current or set state<br />
      States
       </strong></p>
      <p>The radio buttons, together with the pre-existing settings in the Montage Setup 
      dialog and with states to be set, determine what kind of images are used for 
      these maps.&nbsp; The role of states is less than for grid mapping because 
      simply selecting a View or Search state does not imply that it should be used 
      for the maps. Four drop-down boxes are available for these states but only two are 
        shown by default; the number shown can be set with the 'MulGridNumMMMcombos' 
        property.&nbsp; Here are the rules for what parameters are used for these maps:</p>
    <ul>
      <li>&nbsp;Search will be used if <strong>LD Search</strong> is selected or if all 
        of these conditions exist: <strong>Current or set state</strong> is selected, a 
        Low Dose state is to be set or Low Dose mode is currently on, <strong>Polygon 
        mont</strong> or <strong>nXn mont </strong>is selected, and 'Use Search 
        parameters in Low Dose mode' is selected in the Montage Setup dialog.&nbsp; Obviously, it is easier 
        just to set the relevant radio button for the View and Search cases.</li>
      <li>Mont-map parameters will be used if neither of the above conditions apply, and 
        if <strong>Current or set state</strong> is selected, <strong>Polygon mont</strong> 
        or <strong>nXn mont </strong>is selected, and either a Mont-map state is 
        selected or 'Use Montage Mapping, not Record parameters' is selected in the 
        Montage Setup dialog.</li>
      <li>Otherwise, Record will be used.</li>
    </ul>
   Otherwise, Record will be used.</li>
    <p>
      <strong>Take: Image&nbsp; -&nbsp; Polygon mont&nbsp; -&nbsp; nXn mont</strong></p>
    <p>
      Use the buttons to select how the maps will be acquired:</p>
    <ul>
      <li>Image will acquire a single image instead of a montage.&nbsp; The kind of 
        image is determined by the selections just described.</li>
      <li>Polygon mont will fit a montage to each polygon set for acquisition.&nbsp; 
        'Reusable' polygon montage files will be used so that multiple maps of 
        essentially the same size can be saved into the same file, resulting in fewer 
        files.</li>
      <li>nXn mont will acquire montages with a fixed number of pieces in X and Y.</li>
    </ul>
    <p>
      <strong>Setup</strong></p>
    <p>
      Use this button to check the parameters for polygon montages and set the number 
      of pieces for fixed montages in the Montage Setup dialog.&nbsp; A polygon 
      montage is fit to a square of an arbitrary but hopefully representative size, to 
      give you some idea of how big the actual montages will be.&nbsp;
    </p>
    <p>
      <strong>Set Mapping Parameters</strong></p>
    <p>Use this button to open the Navigator Acquire at Items dialog and set the 
      Mapping parameters.&nbsp; Some entries there, such as the type of single image 
      to take in Low Dose mode, will be disabled because they are controlled by the 
      multi-grid routine.&nbsp; The option to run on a subset of items is changed to 
      allow you set the maximum number of items to run, which is useful if you want a 
      sample of data before running full acquisition.&nbsp; To do Multiple Records from multiple holes, you must 
      select the option to 'Use map hole vectors for shifts'.&nbsp; Currently, for 
      this to work well, it will almost certainly require a transformation that was 
      stored by running 'Step To and Adjust' after using hole vectors in the Multiple 
      Record Setup dialog, and the transformation will need to be good for the current 
      conditions.&nbsp; The Acquire at Items dialog will indicate if a transformation 
      exists.</p>
    <p>&nbsp;</p>
    <p><A NAME="finalAcq"></a><strong><em>Run Final Acquisition</em></strong></p>
    <p>Select the checkbox to include final data acquisition in the run.</p>
    <p><strong>States</strong></p>
    <p>The selected states must be consistent and determine what the parameters are 
      for images taken through Acquire at Items, but do not affect the behavior of the 
      multi-grid routine.&nbsp; All four of the available drop-down boxes are shown by 
      default, but the number can be set with the property 'MulGridNumFinalCombos'.</p>
    <p><strong>Set &amp; show states for each grid</strong></p>
    <p>Select this option if you want to use different states for some of the grids.&nbsp; 
      When the option is first turned on, the current set of states will be assigned 
      to the currently selected grid, if any.&nbsp; While it is on, changing the state 
      selections will change the set of states for the selected grid only.&nbsp; When 
      a different grid is selected, its set of states will be shown if it already has 
      some defined; otherwise the currently shown set of states will be assigned to 
      that grid.&nbsp; Thus, the easiest way to give a set of grids the same set of 
      separate states is:</p>
    <ul>
      <li>Select one of the grids out of that set</li>
      <li>Turn on the option</li>
      <li>Change to the desired states</li>
      <li>Select each other grid in the set, in turn</li>
      <li>Turn off the option</li>
    </ul>
    <p>
      The first character in the status column will be &#39;S&#39; instead of &#39;&mdash;&#39; 
      when a grid has separate states.&nbsp; Any grid without a separate state will 
      have the global set of states (if any); i.e., there is no inheritance from one 
      grid to the next.</p>
    <p>
      If you just want to check what the states are without changing anything, turn on 
      the option with no grid selected, select each grid with an 'S' status, and then 
      turn off the option.</p>
    <p><strong>Revert to Global</strong></p>
    <p>Use this button to remove the separate states for the selected grid.&nbsp; </p>
    <p><strong>Make frame directories under session directory/grid directories</strong></p>
    <p>If camera frames are saved during final acquisition, they will be placed in a 
      separate subdirectory for each grid.&nbsp; This option will be present if there 
      is any camera available that can save frames in arbitrary locations (e.g., not 
      for Falcon or DE cameras); select it if you are taking frames with such a camera 
      and want the frames to be saved in subdirectories under the session or grid 
      directories.&nbsp;&nbsp; When the option is selected, and the actual camera 
      being used allows it, frames will be saved in a directory named &#39;frames&#39; under 
      the grid directory if <strong>Use subdirectories</strong> 
      is chosen, or in a directory &#39;gridRootName_frames&#39; under the session directory 
      if not.&nbsp;&nbsp; Otherwise, frames will be saved in a directory 
      &#39;gridRootName&#39; under the currently defined frame folder for the camera if the 
      camera allows that, or the frame folder will simply be defined as &#39;gridRootName&#39; 
      in a case where directories are allowed only directly under the frame storage 
      location.</p>
    <p>With regard to saving frames, the program will keep track of a sequential 
      number separately for each grid.&nbsp; If acquisition is run again on a grid, 
      the numbering will pick up where it left off.&nbsp; Also note that if the base 
      name is used in frame stack or folder names, it will have the name of the grid 
      added to it.</p>
    <p><strong>Set Final Data Parameters</strong></p>
    <p>Use this button to open the Navigator Acquire at Items dialog and set the Final 
      Data parameters.&nbsp; Here, only a few choices will be disabled.&nbsp;&nbsp; 
      Any type of main action can be chosen.&nbsp; If you happen to want to take tilt 
      series on some grids and other acquisition on the rest of the grids, first set 
      up the other acquisition, then switch the main action to tilt series and set 
      that up.&nbsp; Leave the dialog with tilt series selected.&nbsp;&nbsp; When 
      running from the multi-grid routine, the program will automatically switch the 
      acquisition to tilt series when there are items marked for tilt series and now 
      marked for Acquire.</p>
    <p>&nbsp;</p>
    <p><A NAME="running"></a><strong><em>Running the Grids, Errors, Pausing, Stopping</em></strong></p>
    <p>Press <strong>Run All</strong> to run all the grids whose 'Run' box is checked.&nbsp;
      <strong>Run Undone</strong> can be used to run only the phases that have not yet 
      been done on the selected grids. It is enabled only if some, but not all, of the 
      grids have already succeeded on the first phase selected to be run (e.g., if you 
      select <strong>Acquire Grid Maps</strong> and <strong>Acquire Medium Mag Maps
      </strong>and some grids already have grid maps, they will start with medium mag 
      maps).</p>
    <p>If you have changed the camera subarea size for one of the parameter sets being 
      used in a montage to be acquired since the montage was set up, the program will 
      open the montage setup dialog for the affected montage, and may ask you if you 
      want to use a subarea instead of the full frame when fitting the montage to an 
      area.</p>
    <p>For a run including medium mag mapping or final acquisition, the program will 
      check the acquisition parameters for feasibility and consistency with the 
      Navigator file contents to the extent possible.&nbsp; Specifically, for each 
      grid, it does most of the checks that are done before a regular Acquire at Items 
      run (such as for the existence of template maps and labeled Navigator locations 
      at which to perform specific tasks), and if Eucentricity by Focus is to be run, 
      it verifies that a usable calibration is available.&nbsp; If both medium mag 
      mapping and final acquisition are being run, only the first stage can be 
      checked, since the items to be acquired in the second stage do not exist yet.</p>
    <p>The status codes will be updated as grids run and are as follows:<br />
      GM - Grid map is done<br />
      MM - Medium mag maps are done<br />
      AQ - Final acquisition is done<br />
      G-D - Grid map is done but grid is too dark to use<br />
      DA - Grid was judged too dark to use before taking a grid map (this does not occur with current logic) <br />
      FL - Something failed making the grid map or trying to set eucentricity<br />
      G-F - Grid map is done, something failed on a later step<br />
      M-F - Medium mag maps are done, something failed in final acquisition<br />
    </p>
    <p>An error in a task started by the multi-grid routine, except for Acquire at 
      Items, will result in one of three actions: for some errors, it will go on to 
      the next grid; for others, it will retry the operation once; for the rest, the 
      whole run will be stopped.</p>
    <p>An error in an operation performed by Acquire at Items will be treated as it 
      usually is, with Acquire at Items either stopping or going on to the next item.&nbsp; 
      The multi-grid routine will be put into a suspended state.&nbsp; Restarting 
      Acquire at Items will unsuspend the multi-grid routine so that it can proceed 
      normally when the acquisition finishes.</p>
    <p>Pressing the STOP button also suspends the multi-grid routine as well as 
      stopping whatever operation was occurring.&nbsp; If the grid montage was 
      stopped, starting a montage will unsuspend the multi-grid routine.</p>
    <p>While operations are running, the button below <strong>Setup</strong> in the 
      Camera &amp; Macro Tools panel (usually labeled <strong>Preview</strong> or <strong>
      Montage)</strong> will be labeled <strong>PauseMG</strong>.&nbsp; Pressing this 
      button will suspend the multi-grid routine at the end of the current grid.&nbsp; 
      Whenever no operations are running and this routine is suspended, that button 
      will be labeled <strong>End MGrid</strong>, and pressing it will terminate the 
      routine, return the microscope to the initial conditions, and re-enable 
      everything in the dialog.&nbsp; The usual <strong>Resume</strong> button will be labeled <strong>ResumeM</strong>.&nbsp; 
      Pressing this after a pause will resume the multi-grid routine on the next grid.</p>
    <p>Pressing <strong>ResumeM</strong> after any other kind of stop will bring up a message box 
      asking whether you want to repeat the last operation in the multi-grid sequence, 
      go on to the next operation, or skip to the next grid.&nbsp; There are no good 
      error checks on this choice yet, so for now you will have to exercise some 
      judgement when doing anything except skipping to the next grid.&nbsp; Running 
      the grid montage, Acquire at Items, realign to the grid map, and eucentricity 
      should be safe to redo.&nbsp; Also note that the routine assumes that nothing 
      has changed on the scope (e.g., states or apertures) that would prevent 
      operations from continuing successfully.&nbsp; If there is any doubt about this, 
      it is safest to terminate with <strong>End MGrid</strong>, uncheck the grids 
      done, and restart the run.</p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>

  </body>
</html>
